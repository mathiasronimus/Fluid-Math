{"version":3,"sources":["webpack:///../src/animation/AddAnimation.ts","webpack:///../src/animation/Animation.ts","webpack:///../src/animation/AnimationSet.ts","webpack:///../src/animation/AutoplayProgressAnimation.ts","webpack:///../src/animation/BezierCallback.ts","webpack:///../src/animation/ContentLayoutState.ts","webpack:///../src/animation/DummyAnimation.ts","webpack:///../src/animation/EvalAnimation.ts","webpack:///../src/animation/LayoutState.ts","webpack:///../src/animation/MoveAnimation.ts","webpack:///../src/animation/OriginalDimenLayoutState.ts","webpack:///../src/animation/OutlineColorAnimation.ts","webpack:///../src/animation/OutlineFadeAnimation.ts","webpack:///../src/animation/ProgressAnimation.ts","webpack:///../src/animation/RadioButtonLayoutState.ts","webpack:///../src/animation/RadioButtonSelectAnimation.ts","webpack:///../src/animation/RemoveAnimation.ts","webpack:///../src/animation/ReverseEvalAnimation.ts","webpack:///../src/animation/RootContainerLayoutState.ts","webpack:///../src/animation/TermLayoutState.ts","webpack:///../src/layout/CurvedOutline.ts","webpack:///../src/layout/EqComponent.ts","webpack:///../src/layout/EqContainer.ts","webpack:///../src/layout/EqContent.ts","webpack:///../src/layout/HBox.ts","webpack:///../src/layout/HDivider.ts","webpack:///../src/layout/LinearContainer.ts","webpack:///../src/layout/Padding.ts","webpack:///../src/layout/Quiz.ts","webpack:///../src/layout/Radical.ts","webpack:///../src/layout/RadioButton.ts","webpack:///../src/layout/RootContainer.ts","webpack:///../src/layout/SubSuper.ts","webpack:///../src/layout/TableContainer.ts","webpack:///../src/layout/Term.ts","webpack:///../src/layout/TightHBox.ts","webpack:///../src/layout/VBox.ts","webpack:///../src/layout/VCenterVBox.ts","webpack:///../src/layout/VDivider.ts","webpack:///../src/main/CanvasController.ts","webpack:///../src/main/ComponentModel.ts","webpack:///../src/main/HeightComputeCanvasController.ts","webpack:///../src/main/ProgressIndicator.ts","webpack:///../src/main/consts.ts","webpack:///../src/main/helpers.ts","webpack:///./src/$_lazy_route_resource lazy namespace object","webpack:///./src/app/Icon.ts","webpack:///./src/app/app.component.css","webpack:///./src/app/app.component.html","webpack:///./src/app/app.component.ts","webpack:///./src/app/app.module.ts","webpack:///./src/app/central-area/CreatorCanvasController.ts","webpack:///./src/app/central-area/CreatorComponentModel.ts","webpack:///./src/app/central-area/CreatorContainerMethods.ts","webpack:///./src/app/central-area/CreatorHBox.ts","webpack:///./src/app/central-area/CreatorQuiz.ts","webpack:///./src/app/central-area/CreatorRootContainer.ts","webpack:///./src/app/central-area/CreatorSubSuper.ts","webpack:///./src/app/central-area/CreatorTable.ts","webpack:///./src/app/central-area/CreatorTightHBox.ts","webpack:///./src/app/central-area/CreatorVBox.ts","webpack:///./src/app/central-area/central-area.component.css","webpack:///./src/app/central-area/central-area.component.html","webpack:///./src/app/central-area/central-area.component.ts","webpack:///./src/app/color-picker/color-picker.component.css","webpack:///./src/app/color-picker/color-picker.component.html","webpack:///./src/app/color-picker/color-picker.component.ts","webpack:///./src/app/content-pane/content-pane.component.css","webpack:///./src/app/content-pane/content-pane.component.html","webpack:///./src/app/content-pane/content-pane.component.ts","webpack:///./src/app/content-selection.service.ts","webpack:///./src/app/custom-font-load-fail/custom-font-load-fail.component.css","webpack:///./src/app/custom-font-load-fail/custom-font-load-fail.component.html","webpack:///./src/app/custom-font-load-fail/custom-font-load-fail.component.ts","webpack:///./src/app/error.service.ts","webpack:///./src/app/font-settings/font-settings.component.css","webpack:///./src/app/font-settings/font-settings.component.html","webpack:///./src/app/font-settings/font-settings.component.ts","webpack:///./src/app/font-update.service.ts","webpack:///./src/app/helpers.ts","webpack:///./src/app/load/load.component.css","webpack:///./src/app/load/load.component.html","webpack:///./src/app/load/load.component.ts","webpack:///./src/app/modal.directive.ts","webpack:///./src/app/modal.service.ts","webpack:///./src/app/preview/preview.component.css","webpack:///./src/app/preview/preview.component.html","webpack:///./src/app/preview/preview.component.ts","webpack:///./src/app/project-options/project-options.component.css","webpack:///./src/app/project-options/project-options.component.html","webpack:///./src/app/project-options/project-options.component.ts","webpack:///./src/app/quiz-configuration/quiz-configuration.component.css","webpack:///./src/app/quiz-configuration/quiz-configuration.component.html","webpack:///./src/app/quiz-configuration/quiz-configuration.component.ts","webpack:///./src/app/save/save.component.css","webpack:///./src/app/save/save.component.html","webpack:///./src/app/save/save.component.ts","webpack:///./src/app/selected-step.service.ts","webpack:///./src/app/step-options/SelectableCanvasController.ts","webpack:///./src/app/step-options/SelectableComponentModel.ts","webpack:///./src/app/step-options/step-options.component.css","webpack:///./src/app/step-options/step-options.component.html","webpack:///./src/app/step-options/step-options.component.ts","webpack:///./src/app/step-text/step-text.component.css","webpack:///./src/app/step-text/step-text.component.html","webpack:///./src/app/step-text/step-text.component.ts","webpack:///./src/app/steps/RendererCanvasController.ts","webpack:///./src/app/steps/steps.component.css","webpack:///./src/app/steps/steps.component.html","webpack:///./src/app/steps/steps.component.ts","webpack:///./src/app/sub-super-alignment/sub-super-alignment.component.css","webpack:///./src/app/sub-super-alignment/sub-super-alignment.component.html","webpack:///./src/app/sub-super-alignment/sub-super-alignment.component.ts","webpack:///./src/app/table-add/table-add.component.css","webpack:///./src/app/table-add/table-add.component.html","webpack:///./src/app/table-add/table-add.component.ts","webpack:///./src/app/term-template/term-template.component.css","webpack:///./src/app/term-template/term-template.component.html","webpack:///./src/app/term-template/term-template.component.ts","webpack:///./src/app/text-editor/text-editor.component.css","webpack:///./src/app/text-editor/text-editor.component.html","webpack:///./src/app/text-editor/text-editor.component.ts","webpack:///./src/app/tool-bar/tool-bar.component.css","webpack:///./src/app/tool-bar/tool-bar.component.html","webpack:///./src/app/tool-bar/tool-bar.component.ts","webpack:///./src/app/undo-redo.service.ts","webpack:///./src/environments/environment.ts","webpack:///./src/main.ts"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["import LayoutState from \"./LayoutState\";\r\nimport AnimationSet from \"./AnimationSet\";\r\nimport Animation from './Animation';\r\nimport EqContent from \"../layout/EqContent\";\r\nimport { addEasing } from \"../main/consts\";\r\n\r\n/**\r\n * Animates a component in by scaling it from\r\n * 0 to its normal size.\r\n */\r\nexport default class AddAnimation extends Animation {\r\n\r\n    constructor(end: LayoutState, set: AnimationSet, ctx: CanvasRenderingContext2D, duration: number) {\r\n        super(duration, addEasing, set, end.withZeroScale(), end, end.component as EqContent<any>, ctx);\r\n    }\r\n}","import BezierCallback from \"./BezierCallback\";\r\nimport LayoutState from \"./LayoutState\";\r\nimport EqContent from \"../layout/EqContent\";\r\n\r\n/**\r\n * A bezier callback whose step function\r\n * calls the draw function of content.\r\n */\r\nexport default class Animation extends BezierCallback {\r\n\r\n    protected before: LayoutState;\r\n    protected after: LayoutState;\r\n    protected component: EqContent<any>;\r\n    protected ctx: CanvasRenderingContext2D;\r\n\r\n    constructor(duration, easing, set, \r\n                before: LayoutState, after: LayoutState, \r\n                component: EqContent<any>, ctx: CanvasRenderingContext2D) {\r\n        super(duration, easing, set);\r\n        this.before = before;\r\n        this.after = after;\r\n        this.component = component;\r\n        this.ctx = ctx;\r\n    }\r\n\r\n    protected step(completion: number) {\r\n        this.ctx.save();\r\n        this.component.draw(this.before, this.after, completion, this.ctx);\r\n        this.ctx.restore();\r\n    }\r\n}","import BezierCallback from \"./BezierCallback\";\r\nimport LayoutState from \"./LayoutState\";\r\nimport EqContent from \"../layout/EqContent\";\r\n\r\n/**\r\n * Plays a set of animations and provides\r\n * options for controlling them as a group.\r\n * Also erases the canvas before each frame.\r\n */\r\nexport default class AnimationSet {\r\n\r\n    private numRunning: number;\r\n    private animations: BezierCallback[];\r\n    private done: () => void;\r\n    private ctx: CanvasRenderingContext2D;\r\n    private clearWidth: number;\r\n    private clearHeight: number;\r\n    private clearFill: string;\r\n    private states: LayoutState[];\r\n    private stopped = false;\r\n\r\n    /**\r\n     * Create a new Animation Set.\r\n     * @param done Function to call when all animations are done.\r\n     * @param ctx Context of the canvas to clear/draw to.\r\n     * @param clearWidth The width of the canvas to clear.\r\n     * @param clearHeight The height of the canvas to clear.\r\n     * @param clearFill The background color to fill at the start of each frame.\r\n     * @param drawStates (optional) the states to draw after each frame.\r\n     */\r\n    constructor(done: () => void, ctx: CanvasRenderingContext2D, clearWidth: number, clearHeight: number, \r\n                clearFill: string, drawStates?: LayoutState[]) {\r\n        this.animations = [];\r\n        this.done = done;\r\n        this.ctx = ctx;\r\n        this.clearWidth = clearWidth;\r\n        this.clearHeight = clearHeight;\r\n        this.states = drawStates;\r\n        this.clearFill = clearFill;\r\n    }\r\n\r\n    public addAnimation(anim: BezierCallback) {\r\n        this.animations.push(anim);\r\n    }\r\n\r\n    /**\r\n     * Starts running the animations.\r\n     */\r\n    public start() {\r\n        this.numRunning = this.animations.length;\r\n        let this_ = this;\r\n\r\n        let doAll = function(timestamp: number) {\r\n            // Clear the canvas\r\n            this_.ctx.save();\r\n            this_.ctx.fillStyle = this_.clearFill;\r\n            this_.ctx.fillRect(0, 0, this_.clearWidth, this_.clearHeight);\r\n            this_.ctx.restore();\r\n\r\n            this_.animations.forEach(a => {\r\n                a.run(timestamp);\r\n            });\r\n            // Draw all content states if necessary\r\n            if (this_.states) {\r\n                this_.states.forEach(state => {\r\n                    if (state.component instanceof EqContent) {\r\n                        this_.ctx.save();\r\n                        state.component.draw(state, state, 1, this_.ctx);\r\n                        this_.ctx.restore();\r\n                    }\r\n                });\r\n            }\r\n            if (this_.numRunning > 0 && !this_.stopped) {\r\n                requestAnimationFrame(doAll);\r\n            }\r\n        }\r\n\r\n        requestAnimationFrame(doAll);\r\n    }\r\n\r\n    /**\r\n     * Called by a BezierCallback when it is done.\r\n     */\r\n    public finished() {\r\n        this.numRunning--;\r\n        if (this.numRunning === 0 && this.done) {\r\n            this.done();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Stop all running animations and call the done event,\r\n     * if it was provided.\r\n     */\r\n    public stop() {\r\n        this.stopped = true;\r\n        if (this.done) {\r\n            this.done();\r\n        }\r\n    }\r\n\r\n}","import BezierCallback from \"./BezierCallback\";\r\nimport ProgressIndicator from \"../main/ProgressIndicator\";\r\nimport AnimationSet from \"./AnimationSet\";\r\nimport { autoplayProgressEasing } from \"../main/consts\";\r\n\r\nexport default class AutoplayProgressAnimation extends BezierCallback {\r\n    \r\n    private pi: ProgressIndicator;\r\n\r\n    private canvasWidth: number;\r\n    private canvasHeight: number;\r\n\r\n    constructor(pi: ProgressIndicator, set: AnimationSet, duration: number, canvasWidth: number, canvasHeight: number) {\r\n        super(duration, autoplayProgressEasing, set);\r\n        this.pi = pi;\r\n        this.canvasWidth = canvasWidth;\r\n        this.canvasHeight = canvasHeight;\r\n    }\r\n\r\n    protected step(completion: number) {\r\n        this.pi.draw(completion, this.canvasWidth, this.canvasHeight);\r\n    }\r\n}","import AnimationSet from \"./AnimationSet\";\r\n\r\n/**\r\n * Animates by repeatedly calling a step\r\n * function whose completion over time is\r\n * determined by a bezier curve.\r\n */\r\nexport default abstract class BezierCallback {\r\n\r\n    duration: number; //In MS\r\n    easing: Function; //The easing function, eg. bezier(0, 0, 1, 1)\r\n    set: AnimationSet; //The animation set this belongs to\r\n\r\n    private done = false;\r\n    private startTime: number = -1;\r\n\r\n    constructor(duration, easing, set) {\r\n        this.duration = duration;\r\n        this.easing = easing;\r\n        this.set = set;\r\n    }\r\n\r\n    /**\r\n     * Called for each frame to run an \r\n     * animation.\r\n     * \r\n     * @param completion Completion of animation from 0-1.\r\n     */\r\n    protected abstract step(completion: number): void;\r\n\r\n    run(timestamp: number): void {\r\n        if (this.done) {\r\n            // Continue drawing the final state\r\n            this.step(1);\r\n            return;\r\n        }\r\n        if (this.startTime === -1) {\r\n            //Special Case: First Frame\r\n            this.startTime = timestamp;\r\n            this.step(0);\r\n            return;\r\n        }\r\n\r\n        let elapsed = timestamp - this.startTime;\r\n\r\n        if (elapsed >= this.duration) {\r\n            //Done\r\n            this.step(1);\r\n            this.set.finished();\r\n            this.done = true;\r\n        } else {\r\n            this.step(this.easing(elapsed / this.duration));\r\n        }\r\n    }\r\n}","import LayoutState from \"./LayoutState\";\r\n\r\n/**\r\n * Layout state containing info relevant to\r\n * content, ie color and opacity.\r\n */\r\nexport default class ContentLayoutState extends LayoutState {\r\n\r\n    color: number[];\r\n    opacity: number;\r\n\r\n    constructor(layoutParent, component, tlx, tly, width, height, scale, color, opacity) {\r\n        super(layoutParent, component, tlx, tly, width, height, scale);\r\n        this.color = color;\r\n        this.opacity = opacity;\r\n    }\r\n\r\n    /**\r\n     * Returns a new Layout State the same\r\n     * as this one, but with a scaling of 0.\r\n     */\r\n    withZeroScale(): ContentLayoutState {\r\n        return new ContentLayoutState( this.layoutParent, \r\n                                this.component,\r\n                                this.tlx,\r\n                                this.tly,\r\n                                this.width, \r\n                                this.height,\r\n                                0,\r\n                                this.color,\r\n                                0);\r\n    }\r\n}","import BezierCallback from \"./BezierCallback\";\r\nimport { moveEasing } from \"../main/consts\";\r\nimport AnimationSet from \"./AnimationSet\";\r\n\r\n/**\r\n * An animation that doesn't do anything - useful for ensuring\r\n * an animation set runs for a particular minimum duration.\r\n */\r\nexport default class DummyAnimation extends BezierCallback {\r\n    \r\n    constructor(duration: number, set: AnimationSet) {\r\n        super(duration, moveEasing, set);\r\n    }\r\n    \r\n    // Do nothing\r\n    protected step(completion: number): void {}\r\n    \r\n}","import Animation from './Animation';\r\nimport LayoutState from './LayoutState';\r\nimport AnimationSet from './AnimationSet';\r\nimport EqContent from '../layout/EqContent';\r\nimport { moveEasing } from '../main/consts';\r\n\r\nexport default class EvalAnimation extends Animation {\r\n\r\n    constructor(evalFrom: LayoutState, evalTo: LayoutState, set: AnimationSet, ctx: CanvasRenderingContext2D, duration: number) {\r\n        super(  duration, moveEasing, set, \r\n                evalFrom, evalTo.withZeroScale(), \r\n                evalFrom.component as EqContent<any>, ctx);\r\n    }\r\n}","import EqComponent from \"../layout/EqComponent\";\r\n\r\n/**\r\n * Stores how a component should be\r\n * drawn at a particular step.\r\n */\r\nexport default class LayoutState {\r\n    tlx: number;\r\n    tly: number;\r\n    width: number;\r\n    height: number;\r\n    // The scaling of the component (width and height reflect this scaling,\r\n    // but needs to be taken into account for drawing.)\r\n    scale: number;\r\n    component: EqComponent<LayoutState>;\r\n    layoutParent: LayoutState;\r\n\r\n    // The distance from the top of the layout to the baseline\r\n    // of its text.\r\n    baselineFromTop: number;\r\n\r\n    constructor(layoutParent, component, tlx, tly, width, height, scale) {\r\n        this.tlx = tlx;\r\n        this.tly = tly;\r\n        this.width = width;\r\n        this.height = height;\r\n        this.component = component;\r\n        this.layoutParent = layoutParent;\r\n        this.scale = scale;\r\n    }\r\n\r\n    /**\r\n     * Checks if this layout contains the \r\n     * specified point.\r\n     * \r\n     * @param x X-ordinate of the point.\r\n     * @param y Y-ordinate of the point.\r\n     */\r\n    contains(x: number, y: number): boolean {\r\n        return  x >= this.tlx &&\r\n                x <= this.tlx + this.width &&\r\n                y >= this.tly &&\r\n                y <= this.tly + this.height;\r\n    }\r\n\r\n    /**\r\n     * Checks if the x-ordinate is on\r\n     * the left half of this layout.\r\n     * \r\n     * @param x The x-ordinate\r\n     */\r\n    onLeft(x: number): boolean {\r\n        return x <= this.tlx + this.width / 2;\r\n    }\r\n\r\n    /**\r\n     * Checks if the y-ordinate is on\r\n     * the top half of this layout.\r\n     * \r\n     * @param y The y-ordinate\r\n     */\r\n    onTop(y: number): boolean {\r\n        return y <= this.tly + this.height / 2;\r\n    }\r\n\r\n    /**\r\n     * Returns a new Layout State the same\r\n     * as this one, but with a scaling of 0.\r\n     */\r\n    withZeroScale(): LayoutState {\r\n        return new LayoutState( this.layoutParent, \r\n                                this.component,\r\n                                this.tlx,\r\n                                this.tly,\r\n                                this.width, \r\n                                this.height,\r\n                                0);\r\n    }\r\n}","import AnimationSet from \"./AnimationSet\";\r\nimport LayoutState from './LayoutState';\r\nimport Animation from './Animation';\r\nimport EqContent from \"../layout/EqContent\";\r\nimport { moveEasing } from \"../main/consts\";\r\n\r\nexport default class MoveAnimation extends Animation {\r\n\r\n    constructor(start: LayoutState, end: LayoutState, set: AnimationSet, ctx: CanvasRenderingContext2D, duration: number) {\r\n        super(duration, moveEasing, set, start, end, end.component as EqContent<any>, ctx);\r\n    }\r\n\r\n}","import ContentLayoutState from \"./ContentLayoutState\";\r\nimport LayoutState from \"./LayoutState\";\r\nimport EqComponent from \"../layout/EqComponent\";\r\n\r\n/**\r\n * A layout state that also stores the original (non-scaled)\r\n * inner dimensions.\r\n */\r\nexport class OriginalDimenLayoutState extends ContentLayoutState {\r\n\r\n    origInnerWidth: number;\r\n    origInnerHeight: number;\r\n\r\n    constructor(layoutParent: LayoutState, component: EqComponent<any>, \r\n                tlx: number, tly: number, width: number, height: number, \r\n                scale: number, color: number[], opacity: number,\r\n                origInnerWidth: number, origInnerHeight: number) {\r\n        super(layoutParent, component, tlx, tly, width, height, scale, color, opacity);\r\n        this.origInnerWidth = origInnerWidth;\r\n        this.origInnerHeight = origInnerHeight;\r\n    }\r\n\r\n    /**\r\n     * Returns a new Layout State the same\r\n     * as this one, but with a scaling of 0.\r\n     */\r\n    withZeroScale(): OriginalDimenLayoutState {\r\n        return new OriginalDimenLayoutState(\r\n            this.layoutParent, \r\n            this.component,\r\n            this.tlx,\r\n            this.tly,\r\n            this.width, \r\n            this.height,\r\n            0,\r\n            this.color,\r\n            0,\r\n            this.origInnerWidth,\r\n            this.origInnerHeight\r\n        );\r\n    }\r\n}","import BezierCallback from \"./BezierCallback\";\r\nimport ContentLayoutState from \"./ContentLayoutState\";\r\nimport AnimationSet from \"./AnimationSet\";\r\nimport { outlineFadeInDuration, outlineFadeInEasing } from \"../main/consts\";\r\n\r\nexport default class OutlineColorAnimation extends BezierCallback {\r\n\r\n    private layout: ContentLayoutState;\r\n    private startColor: number[];\r\n    private endColor: number[];\r\n\r\n    constructor(outlineLayout: ContentLayoutState, newColor: number[], set: AnimationSet) {\r\n        super(outlineFadeInDuration, outlineFadeInEasing, set);\r\n        this.layout = outlineLayout;\r\n        this.startColor = this.layout.color;\r\n        this.endColor = newColor;\r\n        set.addAnimation(this);\r\n    }\r\n\r\n    protected step(completion: number): void {\r\n        const currR = this.startColor[0] * (1 - completion) + this.endColor[0] * completion;\r\n        const currG = this.startColor[1] * (1 - completion) + this.endColor[1] * completion;\r\n        const currB = this.startColor[2] * (1 - completion) + this.endColor[2] * completion;\r\n        this.layout.color = [Math.round(currR), Math.round(currG), Math.round(currB)];\r\n    }\r\n    \r\n}","import BezierCallback from \"./BezierCallback\";\r\nimport ContentLayoutState from \"./ContentLayoutState\";\r\nimport AnimationSet from \"./AnimationSet\";\r\nimport { outlineFadeInDuration, outlineFadeInEasing } from \"../main/consts\";\r\n\r\nexport default class OutlineFadeAnimation extends BezierCallback {\r\n\r\n    private layout: ContentLayoutState;\r\n    private startO: number;\r\n    private endO: number;\r\n\r\n    constructor(outlineLayout: ContentLayoutState, newOpacity: number, set: AnimationSet) {\r\n        super(outlineFadeInDuration, outlineFadeInEasing, set);\r\n        this.layout = outlineLayout;\r\n        this.startO = this.layout.opacity;\r\n        this.endO = newOpacity;\r\n        set.addAnimation(this);\r\n    }\r\n\r\n    protected step(completion: number): void {\r\n        const currOpacity = this.startO * (1 - completion) + this.endO * completion;\r\n        this.layout.opacity = currOpacity;\r\n    }\r\n    \r\n}","import BezierCallback from \"./BezierCallback\";\r\nimport AnimationSet from \"./AnimationSet\";\r\nimport ProgressIndicator from \"../main/ProgressIndicator\";\r\n\r\n/**\r\n * Animate the progress indicator.\r\n */\r\nexport default class ProgressAnimation extends BezierCallback {\r\n\r\n    private startCompletion: number;\r\n    private endCompletion: number;\r\n    private pi: ProgressIndicator;\r\n\r\n    private canvasWidth: number;\r\n    private canvasHeight: number;\r\n\r\n    constructor(startStep: number, endStep: number, numSteps: number, pi: ProgressIndicator, set: AnimationSet, duration: number,\r\n                easing, canvasWidth: number, canvasHeight: number) {\r\n        super(duration, easing, set);\r\n        this.startCompletion = startStep / (numSteps - 1);\r\n        this.endCompletion = endStep / (numSteps - 1);\r\n        this.pi = pi;\r\n        this.canvasWidth = canvasWidth;\r\n        this.canvasHeight = canvasHeight;\r\n    }\r\n\r\n    protected step(animCompletion: number) {\r\n        const currCompletion = this.startCompletion * (1 - animCompletion) + this.endCompletion * animCompletion;\r\n        this.pi.draw(currCompletion, this.canvasWidth, this.canvasHeight);\r\n    }\r\n}","import ContentLayoutState from \"./ContentLayoutState\";\r\nimport EqComponent from \"../layout/EqComponent\";\r\n\r\nexport default class RadioButtonLayoutState extends ContentLayoutState {\r\n\r\n    percentFill: number;\r\n\r\n    constructor(component: EqComponent<any>, tlx: number, tly: number, width: number, height: number, scale: number,\r\n                color: number[], opacity: number, percentFill: number) {\r\n        super(undefined, component, tlx, tly, width, height, scale, color, opacity);\r\n        this.percentFill = percentFill;\r\n    }\r\n\r\n    /**\r\n     * Returns a new Layout State the same\r\n     * as this one, but with a scaling of 0.\r\n     */\r\n    withZeroScale(): RadioButtonLayoutState {\r\n        return new RadioButtonLayoutState(\r\n                                this.component,\r\n                                this.tlx,\r\n                                this.tly,\r\n                                this.width, \r\n                                this.height,\r\n                                0,\r\n                                this.color,\r\n                                0,\r\n                                this.percentFill);\r\n    }\r\n\r\n}","import BezierCallback from \"./BezierCallback\";\r\nimport AnimationSet from \"./AnimationSet\";\r\nimport RadioButtonLayoutState from \"./RadioButtonLayoutState\";\r\n\r\nexport default class RadioButtonSelectAnimation extends BezierCallback {\r\n\r\n    private layout: RadioButtonLayoutState;\r\n    private startFill: number;\r\n    private endFill: number;\r\n    \r\n    constructor(duration: number, easing, set: AnimationSet, layout: RadioButtonLayoutState, startFill: number, endFill: number) {\r\n        super(duration, easing, set);\r\n        this.layout = layout;\r\n        this.startFill = startFill;\r\n        this.endFill = endFill;\r\n        set.addAnimation(this);\r\n    }\r\n\r\n    protected step(completion: number): void {\r\n        const currFill = this.startFill * (1 - completion) + this.endFill * completion;\r\n        this.layout.percentFill = currFill;\r\n    }\r\n}","import AnimationSet from \"./AnimationSet\";\r\nimport LayoutState from './LayoutState';\r\nimport EqContent from \"../layout/EqContent\";\r\nimport Animation from './Animation';\r\nimport { removeEasing } from \"../main/consts\";\r\n\r\nexport default class RemoveAnimation extends Animation {\r\n\r\n    constructor(start: LayoutState, set: AnimationSet, ctx: CanvasRenderingContext2D, duration: number) {\r\n        super(duration, removeEasing, set, start, start.withZeroScale(), start.component as EqContent<any>, ctx);\r\n    }\r\n}","import Animation from './Animation';\r\nimport LayoutState from './LayoutState';\r\nimport AnimationSet from './AnimationSet';\r\nimport EqContent from '../layout/EqContent';\r\nimport { moveEasing } from '../main/consts';\r\n\r\nexport default class ReverseEvalAnimation extends Animation {\r\n\r\n    constructor(from: LayoutState, to: LayoutState, set: AnimationSet, ctx: CanvasRenderingContext2D, duration: number) {\r\n\r\n        super(  duration, moveEasing, set, \r\n                from.withZeroScale(), to, \r\n                to.component as EqContent<any>, ctx);\r\n    }\r\n}","import LayoutState from \"./LayoutState\";\r\nimport EqComponent from \"../layout/EqComponent\";\r\n\r\nexport default class RootContainerLayoutState extends LayoutState {\r\n    \r\n    // Points relative to the top left of the container where corners\r\n    // or tips of the radical reside.\r\n    kinkTipX: number;\r\n    kinkTipY: number;\r\n\r\n    kinkTopX: number;\r\n    kinkTopY: number;\r\n\r\n    tickBotX: number;\r\n    tickBotY: number;\r\n\r\n    tickTopX: number;\r\n    tickTopY: number;\r\n\r\n    endX: number;\r\n    endY: number;\r\n\r\n    constructor(layoutParent: LayoutState, component: EqComponent<any>,\r\n                tlx: number, tly: number, width: number, height: number, scale: number,\r\n                kinkTipX: number, kinkTipY: number,\r\n                kinkTopX: number, kinkTopY: number,\r\n                tickBotX: number, tickBotY: number,\r\n                tickTopX: number, tickTopY: number,\r\n                endX: number, endY: number) {\r\n        super(layoutParent, component, tlx, tly, width, height, scale);\r\n        this.kinkTipX = kinkTipX;\r\n        this.kinkTipY = kinkTipY;\r\n        this.kinkTopX = kinkTopX;\r\n        this.kinkTopY = kinkTopY;\r\n        this.tickBotX = tickBotX;\r\n        this.tickBotY = tickBotY;\r\n        this.tickTopX = tickTopX;\r\n        this.tickTopY = tickTopY;\r\n        this.endX = endX;\r\n        this.endY = endY;\r\n    }\r\n\r\n    /**\r\n     * Returns a new Layout State the same\r\n     * as this one, but with a scaling of 0.\r\n     */\r\n    withZeroScale(): RootContainerLayoutState {\r\n        return new RootContainerLayoutState(\r\n            this.layoutParent, this.component,\r\n            this.tlx, this.tly, this.width, this.height, 0,\r\n            this.kinkTipX, this.kinkTipY, this.kinkTopX, this.kinkTopY,\r\n            this.tickBotX, this.tickBotY, this.tickTopX, this.tickTopY,\r\n            this.endX, this.endY);\r\n    }\r\n}","import Padding from \"../layout/Padding\";\r\nimport ContentLayoutState from \"./ContentLayoutState\";\r\nimport { termPadding, tightTermPadding } from \"../main/consts\";\r\n\r\nexport default class TermLayoutState extends ContentLayoutState {\r\n    \r\n    padding: Padding = termPadding;\r\n\r\n    /**\r\n     * Change this layout state to\r\n     * reflect a Term in a tight\r\n     * layout. This reduces padding\r\n     * and width.\r\n     * \r\n     * @param widthDiff The difference in width between a tight and normal term.\r\n     */\r\n    tighten(widthDiff: number): void {\r\n        this.padding = tightTermPadding;\r\n        this.width -= widthDiff;\r\n    }\r\n\r\n    /**\r\n     * Returns a new Layout State the same\r\n     * as this one, but with a scaling of 0.\r\n     */\r\n    withZeroScale(): TermLayoutState {\r\n        return new TermLayoutState( this.layoutParent, \r\n                                this.component,\r\n                                this.tlx,\r\n                                this.tly,\r\n                                this.width, \r\n                                this.height,\r\n                                0,\r\n                                this.color,\r\n                                0);\r\n    }\r\n}","import EqContent from \"./EqContent\";\r\nimport ContentLayoutState from \"../animation/ContentLayoutState\";\r\nimport LayoutState from \"../animation/LayoutState\";\r\nimport EqComponent from \"./EqComponent\";\r\nimport { Map } from '../main/helpers';\r\nimport Padding from \"./Padding\";\r\nimport { curvedOutlineBorderRadius } from \"../main/consts\";\r\n\r\n/**\r\n * Temporary content that draws a curved outline.\r\n */\r\nexport default class CurvedOutline extends EqContent<ContentLayoutState> {\r\n\r\n    private layout: ContentLayoutState;\r\n\r\n    /**\r\n     * Initialize a curved outline with the same dimensions\r\n     * as a layout state.\r\n     * @param mimic The layout state to mimic.\r\n     * @param addTo The collection to add this outline to.\r\n     * @param opacity The opacity to render as.\r\n     */\r\n    constructor(padding: Padding, mimic: LayoutState, addTo: Map<EqComponent<any>, LayoutState>,\r\n                opacity: number, color: [number, number, number]) {\r\n        super(padding, undefined);\r\n        const padWidth = padding.width();\r\n        const padHeight = padding.height();\r\n        this.layout = new ContentLayoutState(undefined, this,\r\n            mimic.tlx - padWidth / 2, mimic.tly - padHeight / 2, mimic.width + padWidth, mimic.height + padHeight, mimic.scale,\r\n            color, opacity);\r\n        addTo.set(this, this.layout);\r\n        this.width = this.layout.width;\r\n        this.height = this.layout.height;\r\n    }\r\n\r\n    getLayout(): ContentLayoutState {\r\n        return this.layout;\r\n    }\r\n\r\n    /**\r\n     * Draws the content on the canvas.\r\n     * \r\n     * @param before The starting layout state.\r\n     * @param after The ending layout state.\r\n     * @param progress The progress through the animation from 0-1.\r\n     * @param ctx The graphics context to draw on.\r\n     */\r\n    draw(before: ContentLayoutState, after: ContentLayoutState, progress: number, ctx: CanvasRenderingContext2D) {\r\n        this.setupCtx(before, after, progress, ctx);\r\n        // Draw rectangle with rounded corners\r\n        const halfWidth = this.width / 2;\r\n        const halfHeight = this.height / 2;\r\n        const r = curvedOutlineBorderRadius;\r\n        ctx.beginPath();\r\n        // Top line\r\n        ctx.moveTo(-halfWidth + r, -halfHeight);\r\n        ctx.lineTo(halfWidth - r, -halfHeight);\r\n        // Top right corner\r\n        ctx.quadraticCurveTo(halfWidth, -halfHeight, halfWidth, -halfHeight + r);\r\n        // Right line\r\n        ctx.lineTo(halfWidth, halfHeight - r);\r\n        // Bottom right corner\r\n        ctx.quadraticCurveTo(halfWidth, halfHeight, halfWidth - r, halfHeight);\r\n        // Bottom line\r\n        ctx.lineTo(-halfWidth + r, halfHeight);\r\n        // Bottom left corner\r\n        ctx.quadraticCurveTo(-halfWidth, halfHeight, -halfWidth, halfHeight - r);\r\n        // Left line\r\n        ctx.lineTo(-halfWidth, -halfHeight + r);\r\n        // Top left corner\r\n        ctx.quadraticCurveTo(-halfWidth, -halfHeight, -halfWidth + r, -halfHeight);\r\n\r\n        // Finish up\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n\r\n    protected calcWidth(): number { return this.width }\r\n    protected calcHeight(): number { return this.height }\r\n\r\n    /**\r\n     * Add the Layout State for this component, and any other\r\n     * related components such as children of a container.\r\n     * \r\n     * @param parentLayout The frame of the container containing this component.\r\n     * @param layouts The map of layouts to add to.\r\n     * @param tlx The left x of this component.\r\n     * @param tly The top y of this component.\r\n     * @param currScale The current canvas scaling factor.\r\n     * @param opacityObj The object storing opacity info for this step.\r\n     * @param colorsObj The object storing color info for this step.\r\n     */\r\n    addLayout(  parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>, \r\n                tlx: number, tly: number, currScale: number,\r\n                opacityObj: Object, colorsObj: Object): ContentLayoutState {\r\n        return undefined;\r\n    }\r\n\r\n}","import LayoutState from '../animation/LayoutState';\r\nimport Padding from './Padding';\r\nimport { Map } from '../main/helpers';\r\nimport { MouseEventCallback } from '../main/CanvasController';\r\nimport EqContent from './EqContent';\r\n\r\n/**\r\n * Represents any component (container, content)\r\n * that takes up space and forms a part of the\r\n * layout of a step.\r\n * The type L represents the Layout State that this\r\n * component produces.\r\n */\r\nexport default abstract class EqComponent<L extends LayoutState> {\r\n\r\n    protected width: number;\r\n    protected height: number;\r\n    protected padding: Padding;\r\n\r\n    constructor(padding) {\r\n        this.padding = padding;\r\n    }\r\n\r\n    setWidth(newWidth: number) {\r\n        this.width = newWidth;\r\n    }\r\n\r\n    setHeight(newHeight: number) {\r\n        this.height = newHeight;\r\n    }\r\n\r\n    getWidth(): number {\r\n        return this.width;\r\n    }\r\n\r\n    getHeight(): number {\r\n        return this.height;\r\n    }\r\n\r\n    getPadding(): Padding {\r\n        return this.padding;\r\n    }\r\n\r\n    /**\r\n     * Recalc dimensions for this component, and all children if\r\n     * this is a container. Default implementation does just for\r\n     * this component.\r\n     */\r\n    recalcDimensions() {\r\n        this.width = this.calcWidth();\r\n        this.height = this.calcHeight();\r\n    }\r\n\r\n    /**\r\n     * Return the vertical dimensions that form the 'main text line'\r\n     * of this component. This is only relevant to HBoxes, which will\r\n     * ensure that their children's main text lines line up. These\r\n     * dimensions are given with respect to the top of this component,\r\n     * including padding. The default implementation given here returns\r\n     * undefined, indicating that the component does not have a main\r\n     * text line. Components that do this are simply vertically centered\r\n     * in the HBox.\r\n     */\r\n    getMainTextLine(): [number, number] {\r\n        return undefined;\r\n    }\r\n\r\n    protected abstract calcWidth(): number;\r\n    protected abstract calcHeight(): number;\r\n\r\n    /**\r\n     * Add the Layout State for this component, and any other\r\n     * related components such as children of a container.\r\n     * \r\n     * @param parentLayout The frame of the container containing this component.\r\n     * @param layouts The map of layouts to add to.\r\n     * @param tlx The left x of this component.\r\n     * @param tly The top y of this component.\r\n     * @param currScale The current canvas scaling factor.\r\n     * @param opacityObj The object storing opacity info for this step.\r\n     * @param colorsObj The object storing color info for this step.\r\n     * @param mouseEnter Mouse enter events for this step.\r\n     * @param mouseExit Mouse exit events for this step.\r\n     * @param mouseClick Mouse click events for this step.\r\n     * @param tempContent Temporary content added only for this step.\r\n     */\r\n    abstract addLayout( parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>, \r\n                        tlx: number, tly: number, currScale: number,\r\n                        opacityObj: Object, colorsObj: Object,\r\n                        mouseEnter: Map<LayoutState, MouseEventCallback>, \r\n                        mouseExit: Map<LayoutState, MouseEventCallback>, \r\n                        mouseClick: Map<LayoutState, MouseEventCallback>,\r\n                        tempContent: EqContent<any>[]): L;\r\n}","import EqComponent from './EqComponent';\r\nimport LayoutState from '../animation/LayoutState';\r\nimport Padding from './Padding';\r\n\r\n/**\r\n * Umbrella class for all containers. Doesn't declare anything, but useful for\r\n * checking if a variable is a container using instanceof.\r\n */\r\nexport default abstract class EqContainer<L extends LayoutState> extends EqComponent<L> {\r\n\r\n    constructor(padding: Padding) {\r\n        super(padding);\r\n    }\r\n}","import EqComponent from \"./EqComponent\";\r\nimport Padding from \"./Padding\";\r\nimport ContentLayoutState from \"../animation/ContentLayoutState\";\r\nimport { rgbaArrayToCssString } from \"../main/helpers\";\r\nimport { normalOpacity } from \"../main/consts\";\r\n\r\nexport default abstract class EqContent<L extends ContentLayoutState> extends EqComponent<L> {\r\n\r\n    static colors: {[color: string]: [number, number, number]};\r\n\r\n    protected ref: string;\r\n    //Whether to interpolate color and opacity\r\n    //during the current animation.\r\n    protected interpColor = true;\r\n\r\n    constructor(padding: Padding, ref: string) {\r\n        super(padding);\r\n        this.ref = ref;\r\n    }\r\n\r\n    /**\r\n     * Sets up the Canvas by performing\r\n     * transformations and style changes.\r\n     * Subclasses should call the method as\r\n     * defined here, then draw themselves\r\n     * centered on (0, 0). Returns width\r\n     * and height to allow them \r\n     * to do this.\r\n     * There is no need to call save() or\r\n     * restore(), animations handle this.\r\n     * \r\n     * @param before The State before.\r\n     * @param after The State after.\r\n     * @param progress How close we are to after, from before,\r\n     *                 from 0-1.\r\n     * @param ctx The rendering context.\r\n     */\r\n    protected setupCtx(before: L, after: L, progress: number, ctx: CanvasRenderingContext2D): [number, number] {\r\n        let invProg = 1 - progress;\r\n        let x = before.tlx * invProg + after.tlx * progress;\r\n        let y = before.tly * invProg + after.tly * progress;\r\n        let width = before.width * invProg + after.width * progress;\r\n        let height = before.height * invProg + after.height * progress;\r\n        let scale = before.scale * invProg + after.scale * progress;\r\n        ctx.translate(x + width / 2, y + height / 2);\r\n        ctx.scale(scale, scale);\r\n        this.setupCtxStyle(before, after, progress, ctx);\r\n        return [width, height];\r\n    }\r\n\r\n    /**\r\n     * Interpolates color and opacity and sets up the\r\n     * canvas to draw with the right color and opacity.\r\n     * \r\n     * @param before The State before.\r\n     * @param after The State after.\r\n     * @param progress How close we are to after, from before,\r\n     *                 from 0-1.\r\n     * @param ctx The rendering context.\r\n     */\r\n    protected setupCtxStyle(before: L, after: L, progress: number, ctx: CanvasRenderingContext2D): void {\r\n        if (progress === 0) {\r\n            //Check whether to interpolate color at start of animation\r\n            let colB = before.color;\r\n            let colA = after.color;\r\n            this.interpColor =  colB[0] !== colA[0] ||\r\n            colB[1] !== colA[1] ||\r\n            colB[2] !== colA[2] ||\r\n            before.opacity !== after.opacity;\r\n        }\r\n        let color = before.color;\r\n        let opacity = before.opacity;\r\n        if (this.interpColor) {\r\n            let invProg = 1 - progress;\r\n            let r = before.color[0] * invProg + after.color[0] * progress;\r\n            let g = before.color[1] * invProg + after.color[1] * progress;\r\n            let b = before.color[2] * invProg + after.color[2] * progress;\r\n            let a = before.opacity * invProg + after.opacity * progress;\r\n            color = [Math.round(r), Math.round(g), Math.round(b)];\r\n            opacity = a;\r\n        }\r\n        this.setCtxStyle(ctx, color, opacity);\r\n    }\r\n\r\n    /**\r\n     * Draws the content on the canvas.\r\n     * \r\n     * @param before The starting layout state.\r\n     * @param after The ending layout state.\r\n     * @param progress The progress through the animation from 0-1.\r\n     * @param ctx The graphics context to draw on.\r\n     */\r\n    abstract draw(before: L, after: L, progress: number, ctx: CanvasRenderingContext2D);\r\n\r\n    /**\r\n     * Sets a graphics context to have\r\n     * a certain color and opacity.\r\n     * \r\n     * @param ctx The graphics context.\r\n     * @param color The color.\r\n     * @param opacity The opacity.\r\n     */\r\n    protected setCtxStyle(ctx: CanvasRenderingContext2D, color: number[], opacity: number) {\r\n        const style = rgbaArrayToCssString(color.concat([opacity]));\r\n        ctx.fillStyle = style;\r\n        ctx.strokeStyle = style;\r\n    }\r\n\r\n    /**\r\n     * Given a colors object, determine what\r\n     * color this content should be.\r\n     * \r\n     * @param colorObj The colors object for a step.\r\n     */\r\n    protected getColorForContent(colorObj: object): number[] {\r\n        if (colorObj !== undefined && colorObj[this.ref] !== undefined) {\r\n            //A color is specified\r\n            return EqContent.colors[colorObj[this.ref]];\r\n        } else {\r\n            //A color isn't specified, use default\r\n            return EqContent.colors['default'];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets the opacity for this content\r\n     * at a step.\r\n     * \r\n     * @param opacityObj The opacities object for a step.\r\n     */\r\n    protected getOpacityForContent(opacityObj: object): number {\r\n        if (opacityObj !== undefined && opacityObj[this.ref] !== undefined) {\r\n            //Opacity specified\r\n            return opacityObj[this.ref];\r\n        } else {\r\n            //No opacity specified\r\n            return normalOpacity;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set the content to not interpolate color\r\n     * until setupCtx is called with progress = 0.\r\n     */\r\n    interpColorOff() {\r\n        this.interpColor = false;\r\n    }\r\n\r\n    getRef() {\r\n        return this.ref;\r\n    }\r\n}","import EqComponent from './EqComponent';\r\nimport Padding from './Padding';\r\nimport LayoutState from '../animation/LayoutState';\r\nimport { Map, newMap, parseContainerChildren } from '../main/helpers';\r\nimport LinearContainer from './LinearContainer';\r\nimport { MouseEventCallback } from '../main/CanvasController';\r\nimport EqContent from './EqContent';\r\nimport { Container } from '../main/ComponentModel';\r\nimport { LinearContainerFormat } from '../main/FileFormat';\r\nimport { defaultHBoxPadding } from '../main/consts';\r\n\r\n@Container({\r\n    typeString: 'hbox',\r\n    parse: (containerObj, depth, contentGetter, containerGetter) => {\r\n        // Return HBox from file\r\n        const format = containerObj as LinearContainerFormat;\r\n        const children = parseContainerChildren(format.children, depth + 1, containerGetter, contentGetter);\r\n        return new HBox(children, Padding.even(defaultHBoxPadding));\r\n    }\r\n})\r\nexport default class HBox extends LinearContainer<LayoutState> {\r\n\r\n    // Calculated initially, stored for later\r\n    protected mainLine: [number, number];\r\n    protected middleMainLineDist: number; // Vertical distance from top of this to middle of main line\r\n\r\n    constructor(children: EqComponent<any>[], padding: Padding) {\r\n        super(children, padding);\r\n        this.width = this.calcWidth();\r\n        this.height = this.calcHeight();\r\n    }\r\n\r\n    protected calcHeight(): number {\r\n        // Line up text of children, then return their position relative to this component\r\n\r\n        // Sort children into those with a line and those without\r\n        // Store their line if they have one\r\n        const childrenWithLine: Map<EqComponent<any>, [number, number]> = newMap();\r\n        const childrenWithoutLine: Map<EqComponent<any>, undefined> = newMap();\r\n        \r\n        for (let i = 0; i < this.children.length; i++) {\r\n            const child = this.children[i];\r\n            const line = child.getMainTextLine();\r\n            \r\n            if (line === undefined) {\r\n                childrenWithoutLine.set(child, undefined);\r\n            } else {\r\n                childrenWithLine.set(child, line);\r\n            }\r\n        }\r\n\r\n        // Calculate the height that the aligned children will take up\r\n        // To do this, we find the maximum of two distances:\r\n        //  - From the middle of the main line to the top of the component\r\n        //  - From the middle of the main line to the bottom of the component\r\n        // And we add them together.\r\n        let maxAboveAligned = 0;\r\n        let maxBelowAligned = 0;\r\n        let lineHeight: number; // Must be consistently one of CanvasController.termHeights for all components\r\n\r\n        childrenWithLine.forEach((line, component) => {\r\n            lineHeight = line[1] - line[0];\r\n            const compHeight = component.getHeight();\r\n            const middleOfLine = (line[0] + line[1]) / 2;\r\n            const above = middleOfLine;\r\n            const below = compHeight - middleOfLine;\r\n\r\n            if (above > maxAboveAligned) {\r\n                maxAboveAligned = above;\r\n            }\r\n\r\n            if (below > maxBelowAligned) {\r\n                maxBelowAligned = below;\r\n            }\r\n        });\r\n\r\n        // See if any non-aligned components will poke above/below this\r\n        // when centered with the middle of the aligned line\r\n        let maxAboveNonAligned = maxAboveAligned;\r\n        let maxBelowNonAligned = maxBelowAligned;\r\n        childrenWithoutLine.forEach((nothing, component) => {\r\n            const halfCompHeight = component.getHeight() / 2;\r\n\r\n            if (halfCompHeight > maxAboveNonAligned) {\r\n                maxAboveNonAligned = halfCompHeight;\r\n            }\r\n\r\n            if (halfCompHeight > maxBelowNonAligned) {\r\n                maxBelowNonAligned = halfCompHeight;\r\n            }\r\n        });\r\n\r\n        // Case for if there are no aligned children\r\n        if (childrenWithLine.size === 0) {\r\n            this.mainLine = undefined;\r\n            const finalHeight = maxAboveNonAligned + maxBelowNonAligned + this.padding.height();\r\n            this.middleMainLineDist = finalHeight / 2;\r\n            return finalHeight;\r\n        }\r\n        \r\n        // Distance between top of this and start of aligned part\r\n        const topAlignedDist = maxAboveNonAligned > maxAboveAligned ? maxAboveNonAligned - maxAboveAligned : 0;\r\n\r\n        // Distance from top of this to top of main line\r\n        const topMainLineDist = this.padding.top + topAlignedDist + maxAboveAligned - lineHeight / 2;\r\n        \r\n        // Distance from top of this to bottom of main line\r\n        const botMainLineDist = topMainLineDist + lineHeight;\r\n        \r\n        this.middleMainLineDist = topMainLineDist + (botMainLineDist - topMainLineDist) / 2;\r\n        this.mainLine = [topMainLineDist, botMainLineDist];\r\n        \r\n        // The final height\r\n        return maxAboveNonAligned + maxBelowNonAligned + this.padding.height();\r\n    }\r\n\r\n    protected calcWidth(): number {\r\n        let totalWidth = 0;\r\n        for (let i = 0; i < this.children.length; i++) {\r\n            let currChild = this.children[i];\r\n            totalWidth += currChild.getWidth();\r\n        }\r\n        return totalWidth + this.padding.width();\r\n    }\r\n\r\n    getMainTextLine(): [number, number] {\r\n        return (this.mainLine ? this.mainLine.slice() : undefined) as [number, number];\r\n    }\r\n\r\n    addLayout(  parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>, \r\n                tlx: number, tly: number, currScale: number,\r\n                opacityObj: Object, colorObj: Object,\r\n                mouseEnter: Map<LayoutState, MouseEventCallback>,\r\n                mouseExit: Map<LayoutState, MouseEventCallback>, \r\n                mouseClick: Map<LayoutState, MouseEventCallback>,\r\n                tempContent: EqContent<any>[]): LayoutState {\r\n\r\n        let state = new LayoutState(\r\n            parentLayout, this, \r\n            tlx, tly, \r\n            this.getWidth() * currScale, \r\n            this.getHeight() * currScale, \r\n            currScale\r\n        );\r\n\r\n        let upToX = tlx + this.padding.left * currScale;\r\n\r\n        for (let i = 0; i < this.children.length; i++) {\r\n            let currChild = this.children[i];\r\n            let childHeight = currChild.getHeight() * currScale;\r\n            let childLine = currChild.getMainTextLine();\r\n\r\n            // Position child in the middle of the main line if it isn't aligned\r\n            // Position its main line in the middle of this's main line if it is\r\n            let childTLY = tly;\r\n            if (childLine) {\r\n                childLine[0] *= currScale;\r\n                childLine[1] *= currScale;\r\n\r\n                childTLY += this.middleMainLineDist * currScale - (childLine[1] + childLine[0]) / 2;\r\n            } else {\r\n                childTLY += this.middleMainLineDist * currScale - childHeight / 2;\r\n            }\r\n\r\n            upToX += currChild.addLayout(   \r\n                state, layouts, \r\n                upToX, childTLY, \r\n                currScale, opacityObj, colorObj,\r\n                mouseEnter, mouseExit, mouseClick,\r\n                tempContent\r\n            ).width;\r\n        }\r\n\r\n        layouts.set(this, state);\r\n\r\n        return state;\r\n    }\r\n}","import EqContent from \"./EqContent\";\r\nimport { line } from '../main/helpers';\r\nimport Padding from \"./Padding\";\r\nimport { Map } from '../main/helpers';\r\nimport EqComponent from \"./EqComponent\";\r\nimport { OriginalDimenLayoutState } from \"../animation/OriginalDimenLayoutState\";\r\nimport LayoutState from \"../animation/LayoutState\";\r\nimport { Content } from \"../main/ComponentModel\";\r\nimport { hDividerPadding } from \"../main/consts\";\r\n\r\n@Content({\r\n    character: 'h',\r\n    initialize: file => {\r\n        const dividers: HDivider[] = [];\r\n        for (let i = 0; i < file.hDividers; i++) {\r\n            dividers.push(new HDivider(hDividerPadding, 'h' + i));\r\n        }\r\n        return dividers;\r\n    }\r\n})\r\nexport default class HDivider extends EqContent<OriginalDimenLayoutState> {\r\n\r\n    constructor(padding: Padding, ref: string) {\r\n        super(padding, ref);\r\n        this.height = this.calcHeight();\r\n        //For layout purposes, the divider\r\n        //has no width. It stretches to fill\r\n        //its container.\r\n        this.width = this.calcWidth();\r\n    }\r\n\r\n    setPadding(newPadding: Padding) {\r\n        this.padding = newPadding;\r\n    }\r\n\r\n    protected calcWidth(): number {return 0;}\r\n    protected calcHeight(): number {return 1 + this.padding.height();}\r\n\r\n    addLayout(  parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>, \r\n                tlx: number, tly: number, currScale: number,\r\n                opacityObj: Object, colorsObj: Object): OriginalDimenLayoutState {\r\n        //Set x to align left with parent\r\n        let x = parentLayout.tlx;\r\n        let width = parentLayout.width;\r\n        let height = this.getHeight();\r\n        let state = new OriginalDimenLayoutState(\r\n            parentLayout, this, \r\n            x, tly, width, height, currScale,\r\n            this.getColorForContent(colorsObj), this.getOpacityForContent(opacityObj),\r\n            width / currScale, height\r\n        );\r\n        layouts.set(this, state);\r\n        return state;\r\n    }\r\n\r\n    draw(before: OriginalDimenLayoutState, after: OriginalDimenLayoutState, progress: number, ctx: CanvasRenderingContext2D) {\r\n        this.setupCtx(before, after, progress, ctx);\r\n        const width = before.origInnerWidth * (1 - progress) + after.origInnerWidth * progress;\r\n        line(-width / 2 + this.padding.left, 0, width / 2 - this.padding.right, 0, ctx);\r\n    }\r\n}","import EqContainer from \"./EqContainer\";\r\nimport EqComponent from \"./EqComponent\";\r\nimport Padding from \"./Padding\";\r\nimport LayoutState from \"../animation/LayoutState\";\r\n\r\n/**\r\n * Represents a simple linear container\r\n * whose contents can be represented as\r\n * a single children array.\r\n */\r\nexport default abstract class LinearContainer<L extends LayoutState> extends EqContainer<L> {\r\n\r\n    protected children: EqComponent<any>[];\r\n\r\n    constructor(children: EqComponent<any>[], padding: Padding) {\r\n        super(padding);\r\n        this.children = children;\r\n    }\r\n\r\n    getChildren(): EqComponent<any>[] {\r\n        return this.children;\r\n    }\r\n\r\n    recalcDimensions() {\r\n        this.children.forEach(child => child.recalcDimensions());\r\n        super.recalcDimensions();\r\n    }\r\n}","export default class Padding {\r\n\r\n    // The amount to inset on each side\r\n    top: number;\r\n    left: number;\r\n    bottom: number;\r\n    right: number;\r\n\r\n    constructor(top, left, bottom, right) {\r\n        this.top = top;\r\n        this.left = left;\r\n        this.bottom = bottom;\r\n        this.right = right;\r\n    }\r\n\r\n    height(): number {\r\n        return this.top + this.bottom;\r\n    }\r\n\r\n    width(): number {\r\n        return this.left + this.right;\r\n    }\r\n\r\n    /**\r\n     * Return a new Padding, having scaled this\r\n     * one by a certain amount.\r\n     * @param by The amount to scale by.\r\n     */\r\n    scale(by: number): Padding {\r\n        return new Padding(\r\n            this.top * by,\r\n            this.left * by,\r\n            this.bottom * by,\r\n            this.right * by\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Return a new Padding with same insets on\r\n     * each side.\r\n     * @param amount The amount of inset on each side.\r\n     */\r\n    static even(amount: number): Padding {\r\n        return new Padding(amount, amount, amount, amount);\r\n    }\r\n}","import VBox from \"./VBox\";\r\nimport EqComponent from \"./EqComponent\";\r\nimport Padding from \"./Padding\";\r\nimport LayoutState from \"../animation/LayoutState\";\r\nimport CanvasController, { MouseEventCallback } from \"../main/CanvasController\";\r\nimport { Map, parseContainerChildren } from '../main/helpers';\r\nimport CurvedOutline from \"./CurvedOutline\";\r\nimport ContentLayoutState from \"../animation/ContentLayoutState\";\r\nimport AnimationSet from \"../animation/AnimationSet\";\r\nimport OutlineFadeAnimation from \"../animation/OutlineFadeAnimation\";\r\nimport OutlineColorAnimation from \"../animation/OutlineColorAnimation\";\r\nimport EqContent from \"./EqContent\";\r\nimport RadioButton from \"./RadioButton\";\r\nimport RadioButtonSelectAnimation from \"../animation/RadioButtonSelectAnimation\";\r\nimport RadioButtonLayoutState from \"../animation/RadioButtonLayoutState\";\r\nimport { Container } from \"../main/ComponentModel\";\r\nimport { QuizFormat } from \"../main/FileFormat\";\r\nimport { defaultQuizPadding, curvedOutlineDefaultOpacity, curvedOutlineColor, radioButtonDefaultOpacity, radioButtonColor, quizCorrectColor, quizIncorrectColor, quizCurvedOutlinePadding, quizRadioButtonDimen, answerVMargin, quizRadioButtonPadding, revealedOutlineOpacity, hoveredOutlineOpacity, quizRadioButtonSelectDuration, quizRadioButtonSelectEasing, quizRadioButtonDeselectDuration, quizRadioButtonDeselectEasing } from \"../main/consts\";\r\n\r\n@Container({\r\n    typeString: 'quiz',\r\n    parse: (containerObj, depth, contentGetter, containerGetter, inf) => {\r\n        const format = containerObj as QuizFormat;\r\n        return new Quiz(\r\n            parseContainerChildren(format.children, depth + 1, containerGetter, contentGetter),\r\n            defaultQuizPadding,\r\n            format.answers,\r\n            inf['customColors'] && inf['customColors'].curvedOutlineOpacity ? inf['customColors'].curvedOutlineOpacity : curvedOutlineDefaultOpacity,\r\n            inf['customColors'] && inf['customColors'].curvedOutlineColor ? inf['customColors'].curvedOutlineColor : curvedOutlineColor,\r\n            inf['customColors'] && inf['customColors'].radioButtonOpacity ? inf['customColors'].radioButtonOpacity : radioButtonDefaultOpacity,\r\n            inf['customColors'] && inf['customColors'].radioButtonColor ? inf['customColors'].radioButtonColor : radioButtonColor,\r\n            inf['customColors'] && inf['customColors'].quizCorrectColor ? inf['customColors'].quizCorrectColor : quizCorrectColor,\r\n            inf['customColors'] && inf['customColors'].quizIncorrectColor ? inf['customColors'].quizIncorrectColor : quizIncorrectColor\r\n        );\r\n    }\r\n})\r\nexport default class Quiz extends VBox {\r\n\r\n    protected answers: boolean[];\r\n    protected clickedIndex = -1;\r\n\r\n    protected outlineOpacity: number;\r\n    protected outlineColor: [number, number, number];\r\n\r\n    protected radioButtonOpacity: number;\r\n    protected radioButtonColor: [number, number, number];\r\n\r\n    protected correctColor: [number, number, number];\r\n    protected incorrectColor: [number, number, number];\r\n\r\n    constructor(children: EqComponent<any>[], padding: Padding, answers: number[],\r\n        outlineOpacity: number, outlineColor: [number, number, number],\r\n        radioButtonOpacity: number, radioButtonColor: [number, number, number],\r\n        correctColor: [number, number, number], incorrectColor: [number, number, number]) {\r\n        super(children, padding);\r\n        this.outlineOpacity = outlineOpacity;\r\n        this.outlineColor = outlineColor;\r\n        this.radioButtonOpacity = radioButtonOpacity;\r\n        this.radioButtonColor = radioButtonColor;\r\n        this.correctColor = correctColor;\r\n        this.incorrectColor = incorrectColor;\r\n        this.answers = [];\r\n        answers.forEach(index => this.answers[index] = true);\r\n    }\r\n\r\n    // Override to add padding\r\n    protected calcWidth(): number {\r\n        return super.calcWidth() + quizCurvedOutlinePadding.width() + quizRadioButtonDimen;\r\n    }\r\n\r\n    // Override to add margin\r\n    protected calcHeight(): number {\r\n        return super.calcHeight() + answerVMargin * (this.children.length + 2);\r\n    }\r\n\r\n    addLayout(parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>,\r\n        tlx: number, tly: number, currScale: number,\r\n        opacityObj: Object, colorsObj: Object,\r\n        mouseEnter: Map<LayoutState, MouseEventCallback>,\r\n        mouseExit: Map<LayoutState, MouseEventCallback>,\r\n        mouseClick: Map<LayoutState, MouseEventCallback>,\r\n        tempContent: EqContent<any>[]): LayoutState {\r\n\r\n        let state = new LayoutState(parentLayout, this, tlx, tly,\r\n            this.getWidth() * currScale,\r\n            this.getHeight() * currScale,\r\n            currScale);\r\n        const innerWidth = (this.getWidth() - this.padding.width()) * currScale;\r\n        let upToY = tly + this.padding.top * currScale + answerVMargin;\r\n\r\n        let allOutlines: LayoutState[] = [];\r\n        let allButtons: LayoutState[] = [];\r\n\r\n        for (let i = 0; i < this.children.length; i++) {\r\n            let currChild = this.children[i];\r\n\r\n            // Width of the whole row (button, outline, and child)\r\n            const rowWidth = currChild.getWidth() + quizCurvedOutlinePadding.width() + quizRadioButtonDimen;\r\n\r\n            // Height of the whole row (same as height of child)\r\n            const rowHeight = currChild.getHeight();\r\n\r\n            // Start x of the whole row\r\n            const rowTLX = tlx + (innerWidth - rowWidth) / 2;\r\n\r\n            // Add radio button\r\n            const radioButton = new RadioButton(\r\n                quizRadioButtonPadding, rowTLX, upToY + (rowHeight - quizRadioButtonDimen) / 2,\r\n                quizRadioButtonDimen, layouts, this.radioButtonOpacity, this.radioButtonColor\r\n            );\r\n            tempContent.push(radioButton);\r\n            const radioButtonLayout = radioButton.getLayout();\r\n            allButtons.push(radioButtonLayout);\r\n            if (this.clickedIndex === i) {\r\n                radioButtonLayout.percentFill = 1;\r\n            }\r\n\r\n            // Position child in the middle horizontally\r\n            let childTLX = rowTLX + quizRadioButtonDimen + quizCurvedOutlinePadding.left;\r\n            let childLayout = currChild.addLayout(\r\n                state, layouts,\r\n                childTLX, upToY, currScale,\r\n                opacityObj, colorsObj,\r\n                mouseEnter, mouseExit, mouseClick,\r\n                tempContent\r\n            );\r\n            upToY += childLayout.height + answerVMargin;\r\n\r\n            // Give child an outline that can respond to events.\r\n            let outline = new CurvedOutline(quizCurvedOutlinePadding, childLayout, layouts, this.outlineOpacity, this.outlineColor);\r\n            tempContent.push(outline);\r\n            let outlineLayout: ContentLayoutState = outline.getLayout();\r\n            allOutlines.push(outlineLayout);\r\n            if (this.clickedIndex !== -1) {\r\n                outlineLayout.opacity = revealedOutlineOpacity;\r\n                if (this.answers[i]) {\r\n                    outlineLayout.color = this.correctColor;\r\n                } else {\r\n                    outlineLayout.color = this.incorrectColor;\r\n                }\r\n            }\r\n\r\n            // If mouse enters outline or button, make it lighter (unless answer has been revealed)\r\n            let onEnter = (oldLayout: ContentLayoutState, set: AnimationSet, controller: CanvasController) => {\r\n                if (this.clickedIndex === -1) {\r\n                    new OutlineFadeAnimation(outlineLayout, hoveredOutlineOpacity, set);\r\n                    new RadioButtonSelectAnimation(\r\n                        quizRadioButtonSelectDuration,\r\n                        quizRadioButtonSelectEasing,\r\n                        set,\r\n                        radioButtonLayout,\r\n                        0,\r\n                        1\r\n                    );\r\n                }\r\n                controller.setCursor('pointer');\r\n            };\r\n            if (this.clickedIndex === -1) {\r\n                mouseEnter.set(outlineLayout, onEnter);\r\n                mouseEnter.set(radioButtonLayout, onEnter);\r\n            }\r\n\r\n            // If mouse exits, make darker again (unless answer has been revealed)\r\n            let onExit = (oldLayout: ContentLayoutState, set: AnimationSet, controller: CanvasController) => {\r\n                if (this.clickedIndex === -1) {\r\n                    new OutlineFadeAnimation(outlineLayout, this.outlineOpacity, set);\r\n                    new RadioButtonSelectAnimation(\r\n                        quizRadioButtonDeselectDuration,\r\n                        quizRadioButtonDeselectEasing,\r\n                        set,\r\n                        radioButtonLayout,\r\n                        1,\r\n                        0\r\n                    );\r\n                }\r\n                controller.setCursor('default');\r\n            };\r\n            if (this.clickedIndex === -1) {\r\n                mouseExit.set(outlineLayout, onExit);\r\n                mouseExit.set(radioButtonLayout, onExit);\r\n            }\r\n        }\r\n\r\n        if (this.clickedIndex === -1) {\r\n            // If mouse clicks, reveal answer\r\n            let onClick = (oldLayout: ContentLayoutState, set: AnimationSet, controller: CanvasController) => {\r\n                // Check if correct\r\n                const clickedIndex = oldLayout instanceof RadioButtonLayoutState ? allButtons.indexOf(oldLayout) : allOutlines.indexOf(oldLayout);\r\n                if (this.answers[clickedIndex]) {\r\n                    controller.setText('<em class=\"green\">Correct!</em> Tap again to see working.');\r\n                } else {\r\n                    controller.setText('<em class=\"red\">Not quite...</em> Tap again to see working.');\r\n                }\r\n                // Animate all options\r\n                allOutlines.forEach((layout: ContentLayoutState, index: number) => {\r\n                    // If correct, go green. Otherwise go red.\r\n                    const color = this.answers[index] ? this.correctColor : this.incorrectColor;\r\n                    new OutlineColorAnimation(layout, color, set);\r\n                    new OutlineFadeAnimation(layout, revealedOutlineOpacity, set);\r\n                    return true;\r\n                });\r\n                this.clickedIndex = clickedIndex;\r\n                // Remove the events so they won't be triggered again.\r\n                allOutlines.forEach(layout => {\r\n                    mouseClick.delete(layout);\r\n                    mouseEnter.delete(layout);\r\n                    mouseExit.delete(layout);\r\n                });\r\n                allButtons.forEach(layout => {\r\n                    mouseClick.delete(layout);\r\n                    mouseEnter.delete(layout);\r\n                    mouseExit.delete(layout);\r\n                });\r\n                controller.setCursor(\"default\");\r\n            };\r\n\r\n            // Bind all outlines to the same click event\r\n            allOutlines.forEach(layout => mouseClick.set(layout, onClick));\r\n            allButtons.forEach(layout => mouseClick.set(layout, onClick));\r\n        }\r\n\r\n        layouts.set(this, state);\r\n\r\n        return state;\r\n    }\r\n\r\n}","import EqContent from \"./EqContent\";\r\nimport Padding from './Padding';\r\nimport { Map, line } from '../main/helpers';\r\nimport LayoutState from '../animation/LayoutState';\r\nimport EqComponent from './EqComponent';\r\nimport RootContainerLayoutState from \"../animation/RootContainerLayoutState\";\r\nimport { OriginalDimenLayoutState } from \"../animation/OriginalDimenLayoutState\";\r\nimport { Content } from \"../main/ComponentModel\";\r\n\r\n@Content({\r\n    character: 'r',\r\n    initialize: file => {\r\n        const radicals: Radical[] = [];\r\n        for (let i = 0; i < file.radicals; i++) {\r\n            radicals.push(new Radical('r' + i));\r\n        }\r\n        return radicals;\r\n    }\r\n})\r\nexport default class Radical extends EqContent<OriginalDimenLayoutState> {\r\n\r\n    constructor(ref: string) {\r\n        super(Padding.even(0), ref);\r\n        this.height = this.calcHeight();\r\n        this.width = this.calcWidth();\r\n    }\r\n\r\n    // Radical mimics dimensions of the root container, so for layout\r\n    // purposes doesn't have dimensions to enforce.\r\n    protected calcWidth(): number { return 0; }\r\n    protected calcHeight(): number { return 0; }\r\n\r\n    /**\r\n     * Draws the content on the canvas.\r\n     * \r\n     * @param before The starting layout state.\r\n     * @param after The ending layout state.\r\n     * @param progress The progress through the animation from 0-1.\r\n     * @param ctx The graphics context to draw on.\r\n     */\r\n    draw(before: OriginalDimenLayoutState, after: OriginalDimenLayoutState, progress: number, ctx: CanvasRenderingContext2D) {\r\n        const contBefore = before.layoutParent as RootContainerLayoutState;\r\n        const contAfter = after.layoutParent as RootContainerLayoutState;\r\n        const invProg = 1 - progress;\r\n        const kinkTipX =    contBefore.kinkTipX * invProg       + contAfter.kinkTipX * progress;\r\n        const kinkTipY =    contBefore.kinkTipY * invProg       + contAfter.kinkTipY * progress;\r\n        const kinkTopX =    contBefore.kinkTopX * invProg       + contAfter.kinkTopX * progress;\r\n        const kinkTopY =    contBefore.kinkTopY * invProg       + contAfter.kinkTopY * progress;\r\n        const tickBotX =    contBefore.tickBotX * invProg       + contAfter.tickBotX * progress;\r\n        const tickBotY =    contBefore.tickBotY * invProg       + contAfter.tickBotY * progress;\r\n        const tickTopX =    contBefore.tickTopX * invProg       + contAfter.tickTopX * progress;\r\n        const tickTopY =    contBefore.tickTopY * invProg       + contAfter.tickTopY * progress;\r\n        const endX =        contBefore.endX * invProg           + contAfter.endX * progress;\r\n        const endY =        contBefore.endY * invProg           + contAfter.endY * progress;\r\n        const width =       before.origInnerWidth * invProg     + after.origInnerWidth * progress;\r\n        const height =      before.origInnerHeight * invProg    + after.origInnerHeight * progress;\r\n        this.setupCtx(before, after, progress, ctx);\r\n\r\n        const startX = -width / 2;\r\n        const startY = -height / 2;\r\n\r\n        // Kink tip\r\n        line(startX + kinkTipX, startY + kinkTipY, startX + kinkTopX, startY + kinkTopY, ctx);\r\n        // Rest of kink\r\n        line(startX + kinkTopX, startY + kinkTopY, startX + tickBotX, startY + tickBotY, ctx);\r\n        // Tick\r\n        line(startX + tickBotX, startY + tickBotY, startX + tickTopX, startY + tickTopY, ctx);\r\n        // Top\r\n        line(startX + tickTopX, startY + tickTopY, startX + endX, startY + endY, ctx);\r\n    }\r\n\r\n    /**\r\n     * Add the Layout State for this component, and any other\r\n     * related components such as children of a container.\r\n     * \r\n     * @param parentLayout The frame of the container containing this component.\r\n     * @param layouts The map of layouts to add to.\r\n     * @param tlx The left x of this component.\r\n     * @param tly The top y of this component.\r\n     * @param currScale The current canvas scaling factor.\r\n     * @param opacityObj The object storing opacity info for this step.\r\n     * @param colorsObj The object storing color info for this step.\r\n     */\r\n    addLayout(  parentLayout: RootContainerLayoutState, layouts: Map<EqComponent<any>, LayoutState>, \r\n                tlx: number, tly: number, currScale: number,\r\n                opacityObj: Object, colorsObj: Object): OriginalDimenLayoutState {\r\n        const parentPad = parentLayout.component.getPadding().scale(currScale);\r\n        const padWidth = parentPad.width();\r\n        const padHeight = parentPad.height();\r\n        const thisLayout = new OriginalDimenLayoutState(\r\n            parentLayout, this, tlx + padWidth / 2, tly + padHeight / 2,\r\n            parentLayout.width - padWidth, parentLayout.height - padHeight,\r\n            currScale, this.getColorForContent(colorsObj), this.getOpacityForContent(opacityObj),\r\n            (parentLayout.width - padWidth) / currScale, (parentLayout.height - padHeight) / currScale\r\n        );\r\n        layouts.set(this, thisLayout);\r\n        return thisLayout;\r\n    }\r\n}","import ContentLayoutState from \"../animation/ContentLayoutState\";\r\nimport EqContent from \"./EqContent\";\r\nimport Padding from \"./Padding\";\r\nimport EqComponent from \"./EqComponent\";\r\nimport LayoutState from \"../animation/LayoutState\";\r\nimport { Map } from '../main/helpers';\r\nimport RadioButtonLayoutState from \"../animation/RadioButtonLayoutState\";\r\n\r\nexport default class RadioButton extends EqContent<RadioButtonLayoutState> {\r\n\r\n    private layout: RadioButtonLayoutState;\r\n\r\n    /**\r\n     * Create a new Radio Button at the specified coordinates.\r\n     * @param padding The padding to use. The drawn circle goes to the edge of the padding.\r\n     * @param tlx The x-ordinate of the top left of the button, including padding.\r\n     * @param tly The y-ordinate of the top left of the button, including padding.\r\n     * @param dimen The width and height of the button.\r\n     * @param addTo The collection to add the layout state of this radio button to.\r\n     * @param opacity The opacity to render as.\r\n     */\r\n    constructor(padding: Padding, tlx: number, tly: number, dimen: number, addTo: Map<EqComponent<any>, LayoutState>,\r\n                opacity: number, color: [number, number, number]) {\r\n        super(padding, undefined);\r\n\r\n        this.layout = new RadioButtonLayoutState(\r\n            this, tlx, tly, dimen, dimen, 1, color, opacity, 0\r\n        );\r\n        this.width = dimen;\r\n        this.height = dimen;\r\n\r\n        addTo.set(this, this.layout);\r\n    }\r\n\r\n    getLayout(): RadioButtonLayoutState {\r\n        return this.layout;\r\n    }\r\n\r\n    /**\r\n     * Draws the content on the canvas.\r\n     * \r\n     * @param before The starting layout state.\r\n     * @param after The ending layout state.\r\n     * @param progress The progress through the animation from 0-1.\r\n     * @param ctx The graphics context to draw on.\r\n     */\r\n    draw(before: RadioButtonLayoutState, after: RadioButtonLayoutState, progress: number, ctx: CanvasRenderingContext2D) {\r\n        this.setupCtx(before, after, progress, ctx);\r\n\r\n        // Draw the outer circle\r\n        ctx.beginPath();\r\n        const rad = (this.width - this.padding.width()) / 2;\r\n        ctx.arc(0, 0, rad, 0, 2 * Math.PI);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n\r\n        // Draw the filled inner circle\r\n        ctx.beginPath();\r\n        const percentFill = before.percentFill * (1 - progress) + after.percentFill * progress;\r\n        const innerRad = rad * percentFill;\r\n        ctx.arc(0, 0, innerRad, 0, 2 * Math.PI);\r\n        ctx.fill();\r\n    }\r\n\r\n    protected calcWidth(): number { return this.width }\r\n    protected calcHeight(): number { return this.height }\r\n\r\n    /**\r\n     * Add the Layout State for this component, and any other\r\n     * related components such as children of a container.\r\n     * \r\n     * @param parentLayout The frame of the container containing this component.\r\n     * @param layouts The map of layouts to add to.\r\n     * @param tlx The left x of this component.\r\n     * @param tly The top y of this component.\r\n     * @param currScale The current canvas scaling factor.\r\n     * @param opacityObj The object storing opacity info for this step.\r\n     * @param colorsObj The object storing color info for this step.\r\n     */\r\n    addLayout(  parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>, \r\n                tlx: number, tly: number, currScale: number,\r\n                opacityObj: Object, colorsObj: Object): RadioButtonLayoutState {\r\n        return undefined;\r\n    }\r\n\r\n}","import EqContainer from \"./EqContainer\";\r\nimport RootContainerLayoutState from '../animation/RootContainerLayoutState';\r\nimport Padding from \"./Padding\";\r\nimport HBox from \"./HBox\";\r\nimport Radical from './Radical';\r\nimport LayoutState from '../animation/LayoutState';\r\nimport EqComponent from './EqComponent';\r\nimport { MouseEventCallback } from '../main/CanvasController';\r\nimport EqContent from './EqContent';\r\nimport { Map, getWidthTier, parseContainerChildren } from '../main/helpers';\r\nimport { defaultRootPadding, termPadding, rootIndexScale, rootArgMarginLeft, rootKinkTipAngle, rootKinkTipLength } from '../main/consts';\r\nimport { RootContainerFormat } from \"../main/FileFormat\";\r\nimport { Container } from \"../main/ComponentModel\";\r\n\r\n/**\r\n * Works together with the 'Radical' content to\r\n * display roots. The radical is the line of the root.\r\n * The index is the container displayed on the top left\r\n * of the radical. Ie, for a cube root, it would contain\r\n * '3'. The argument is what is being rooted, residing\r\n * under the radical.\r\n */\r\n@Container({\r\n    typeString: 'root',\r\n    parse: (containerObj, depth, contentGetter, containerGetter, genInfo) => {\r\n        // Return container from file\r\n        const format = containerObj as RootContainerFormat;\r\n        const idx = new HBox(\r\n            parseContainerChildren(format.idx, depth + 1, containerGetter, contentGetter),\r\n            Padding.even(0)\r\n        );\r\n        const arg = new HBox(\r\n            parseContainerChildren(format.arg, depth + 1, containerGetter, contentGetter),\r\n            Padding.even(0)\r\n        );\r\n        let radical: Radical;\r\n        if (format.rad) {\r\n            radical = contentGetter(format.rad) as Radical;\r\n        }\r\n        return new RootContainer(idx, arg, radical, defaultRootPadding, genInfo['termHeights']);\r\n    }\r\n})\r\nexport default class RootContainer extends EqContainer<RootContainerLayoutState> {\r\n\r\n    protected index: HBox;\r\n    protected argument: HBox;\r\n    protected radical: Radical;\r\n\r\n    private termHeights: number[];\r\n\r\n    // Metrics:\r\n    // The height of an index term at the current width tier.\r\n    // Used to determine the height of the radical kink\r\n    // so that a normal term fits nicely above it.\r\n    private indexHeight: number;\r\n    // The height of the kink in the radical. Fills the rest\r\n    // of the height of the argument not taken up by idxHeight.\r\n    private kinkHeight: number;\r\n    // The distance that the index rises above the top of the root.\r\n    // This happens when something taller than a regular term is put\r\n    // in the index. If this isn't the case, this will be set to 0. \r\n    private indexTopOverflow: number;\r\n    // If argument is taller than a normal term, this will be >= 0.\r\n    private emptySpaceAboveIndex: number;\r\n    // The width of the kink. Depends on the angle the tick makes to\r\n    // the horizontal, which the start of the kink matches. Also depends\r\n    // on the kink height, kink tip length, and kink tip angle.\r\n    private kinkWidth: number;\r\n    // The distance that the index portrudes over the left of the kink.\r\n    // If it doesn't is <= 0 and can be ignored.\r\n    private indexLeftOverflow: number;\r\n    // The vertical distance between the top of this container and the\r\n    // very left point of the kink.\r\n    private yToKinkStart: number;\r\n    // The width of the kink tip.\r\n    private kinkTipWidth: number;\r\n    // The height of the kink tip.\r\n    private kinkTipHeight: number;\r\n    // An amount left blank (not taken up by the radical)\r\n    // at the bottom of the container. Distinct from normal\r\n    // padding, applies only to the radicals physical appearance.\r\n    private padBottom: number;\r\n\r\n    constructor(index: HBox, argument: HBox, radical: Radical, padding: Padding, termHeights: number[]) {\r\n        super(padding);\r\n        this.index = index;\r\n        this.argument = argument;\r\n        this.radical = radical;\r\n        if (this.termHeights === undefined || this.termHeights.length === 0) {\r\n            // Edge case: sometimes a RootContainer is constructed before any terms exist\r\n            this.termHeights = [20, 20, 20];\r\n        } else {\r\n            this.termHeights = termHeights;\r\n        }\r\n        this.calcMetrics();\r\n        this.width = this.calcWidth();\r\n        this.height = this.calcHeight();\r\n    }\r\n\r\n    /**\r\n     * Calculate the layout parameters for the display\r\n     * of the container.\r\n     */\r\n    private calcMetrics() {\r\n        this.padBottom = termPadding.bottom / 2;\r\n        const termHeight = this.termHeights[getWidthTier()] + termPadding.height();\r\n        this.indexHeight = termHeight * rootIndexScale;\r\n        this.kinkHeight = (termHeight - this.padBottom) - this.indexHeight;\r\n        this.indexTopOverflow = this.index.getHeight() * rootIndexScale - this.indexHeight;\r\n        this.indexTopOverflow = Math.max(this.indexTopOverflow, 0);\r\n        this.emptySpaceAboveIndex = this.argument.getHeight() - this.kinkHeight - this.indexHeight;\r\n        this.emptySpaceAboveIndex = Math.max(this.emptySpaceAboveIndex, 0);\r\n        /*\r\n              /\\        /-----------\r\n             /  \\      /\r\n            /y|z \\    /   arg\r\n                  \\  /\r\n        __________x\\/w______________\r\n        Calculate x such that x = w if\r\n        the height of the argument is one\r\n        terms height.\r\n        */\r\n        // tan x = termHeight / argMargin\r\n        // x = atan(termHeight / argMargin)\r\n        const x = Math.atan(termHeight / rootArgMarginLeft);\r\n        // tan x = h / w\r\n        // w = h / tan x\r\n        const mainKinkWidth = this.kinkHeight / Math.tan(x);\r\n        const z = Math.PI - x - Math.PI / 2;\r\n        // y + z = rootKinkTipAngle\r\n        // y = rootKinkTipAngle - z\r\n        const y = rootKinkTipAngle - z;\r\n        // sin y = w / tipLen\r\n        // w = tipLen * sin y\r\n        this.kinkTipWidth = rootKinkTipLength * Math.sin(y);\r\n        this.kinkWidth = mainKinkWidth + this.kinkTipWidth;\r\n        // cos y = h / tipLen\r\n        // h = tipLen * cos y\r\n        this.kinkTipHeight = rootKinkTipLength * Math.cos(y);\r\n        this.yToKinkStart = this.indexTopOverflow + this.emptySpaceAboveIndex + this.indexHeight + this.kinkTipHeight - this.padBottom;\r\n\r\n        // tan x = kinkHeight / xFromRightOfKink\r\n        // xFromRightOfKink = kinkHeight / tan x\r\n        const xFromRightOfKinkForIdx = this.kinkHeight / Math.tan(x);\r\n        const widthForIdx = this.kinkWidth + xFromRightOfKinkForIdx;\r\n        const realIdxWidth = this.index.getWidth() * rootIndexScale;\r\n        this.indexLeftOverflow = realIdxWidth - widthForIdx;\r\n    }\r\n\r\n    recalcDimensions() {\r\n        this.radical.recalcDimensions();\r\n        this.argument.recalcDimensions();\r\n        this.index.recalcDimensions();\r\n        this.calcMetrics();\r\n        super.recalcDimensions();\r\n    }\r\n\r\n    getMainTextLine(): [number, number] {\r\n        const argLine = this.argument.getMainTextLine();\r\n        const toAdd = this.indexTopOverflow + this.padding.top;\r\n        argLine[0] += toAdd;\r\n        argLine[1] += toAdd;\r\n        return argLine;\r\n    }\r\n\r\n    protected calcWidth(): number {\r\n        const realIdxLeftPortrusion = Math.max(this.indexLeftOverflow, 0);\r\n        return realIdxLeftPortrusion + this.kinkWidth + rootArgMarginLeft + this.argument.getWidth() + this.padding.width();\r\n    }\r\n\r\n    protected calcHeight(): number {\r\n        return this.indexTopOverflow + this.argument.getHeight() + this.padding.height();\r\n    }\r\n\r\n    /**\r\n     * Add the Layout State for this component, and any other\r\n     * related components such as children of a container.\r\n     * \r\n     * @param parentLayout The frame of the container containing this component.\r\n     * @param layouts The map of layouts to add to.\r\n     * @param tlx The left x of this component.\r\n     * @param tly The top y of this component.\r\n     * @param currScale The current canvas scaling factor.\r\n     * @param opacityObj The object storing opacity info for this step.\r\n     * @param colorsObj The object storing color info for this step.\r\n     */\r\n    addLayout(parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>,\r\n        tlx: number, tly: number, currScale: number,\r\n        opacityObj: Object, colorsObj: Object,\r\n        mouseEnter: Map<LayoutState, MouseEventCallback>,\r\n        mouseExit: Map<LayoutState, MouseEventCallback>,\r\n        mouseClick: Map<LayoutState, MouseEventCallback>,\r\n        tempContent: EqContent<any>[]): RootContainerLayoutState {\r\n        const adjustedPad = this.padding.scale(currScale);\r\n\r\n        // Points for the radical: Relative to this container\r\n        const realLeftOverflow = Math.max(this.indexLeftOverflow, 0);\r\n\r\n        const kinkTipX = realLeftOverflow;\r\n        const kinkTipY = this.yToKinkStart;\r\n\r\n        const kinkTopX = kinkTipX + this.kinkTipWidth;\r\n        const kinkTopY = kinkTipY - this.kinkTipHeight;\r\n\r\n        const tickBotX = realLeftOverflow + this.kinkWidth;\r\n        const tickBotY = kinkTopY + this.kinkHeight;\r\n\r\n        const tickTopX = tickBotX + rootArgMarginLeft;\r\n        const tickTopY = tickBotY - this.argument.getHeight() + 1 + this.padBottom;\r\n\r\n        const endX = tickTopX + this.argument.getWidth();\r\n        const endY = tickTopY;\r\n\r\n        const thisWidth = this.getWidth() * currScale;\r\n        const thisHeight = this.getHeight() * currScale;\r\n\r\n        // The layout for this container\r\n        const thisLayout = new RootContainerLayoutState(\r\n            parentLayout, this, tlx, tly, thisWidth, thisHeight, currScale,\r\n            kinkTipX, kinkTipY,\r\n            kinkTopX, kinkTopY,\r\n            tickBotX, tickBotY,\r\n            tickTopX, tickTopY,\r\n            endX, endY\r\n        );\r\n\r\n        // Calculate layout for the index\r\n        let indexTlx;\r\n        if (this.indexLeftOverflow < 0) {\r\n            // Doesn't overflow, needs to be centered\r\n            indexTlx = tlx - (this.indexLeftOverflow / 2) * currScale;\r\n        } else {\r\n            // Overflows or fits exactly\r\n            indexTlx = tlx;\r\n        }\r\n        indexTlx += adjustedPad.left - 1 * currScale;\r\n        const indexTly = tly + (this.emptySpaceAboveIndex - 1 - this.padBottom) * currScale + adjustedPad.top;\r\n\r\n        this.index.addLayout(\r\n            thisLayout, layouts,\r\n            indexTlx, indexTly,\r\n            currScale * rootIndexScale,\r\n            opacityObj, colorsObj,\r\n            mouseEnter, mouseExit, mouseClick,\r\n            tempContent\r\n        );\r\n\r\n        // Calculate layout for the argument\r\n        const argTlx = tlx + (realLeftOverflow + this.kinkWidth + rootArgMarginLeft) * currScale + adjustedPad.left;\r\n        const argTly = tly + this.indexTopOverflow * currScale + adjustedPad.top;\r\n        this.argument.addLayout(\r\n            thisLayout, layouts, argTlx, argTly, currScale, opacityObj, colorsObj,\r\n            mouseEnter, mouseExit, mouseClick, tempContent\r\n        );\r\n\r\n        if (this.radical) {\r\n            this.radical.addLayout(\r\n                thisLayout, layouts, tlx, tly, currScale, opacityObj, colorsObj\r\n            );\r\n        }\r\n\r\n        layouts.set(this, thisLayout);\r\n        return thisLayout;\r\n    }\r\n}","import EqContainer from \"./EqContainer\";\r\nimport HBox from \"./HBox\";\r\nimport Padding from \"./Padding\";\r\nimport { defaultExpPortrusion, defaultSubSuperPadding, expScale } from '../main/consts';\r\nimport LayoutState from '../animation/LayoutState';\r\nimport EqComponent from './EqComponent';\r\nimport EqContent from './EqContent';\r\nimport { MouseEventCallback } from '../main/CanvasController';\r\nimport { Map, parseContainerChildren } from \"../main/helpers\";\r\nimport { SubSuperContainerFormat } from \"../main/FileFormat\";\r\nimport { Container } from \"../main/ComponentModel\";\r\nimport TightHBox from \"./TightHBox\";\r\n\r\n/**\r\n * Lays out components in a way that\r\n * enables exponents (top) and subscripts\r\n * (bottom).\r\n */\r\n@Container({\r\n    typeString: 'subSuper',\r\n    parse: (containerObj, depth, contentGetter, containerGetter) => {\r\n        // Return subSuper from file\r\n        let format = containerObj as SubSuperContainerFormat;\r\n        let top = new HBox(\r\n            parseContainerChildren(format.top, depth + 1, containerGetter, contentGetter),\r\n            Padding.even(0)\r\n        );\r\n        let middle = new TightHBox(\r\n            parseContainerChildren(format.middle, depth + 1, containerGetter, contentGetter),\r\n            Padding.even(0)\r\n        );\r\n        let bottom = new HBox(\r\n            parseContainerChildren(format.bottom, depth + 1, containerGetter, contentGetter),\r\n            Padding.even(0)\r\n        );\r\n        const portrusion = format.portrusion ? format.portrusion : defaultExpPortrusion;\r\n        return new SubSuper(top, middle, bottom, portrusion, defaultSubSuperPadding);\r\n    }\r\n})\r\nexport default class SubSuper extends EqContainer<LayoutState> {\r\n\r\n    protected top: HBox;\r\n    protected middle: HBox;\r\n    protected bottom: HBox;\r\n\r\n    //The proportion that the top and bottom portrude from the middle\r\n    protected portrusionProportion: number;\r\n    //The vertical amount the top portrudes from the middle\r\n    private topPortrusion: number;\r\n    //The vertical amount the bottom portrudes from the middle\r\n    private bottomPortrusion: number;\r\n\r\n    constructor(top: HBox, middle: HBox, bottom: HBox, portrusion: number, padding: Padding) {\r\n        super(padding);\r\n        this.portrusionProportion = portrusion;\r\n        this.top = top;\r\n        this.middle = middle;\r\n        this.bottom = bottom;\r\n        this.recalcPortrusion();\r\n        this.height = this.calcHeight();\r\n        this.width = this.calcWidth();\r\n    }\r\n\r\n    protected recalcPortrusion() {\r\n        this.topPortrusion = this.top.getHeight() * expScale * this.portrusionProportion;\r\n        this.bottomPortrusion = this.bottom.getHeight() * expScale * this.portrusionProportion;\r\n    }\r\n\r\n    recalcDimensions() {\r\n        this.top.recalcDimensions();\r\n        this.middle.recalcDimensions();\r\n        this.bottom.recalcDimensions();\r\n        this.recalcPortrusion();\r\n        super.recalcDimensions();\r\n    }\r\n\r\n    getMainTextLine(): [number, number] {\r\n        const middleLine = this.middle.getMainTextLine();\r\n        if (!middleLine) {\r\n            return undefined;\r\n        }\r\n        // Add the y position of the middle inside this container\r\n        const toAdd = this.topPortrusion + this.padding.top;\r\n        middleLine[0] += toAdd;\r\n        middleLine[1] += toAdd;\r\n        return middleLine;\r\n    }\r\n\r\n    protected calcWidth(): number {\r\n        //Width of the right portion, ie the top and bottom\r\n        let rightWidth = Math.max(this.top.getWidth() * expScale, this.bottom.getWidth() * expScale);\r\n        return this.middle.getWidth() + rightWidth + this.padding.width();\r\n    }\r\n\r\n    protected calcHeight(): number {\r\n        return this.middle.getHeight()\r\n            + this.topPortrusion\r\n            + this.bottomPortrusion\r\n            + this.padding.height();\r\n    }\r\n\r\n    addLayout(parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>,\r\n        tlx: number, tly: number, currScale: number,\r\n        opacityObj: Object, colorsObj: Object,\r\n        mouseEnter: Map<LayoutState, MouseEventCallback>,\r\n        mouseExit: Map<LayoutState, MouseEventCallback>,\r\n        mouseClick: Map<LayoutState, MouseEventCallback>,\r\n        tempContent: EqContent<any>[]): LayoutState {\r\n\r\n        let layout = new LayoutState(parentLayout, this, tlx, tly,\r\n            this.getWidth() * currScale,\r\n            this.getHeight() * currScale,\r\n            currScale);\r\n        //Add the middle\r\n        let middleLayout = this.middle.addLayout(\r\n            layout, layouts,\r\n            tlx + this.padding.left * currScale,\r\n            tly + (this.topPortrusion + this.padding.top) * currScale,\r\n            currScale,\r\n            opacityObj, colorsObj,\r\n            mouseEnter, mouseExit, mouseClick,\r\n            tempContent\r\n        );\r\n        let rightX = middleLayout.tlx + middleLayout.width;\r\n\r\n        //Add the top\r\n        this.top.addLayout(\r\n            layout, layouts,\r\n            rightX,\r\n            tly + this.padding.top * currScale,\r\n            currScale * expScale,\r\n            opacityObj, colorsObj,\r\n            mouseEnter, mouseExit, mouseClick,\r\n            tempContent\r\n        );\r\n\r\n        //Add the bottom\r\n        this.bottom.addLayout(\r\n            layout, layouts,\r\n            rightX,\r\n            tly + layout.height - (this.padding.bottom + this.bottom.getHeight() * expScale) * currScale,\r\n            currScale * expScale,\r\n            opacityObj, colorsObj,\r\n            mouseEnter, mouseExit, mouseClick,\r\n            tempContent\r\n        );\r\n\r\n        //Add own\r\n        layouts.set(this, layout);\r\n        return layout;\r\n    }\r\n}","import EqContainer from \"./EqContainer\";\r\nimport LayoutState from \"../animation/LayoutState\";\r\nimport EqComponent from \"./EqComponent\";\r\nimport { MouseEventCallback } from \"../main/CanvasController\";\r\nimport EqContent from \"./EqContent\";\r\nimport Padding from \"./Padding\";\r\nimport { Map, parseContainerChildren } from '../main/helpers';\r\nimport { defaultTablePadding, tableCellPadding, tableMinCellDimen } from '../main/consts';\r\nimport { Container } from \"../main/ComponentModel\";\r\nimport { TableFormat, ContainerFormat } from \"../main/FileFormat\";\r\n\r\n/**\r\n * Functions for loading from the file.\r\n */\r\n\r\n/**\r\n * Parse an object containing references with indices\r\n * as keys.\r\n * @param obj The object to parse. \r\n*/\r\nexport function parseChildrenObj(\r\n        obj: { [index: number]: string }, \r\n        contentGetter: (ref: string) => EqContent<any>\r\n): { [index: number]: EqComponent<any> } {\r\n\r\n    let toReturn = {};\r\n    if (!obj) {\r\n        return toReturn;\r\n    }\r\n    Object.keys(obj).forEach(index => {\r\n        let ref = obj[index];\r\n        toReturn[index] = contentGetter(ref);\r\n    });\r\n    return toReturn;\r\n}\r\n\r\n/**\r\n * Parse a 2D array of components.\r\n * @param fromFile The array from the file.\r\n */\r\nexport function parseChildren2D(\r\n        fromFile: (string | ContainerFormat)[][],\r\n        containerGetter: (obj: ContainerFormat, depth: number) => EqContainer<any>,\r\n        contentGetter: (ref: string) => EqContent<any>\r\n): EqComponent<any>[][] {\r\n\r\n    const toReturn: EqComponent<any>[][] = [];\r\n    fromFile.forEach(row => {\r\n        toReturn.push(parseContainerChildren(row, 1, containerGetter, contentGetter));\r\n    });\r\n    return toReturn;\r\n}\r\n\r\n/**\r\n * Lays out components in a table.\r\n */\r\n@Container({\r\n    typeString: 'table',\r\n    parse: (containerObj, depth, contentGetter, containerGetter) => {\r\n        const format = containerObj as TableFormat;\r\n        const children = parseChildren2D(format.children, containerGetter, contentGetter);\r\n        return new TableContainer(\r\n            defaultTablePadding,\r\n            children,\r\n            parseChildrenObj(format.hLines, contentGetter),\r\n            parseChildrenObj(format.vLines, contentGetter),\r\n            1,\r\n            tableCellPadding\r\n        );\r\n    }\r\n})\r\nexport default class TableContainer extends EqContainer<LayoutState> {\r\n\r\n    protected children: EqComponent<any>[][];\r\n\r\n    // The width of each column\r\n    protected widths: number[] = [];\r\n\r\n    // The height of each row\r\n    protected heights: number[] = [];\r\n\r\n    protected hLines: { [index: number]: EqComponent<any> };\r\n    protected vLines: { [index: number]: EqComponent<any> };\r\n\r\n    protected lineStroke: number;\r\n\r\n    // Padding inside each cell\r\n    protected cellPad: Padding;\r\n\r\n    constructor(padding: Padding,\r\n        children: EqComponent<any>[][],\r\n        hLines: { [index: number]: EqComponent<any> },\r\n        vLines: { [index: number]: EqComponent<any> },\r\n        lineStroke: number,\r\n        cellPad: Padding) {\r\n        super(padding);\r\n        this.cellPad = cellPad;\r\n        this.lineStroke = lineStroke;\r\n        this.children = children;\r\n        this.width = this.calcWidth();\r\n        this.height = this.calcHeight();\r\n        this.hLines = hLines;\r\n        this.vLines = vLines;\r\n    }\r\n\r\n    /**\r\n     * Return the amount of space to leave for lines\r\n     * (both horizontal and vertical).\r\n     */\r\n    protected getLineStroke(): number {\r\n        return this.lineStroke;\r\n    }\r\n\r\n    /**\r\n     * Return the mimimum dimension in either axis\r\n     * for a table cell.\r\n     */\r\n    protected getMinCellDimen(): number {\r\n        return tableMinCellDimen;\r\n    }\r\n\r\n    recalcDimensions() {\r\n        this.children.forEach(row => {\r\n            row.forEach(child => {\r\n                if (child) {\r\n                    child.recalcDimensions();\r\n                }\r\n            });\r\n        });\r\n        super.recalcDimensions();\r\n    }\r\n\r\n    protected calcWidth(): number {\r\n        let totalWidth = 0;\r\n        // Width of each column is the max width of any component in that row\r\n        for (let c = 0; c < this.children[0].length; c++) {\r\n            let maxWidth = this.getMinCellDimen();\r\n            for (let r = 0; r < this.children.length; r++) {\r\n                let currChild = this.children[r][c];\r\n                let currWidth = this.cellPad.width();\r\n                if (currChild) {\r\n                    currWidth += currChild.getWidth();\r\n                }\r\n                if (currWidth > maxWidth) {\r\n                    maxWidth = currWidth;\r\n                }\r\n            }\r\n            totalWidth += maxWidth;\r\n            // Store col width for later\r\n            this.widths[c] = maxWidth;\r\n        }\r\n        // Also need to take width of lines into account,\r\n        // and padding.\r\n        return totalWidth + this.padding.width() + (this.children[0].length + 1) * this.getLineStroke();\r\n    }\r\n\r\n    protected calcHeight(): number {\r\n        let totalHeight = 0;\r\n        // Height of each row is the max height of any component in that row\r\n        for (let r = 0; r < this.children.length; r++) {\r\n            let maxHeight = this.getMinCellDimen();\r\n            for (let c = 0; c < this.children[r].length; c++) {\r\n                let currChild = this.children[r][c];\r\n                let currHeight = this.cellPad.height();\r\n                if (currChild) {\r\n                    currHeight += currChild.getHeight();\r\n                }\r\n                if (currHeight > maxHeight) {\r\n                    maxHeight = currHeight;\r\n                }\r\n            }\r\n            totalHeight += maxHeight;\r\n            // Store height of this row for later\r\n            this.heights[r] = maxHeight;\r\n        }\r\n        // Also need to take height of lines into account,\r\n        // and padding.\r\n        return totalHeight + this.padding.height() + (this.children.length + 1) * this.getLineStroke();\r\n    }\r\n\r\n    /**\r\n     * Add the Layout State for this component, and any other\r\n     * related components such as children of a container.\r\n     * \r\n     * @param parentLayout The frame of the container containing this component.\r\n     * @param layouts The map of layouts to add to.\r\n     * @param tlx The left x of this component.\r\n     * @param tly The top y of this component.\r\n     * @param currScale The current canvas scaling factor.\r\n     * @param opacityObj The object storing opacity info for this step.\r\n     * @param colorsObj The object storing color info for this step.\r\n     * @param mouseEnter Mouse enter events for this step.\r\n     * @param mouseExit Mouse exit events for this step.\r\n     * @param mouseClick Mouse click events for this step.\r\n     * @param tempContent Temporary content added only for this step.\r\n     */\r\n    addLayout(parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>,\r\n        tlx: number, tly: number, currScale: number,\r\n        opacityObj: Object, colorsObj: Object,\r\n        mouseEnter: Map<LayoutState, MouseEventCallback>,\r\n        mouseExit: Map<LayoutState, MouseEventCallback>,\r\n        mouseClick: Map<LayoutState, MouseEventCallback>,\r\n        tempContent: EqContent<any>[]): LayoutState {\r\n\r\n        const thisState = new LayoutState(\r\n            parentLayout, this, tlx, tly,\r\n            this.width, this.height, currScale\r\n        )\r\n\r\n        // Add child layouts row by row\r\n        let upToY = tly + this.padding.top + this.getLineStroke();\r\n        for (let r = 0; r < this.children.length; r++) {\r\n            // Do the row\r\n            let upToX = tlx + this.padding.left + this.getLineStroke();\r\n            let rowHeight = this.heights[r];\r\n\r\n            // Add hline before row if there is one\r\n            if (this.hLines[r]) {\r\n                this.hLines[r].addLayout(\r\n                    thisState, layouts, undefined, upToY - this.getLineStroke(), currScale,\r\n                    opacityObj, colorsObj, mouseEnter, mouseExit, mouseClick, tempContent\r\n                );\r\n            }\r\n\r\n            for (let c = 0; c < this.children[r].length; c++) {\r\n                // Do each column\r\n                let colWidth = this.widths[c];\r\n\r\n                // Add vline before column if there is one\r\n                if (this.vLines[c]) {\r\n                    this.vLines[c].addLayout(\r\n                        thisState, layouts, upToX - this.getLineStroke(), undefined, currScale,\r\n                        opacityObj, colorsObj, mouseEnter, mouseExit, mouseClick, tempContent\r\n                    );\r\n                }\r\n\r\n                let currChild = this.children[r][c];\r\n                if (currChild) {\r\n                    // Add child layout, centering in both directions\r\n                    let childWidth = currChild.getWidth();\r\n                    let childHeight = currChild.getHeight();\r\n                    let childX = upToX + (colWidth - childWidth) / 2;\r\n                    let childY = upToY + (rowHeight - childHeight) / 2;\r\n                    currChild.addLayout(\r\n                        thisState, layouts, childX, childY, currScale,\r\n                        opacityObj, colorsObj, mouseEnter, mouseExit, mouseClick,\r\n                        tempContent\r\n                    );\r\n                }\r\n                upToX += colWidth + this.getLineStroke();\r\n\r\n                // Add vline after last column if there is one\r\n                if (c === this.children[r].length - 1 && this.vLines[c + 1]) {\r\n                    this.vLines[c + 1].addLayout(\r\n                        thisState, layouts, upToX - this.getLineStroke(), undefined, currScale,\r\n                        opacityObj, colorsObj, mouseEnter, mouseExit, mouseClick, tempContent\r\n                    );\r\n                }\r\n            }\r\n            upToY += rowHeight + this.getLineStroke();\r\n\r\n            // Add hline after the last row if there is one\r\n            if (r === this.children.length - 1 && this.hLines[r + 1]) {\r\n                this.hLines[r + 1].addLayout(\r\n                    thisState, layouts, tlx + this.padding.left, upToY - this.getLineStroke(),\r\n                    currScale, opacityObj, colorsObj,\r\n                    mouseEnter, mouseExit, mouseClick, tempContent\r\n                )\r\n            }\r\n        }\r\n\r\n        layouts.set(this, thisState);\r\n        return thisState;\r\n\r\n    }\r\n\r\n}","import LayoutState from '../animation/LayoutState';\r\nimport { widthTiers, termPadding } from '../main/consts';\r\nimport EqContent from './EqContent';\r\nimport TermLayoutState from '../animation/TermLayoutState';\r\nimport { Map } from '../main/helpers';\r\nimport EqComponent from './EqComponent';\r\nimport { Content } from '../main/ComponentModel';\r\n\r\n@Content({\r\n    character: 't',\r\n    initialize: (file, info) => {\r\n        const terms: Term[] = [];\r\n        let ascents = [];\r\n\r\n        if (file.terms.length > 0) {\r\n            //Get the ascents from each tier\r\n            for (let w = 0; w < widthTiers.length; w++) {\r\n                ascents.push(file.metrics[w].ascent);\r\n            }\r\n        }\r\n\r\n        //Initialize all terms\r\n        for (let t = 0; t < file.terms.length; t++) {\r\n            let widths = [];\r\n\r\n            //Get the widths for each tier\r\n            for (let w = 0; w < widthTiers.length; w++) {\r\n                widths.push(file.metrics[w].widths[t]);\r\n            }\r\n\r\n            let text = file.terms[t];\r\n            let term = new Term(text, widths, info['termHeights'], ascents, 't' + t);\r\n            terms.push(term);\r\n        }\r\n        return terms;\r\n    },\r\n    calcInfo: (file, info) => {\r\n        const termHeights: number[] = [];\r\n        if (file.terms.length > 0) {\r\n            //Get the term heights from each tier\r\n            for (let w = 0; w < widthTiers.length; w++) {\r\n                termHeights.push(file.metrics[w].height);\r\n            }\r\n        }\r\n        info['termHeights'] = termHeights;\r\n    }\r\n})\r\nexport default class Term extends EqContent<TermLayoutState> {\r\n\r\n    private text: string;\r\n    private widths: number[];\r\n    private heights: number[];\r\n    private halfInnerWidths: number[];\r\n    private halfInnerHeights: number[];\r\n    private ascents: number[];\r\n\r\n    private halfInnerWidth: number;\r\n    private halfInnerHeight: number;\r\n    private ascent: number;\r\n\r\n    constructor(text: string, widths: number[], heights: number[], ascents: number[], ref: string) {\r\n        super(termPadding, ref);\r\n        this.widths = widths;\r\n        this.heights = heights;\r\n        this.halfInnerWidths = this.widths.map(width => width / 2);\r\n        this.halfInnerHeights = this.heights.map(height => height / 2);\r\n        this.ascents = ascents; \r\n        this.recalcDimensions();\r\n        this.text = text;\r\n    }\r\n\r\n    recalcDimensions() {\r\n        super.recalcDimensions();\r\n        let tier: number = window['currentWidthTier'];\r\n        this.halfInnerWidth = this.halfInnerWidths[tier];\r\n        this.halfInnerHeight = this.halfInnerHeights[tier];\r\n        this.ascent = this.ascents[tier];\r\n    }\r\n\r\n    getMainTextLine(): [number, number] {\r\n        return [this.padding.top, this.height - this.padding.bottom];\r\n    }\r\n    \r\n    protected calcHeight(): number {\r\n        let tier: number = window['currentWidthTier'];\r\n        return this.heights[tier] + this.padding.height();\r\n    }\r\n    \r\n    protected calcWidth(): number {\r\n        let tier: number = window['currentWidthTier'];\r\n        return this.widths[tier] + this.padding.width();\r\n    }\r\n    \r\n    addLayout(parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>, \r\n              tlx: number, tly: number, currScale: number,\r\n              opacityObj: Object, colorsObj: Object): TermLayoutState {\r\n        let state = new TermLayoutState(\r\n                parentLayout, this, \r\n                tlx, tly, this.width * currScale, this.height * currScale, currScale,\r\n                this.getColorForContent(colorsObj), this.getOpacityForContent(opacityObj)\r\n        );\r\n        layouts.set(this, state);\r\n        return state;\r\n    }\r\n    \r\n    draw(before: TermLayoutState, after: TermLayoutState, progress: number, ctx: CanvasRenderingContext2D) {\r\n        this.setupCtx(before, after, progress, ctx);\r\n        ctx.fillText(this.text, -this.halfInnerWidth, -this.halfInnerHeight + this.ascent);\r\n    }\r\n}","import HBox from \"./HBox\";\r\nimport { termPadding, tightTermPadding, defaultHBoxPadding } from '../main/consts';\r\nimport Term from \"./Term\";\r\nimport LayoutState from '../animation/LayoutState';\r\nimport TermLayoutState from \"../animation/TermLayoutState\";\r\nimport EqComponent from \"./EqComponent\";\r\nimport { Map, parseContainerChildren } from '../main/helpers';\r\nimport { MouseEventCallback } from \"../main/CanvasController\";\r\nimport EqContent from \"./EqContent\";\r\nimport { Container } from \"../main/ComponentModel\";\r\nimport { LinearContainerFormat } from \"../main/FileFormat\";\r\nimport Padding from \"./Padding\";\r\n\r\nconst widthDiff = termPadding.width() - tightTermPadding.width();\r\n\r\n@Container({\r\n    typeString: 'tightHBox',\r\n    parse: (containerObj, depth, contentGetter, containerGetter) => {\r\n        // Return HBox from file\r\n        const format = containerObj as LinearContainerFormat;\r\n        const children = parseContainerChildren(format.children, depth + 1, containerGetter, contentGetter);\r\n        return new TightHBox(children, Padding.even(defaultHBoxPadding));\r\n    }\r\n})\r\nexport default class TightHBox extends HBox {\r\n\r\n    //Override to account for reduced width of tight terms.\r\n    protected calcWidth(): number {\r\n        let totalWidth = 0;\r\n        let numTerms = 0;\r\n        for (let i = 0; i < this.children.length; i++) {\r\n            let currChild = this.children[i];\r\n            totalWidth += currChild.getWidth();\r\n            if (currChild instanceof Term) {\r\n                numTerms++;\r\n            }\r\n        }\r\n        return totalWidth + this.padding.width() - numTerms * widthDiff;\r\n    }\r\n\r\n    //Override to reduce term padding.\r\n    addLayout(  parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>, \r\n                tlx: number, tly: number, currScale: number,\r\n                opacityObj: Object, colorObj: Object,\r\n                mouseEnter: Map<LayoutState, MouseEventCallback>,\r\n                mouseExit: Map<LayoutState, MouseEventCallback>, \r\n                mouseClick: Map<LayoutState, MouseEventCallback>,\r\n                tempContent: EqContent<any>[]): LayoutState {\r\n\r\n        let state = new LayoutState(\r\n            parentLayout, this, \r\n            tlx, tly, \r\n            this.getWidth() * currScale, \r\n            this.getHeight() * currScale, \r\n            currScale\r\n        );\r\n\r\n        let upToX = tlx + this.padding.left * currScale;\r\n\r\n        for (let i = 0; i < this.children.length; i++) {\r\n            let currChild = this.children[i];\r\n            let childHeight = currChild.getHeight() * currScale;\r\n\r\n            //Position child in the middle vertically\r\n            let childTLY = this.middleMainLineDist * currScale - childHeight / 2 + tly;\r\n\r\n            const childLayout = currChild.addLayout(   \r\n                state, layouts, \r\n                upToX, childTLY, \r\n                currScale, opacityObj, colorObj,\r\n                mouseEnter, mouseExit, mouseClick,\r\n                tempContent\r\n            );\r\n\r\n            if (currChild instanceof Term) {\r\n                (childLayout as TermLayoutState).tighten(widthDiff * currScale);\r\n            }\r\n\r\n            upToX += childLayout.width;\r\n        }\r\n\r\n        layouts.set(this, state);\r\n\r\n        return state;\r\n    }\r\n}","import EqComponent from './EqComponent';\r\nimport LayoutState from '../animation/LayoutState';\r\nimport Padding from './Padding';\r\nimport { Map } from '../main/helpers';\r\nimport LinearContainer from './LinearContainer';\r\nimport { MouseEventCallback } from '../main/CanvasController';\r\nimport EqContent from './EqContent';\r\n\r\nexport default class VBox extends LinearContainer<LayoutState> {\r\n\r\n    constructor(children: EqComponent<any>[], padding: Padding) {\r\n        super(children, padding);\r\n        this.width = this.calcWidth();\r\n        this.height = this.calcHeight();\r\n    }\r\n\r\n    protected calcHeight(): number {\r\n        let totalHeight = 0;\r\n        for (let i = 0; i < this.children.length; i++) {\r\n            totalHeight += this.children[i].getHeight();\r\n        }\r\n        return totalHeight + this.padding.height();\r\n    }\r\n\r\n    protected calcWidth(): number {\r\n        let maxWidth = 0;\r\n        for (let i = 0; i < this.children.length; i++) {\r\n            let childWidth = this.children[i].getWidth();\r\n            if (childWidth > maxWidth) {\r\n                maxWidth = childWidth;\r\n            }\r\n        }\r\n        return maxWidth + this.padding.width();\r\n    }\r\n\r\n    addLayout(parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>,\r\n        tlx: number, tly: number, currScale: number,\r\n        opacityObj: Object, colorsObj: Object,\r\n        mouseEnter: Map<LayoutState, MouseEventCallback>,\r\n        mouseExit: Map<LayoutState, MouseEventCallback>,\r\n        mouseClick: Map<LayoutState, MouseEventCallback>,\r\n        tempContent: EqContent<any>[]): LayoutState {\r\n        let state = new LayoutState(parentLayout, this, tlx, tly,\r\n            this.getWidth() * currScale,\r\n            this.getHeight() * currScale,\r\n            currScale);\r\n        const innerWidth = (this.getWidth() - this.padding.width()) * currScale;\r\n        let upToY = tly + this.padding.top * currScale;\r\n\r\n        for (let i = 0; i < this.children.length; i++) {\r\n            let currChild = this.children[i];\r\n            let childWidth = currChild.getWidth() * currScale;\r\n\r\n            //Position child in the middle horizontally\r\n            let childTLX = (innerWidth - childWidth) / 2 + this.padding.left * currScale + tlx;\r\n            upToY += currChild.addLayout(state, layouts,\r\n                childTLX, upToY, currScale,\r\n                opacityObj, colorsObj,\r\n                mouseEnter, mouseExit, mouseClick,\r\n                tempContent).height;\r\n        }\r\n\r\n        layouts.set(this, state);\r\n\r\n        return state;\r\n    }\r\n}","import VBox from \"./VBox\";\r\nimport EqComponent from \"./EqComponent\";\r\nimport Padding from \"./Padding\";\r\nimport LayoutState from '../animation/LayoutState';\r\nimport { Map, parseContainerChildren } from '../main/helpers';\r\nimport { MouseEventCallback } from \"../main/CanvasController\";\r\nimport EqContent from \"./EqContent\";\r\nimport { Container } from \"../main/ComponentModel\";\r\nimport { LinearContainerFormat } from \"../main/FileFormat\";\r\nimport { defaultRootVBoxPadding, defaultVBoxPadding } from '../main/consts';\r\n\r\n/**\r\n * VBox used at the root of the layout hierarchy.\r\n * Vertically centers the children\r\n * as well as horizontally centering.\r\n * Decorator defined here to avoid circular\r\n * dependency between this and VBox.\r\n */\r\n@Container({\r\n    typeString: 'vbox',\r\n    parse: (containerObj, depth, contentGetter, containerGetter, inf) => {\r\n        // Return VBox from file\r\n        const format = containerObj as LinearContainerFormat;\r\n        const children = parseContainerChildren(format.children, depth + 1, containerGetter, contentGetter);\r\n        // Allocate extra padding if at root of layout\r\n        const padding = depth === 0 ? defaultRootVBoxPadding : Padding.even(defaultVBoxPadding);\r\n        // Center vertically if at root of layout\r\n        if (inf['fixedHeights'] && depth === 0) {\r\n           return new VCenterVBox(children, padding);\r\n        } else {\r\n            return new VBox(children, padding);\r\n        }\r\n    }\r\n})\r\nexport default class VCenterVBox extends VBox {\r\n\r\n    private totalChildHeight: number;\r\n\r\n    constructor(children: EqComponent<any>[], padding: Padding) {\r\n        super(children, padding);\r\n        this.calcChildHeight();\r\n    }\r\n\r\n    private calcChildHeight() {\r\n        // Calculate total child height\r\n        this.totalChildHeight = 0;\r\n        this.children.forEach(child => {\r\n            this.totalChildHeight += child.getHeight();\r\n        });\r\n    }\r\n\r\n    recalcDimensions() {\r\n        super.recalcDimensions();\r\n        this.calcChildHeight();\r\n    }\r\n\r\n    addLayout(  parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>,\r\n                tlx: number, tly: number, currScale: number,\r\n                opacityObj: Object, colorsObj: Object,\r\n                mouseEnter: Map<LayoutState, MouseEventCallback>, \r\n                mouseExit: Map<LayoutState, MouseEventCallback>, \r\n                mouseClick: Map<LayoutState, MouseEventCallback>,\r\n                tempContent: EqContent<any>[]): LayoutState {\r\n        let state = new LayoutState(parentLayout, this, tlx, tly,\r\n            this.getWidth() * currScale,\r\n            this.getHeight() * currScale,\r\n            currScale);\r\n        const innerWidth = (this.getWidth() - this.padding.width()) * currScale;\r\n        let upToY = tly + (this.getHeight() - this.totalChildHeight) / 2;\r\n\r\n        for (let i = 0; i < this.children.length; i++) {\r\n            let currChild = this.children[i];\r\n            let childWidth = currChild.getWidth() * currScale;\r\n\r\n            //Position child in the middle horizontally\r\n            let childTLX = (innerWidth - childWidth) / 2 + this.padding.left * currScale + tlx;\r\n            upToY += currChild.addLayout(   state, layouts, \r\n                                            childTLX, upToY, currScale, \r\n                                            opacityObj, colorsObj,\r\n                                            mouseEnter, mouseExit, mouseClick,\r\n                                            tempContent).height;\r\n        }\r\n\r\n        layouts.set(this, state);\r\n\r\n        return state;\r\n    }\r\n}","import EqContent from \"./EqContent\";\r\nimport { line } from '../main/helpers';\r\nimport Padding from \"./Padding\";\r\nimport { Map } from '../main/helpers';\r\nimport EqComponent from \"./EqComponent\";\r\nimport { OriginalDimenLayoutState } from \"../animation/OriginalDimenLayoutState\";\r\nimport LayoutState from \"../animation/LayoutState\";\r\nimport { Content } from \"../main/ComponentModel\";\r\nimport { vDividerPadding } from '../main/consts';\r\n\r\n@Content({\r\n    character: 'v',\r\n    initialize: file => {\r\n        const vDividers: VDivider[] = [];\r\n        for (let i = 0; i < file.vDividers; i++) {\r\n            vDividers.push(new VDivider(vDividerPadding, 'v' + i));\r\n        }\r\n        return vDividers;\r\n    }\r\n})\r\nexport default class VDivider extends EqContent<OriginalDimenLayoutState> {\r\n\r\n    constructor(padding: Padding, ref: string) {\r\n        super(padding, ref);\r\n        this.width = this.calcWidth();\r\n        //For layout purposes, the divider\r\n        //has no height. It stretches to fill\r\n        //its container.\r\n        this.height = this.calcHeight();\r\n    }\r\n\r\n    setPadding(newPadding: Padding) {\r\n        this.padding = newPadding;\r\n    }\r\n\r\n    protected calcWidth(): number {return 1 + this.padding.width()}\r\n    protected calcHeight(): number {return 0;}\r\n\r\n    addLayout(  parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>, \r\n                tlx: number, tly: number, currScale: number,\r\n                opacityObj: Object, colorsObj: Object): OriginalDimenLayoutState {\r\n        //Set y to align top with parent\r\n        let y = parentLayout.tly;\r\n        let height = parentLayout.height;\r\n        let width = this.getWidth();\r\n        let state = new OriginalDimenLayoutState(\r\n            parentLayout, this, \r\n            tlx, y, width, height, currScale,\r\n            this.getColorForContent(colorsObj), this.getOpacityForContent(opacityObj),\r\n            width, height / currScale\r\n        );\r\n        layouts.set(this, state);\r\n        return state;\r\n    }\r\n\r\n    draw(before: OriginalDimenLayoutState, after: OriginalDimenLayoutState, progress: number, ctx: CanvasRenderingContext2D) {\r\n        this.setupCtx(before, after, progress, ctx);\r\n        const height = before.origInnerHeight * (1 - progress) + after.origInnerHeight * progress;\r\n        line(0, -height / 2 + this.padding.top, 0, height / 2 - this.padding.bottom, ctx);\r\n    }\r\n}","import EqComponent from \"../layout/EqComponent\";\r\nimport LayoutState from \"../animation/LayoutState\";\r\nimport EqContainer from \"../layout/EqContainer\";\r\nimport AnimationSet from '../animation/AnimationSet';\r\nimport MoveAnimation from \"../animation/MoveAnimation\";\r\nimport RemoveAnimation from \"../animation/RemoveAnimation\";\r\nimport AddAnimation from \"../animation/AddAnimation\";\r\nimport EvalAnimation from '../animation/EvalAnimation';\r\nimport ReverseEvalAnimation from '../animation/ReverseEvalAnimation';\r\nimport { backgroundColor, buttonHighlightDuration, buttonHighlightEasing, buttonHighlightedOpacity, buttonUnhighlightDuration, buttonUnhighlightEasing, defaultMoveDuration, defaultRemoveDuration, defaultAddDuration, progressEasing, autoplayProgressEasing } from './consts';\r\nimport EqContent from \"../layout/EqContent\";\r\nimport ProgressAnimation from \"../animation/ProgressAnimation\";\r\nimport { getFontSizeForTier, Map, newMap, isIE, getFont, rgbaArrayToCssString } from \"./helpers\";\r\nimport { StepFormat, TransitionOptionsFormat, FileFormat, AutoplayFormat, ColorsFormat } from \"./FileFormat\";\r\nimport ProgressIndicator from \"./ProgressIndicator\";\r\nimport ContentLayoutState from \"../animation/ContentLayoutState\";\r\nimport BezierCallback from \"../animation/BezierCallback\";\r\nimport { ComponentModel } from \"./ComponentModel\";\r\nimport DummyAnimation from \"../animation/DummyAnimation\";\r\nimport AutoplayProgressAnimation from \"../animation/AutoplayProgressAnimation\";\r\n\r\nexport type MouseEventCallback = (oldLayout: ContentLayoutState, set: AnimationSet, controller: CanvasController) => void;\r\n\r\n/**\r\n * Responsible for managing a single canvas,\r\n * playing through the set of instructions\r\n * and animating.\r\n */\r\nexport default class CanvasController {\r\n\r\n    protected container: Element;\r\n    protected textArea: HTMLDivElement;\r\n    protected canvas: HTMLCanvasElement;\r\n    protected restartOrNextButton: HTMLElement;\r\n    protected overlayContainer: HTMLElement;\r\n    protected ctx: CanvasRenderingContext2D;\r\n    protected progress: ProgressIndicator;\r\n    protected backgroundFill: string;\r\n\r\n    protected currStep = 0;\r\n    protected steps: StepFormat[];\r\n    protected stepOptions: TransitionOptionsFormat[];\r\n    protected isAutoplay: AutoplayFormat;\r\n    protected customColors: ColorsFormat;\r\n\r\n    protected components: ComponentModel;\r\n    // Content added temporarily in the current step\r\n    protected tempContent: EqContent<any>[];\r\n\r\n    protected currStates: Map<EqComponent<any>, LayoutState>;\r\n    protected currRootContainer: EqContainer<any>;\r\n    protected currAnimation: AnimationSet;\r\n\r\n    // Various mouse events. When triggered, the callback\r\n    // may add animations to the set or manipulate the controller.\r\n    // If any click events are present, do not go to the next\r\n    // step as usual.\r\n    protected mouseEnterEvents: Map<LayoutState, MouseEventCallback>;\r\n    protected mouseExitEvents: Map<LayoutState, MouseEventCallback>;\r\n    protected mouseClickEvents: Map<LayoutState, MouseEventCallback>;\r\n    protected mouseOnLast: LayoutState[] = [];\r\n\r\n    protected fontWeight: string;\r\n    protected fontStyle: string;\r\n    protected fontSize: number;\r\n    protected fontFamily: string;\r\n\r\n    protected lastHeight: number = 0;\r\n    protected lastWidth: number = 0;\r\n    protected fixedHeights: number[];\r\n\r\n    /**\r\n     * Create a new Canvas Controller,\r\n     * setting up equation playback in the\r\n     * given container.\r\n     * @param container The container. \r\n     * @param instructions The instructions.\r\n     */\r\n    constructor(container: HTMLElement, instructions: FileFormat, colors?: ColorsFormat) {\r\n        this.container = container;\r\n        this.steps = instructions.steps;\r\n        this.stepOptions = instructions.stepOpts;\r\n        this.setSize = this.setSize.bind(this);\r\n        this.startAutoplay = this.startAutoplay.bind(this);\r\n        this.handleMouseClick = this.handleMouseClick.bind(this);\r\n\r\n        this.isAutoplay = instructions.autoplay;\r\n        this.customColors = colors;\r\n\r\n        // Create canvas\r\n        let canvasContainer = document.createElement('div');\r\n        canvasContainer.className = 'canvas-container';\r\n        this.container.appendChild(canvasContainer);\r\n\r\n        this.canvas = document.createElement(\"canvas\");\r\n        this.ctx = this.canvas.getContext(\"2d\", { alpha: false });\r\n        canvasContainer.appendChild(this.canvas);\r\n\r\n        // Set background color\r\n        this.backgroundFill = rgbaArrayToCssString(colors && colors.canvasBackground ? colors.canvasBackground : backgroundColor);\r\n\r\n        // Check if any steps have text\r\n        const hasText = this.steps.some(step => step.text !== undefined);\r\n\r\n        // Whether navigational buttons are necessary\r\n        const needButtons = this.steps.length > 1 && !this.isAutoplay;\r\n\r\n        // Create area below canvas, if needed\r\n        if (needButtons || hasText) {\r\n            let lowerArea = document.createElement(\"div\");\r\n            lowerArea.className = \"eqUpper\";\r\n            this.container.appendChild(lowerArea);\r\n\r\n            //Create back button, if needed\r\n            if (needButtons) {\r\n                let backButton = document.createElement(\"div\");\r\n                backButton.className = \"material-icons eqIcon\";\r\n                backButton.innerHTML = \"keyboard_arrow_left\";\r\n                backButton.style.left = '0px';\r\n                backButton.setAttribute(\"role\", \"button\");\r\n                lowerArea.appendChild(backButton);\r\n                this.prevStep = this.prevStep.bind(this);\r\n                backButton.addEventListener(\"click\", this.prevStep);\r\n                // Highlight button on mouse over\r\n                backButton.addEventListener(\"mouseenter\", this.highlightButton.bind(this, backButton));\r\n                backButton.addEventListener(\"mouseleave\", this.unhighlightButton.bind(this, backButton));\r\n            }\r\n\r\n            // Create text area, if needed\r\n            // text doesn't show if: none of the steps define any text\r\n            if (hasText) {\r\n                this.textArea = document.createElement(\"div\");\r\n                this.textArea.className = \"eqText\";\r\n                lowerArea.appendChild(this.textArea);\r\n            }\r\n\r\n            //Create restart button and progress indicator\r\n            if (needButtons) {\r\n                this.restartOrNextButton = document.createElement(\"div\");\r\n                this.restartOrNextButton.className = \"material-icons eqIcon\";\r\n                this.restartOrNextButton.innerHTML = \"keyboard_arrow_right\";\r\n                this.restartOrNextButton.style.right = '0px';\r\n                this.restartOrNextButton.setAttribute(\"role\", \"button\");\r\n                lowerArea.appendChild(this.restartOrNextButton);\r\n                this.restart = this.restart.bind(this);\r\n                this.restartOrNextButton.addEventListener(\"click\", this.handleMouseClick);\r\n                // Highlight next/restart in all regions where it will happen\r\n                this.canvas.addEventListener(\"mouseenter\", this.highlightButton.bind(this, this.restartOrNextButton));\r\n                this.restartOrNextButton.addEventListener(\"mouseenter\", this.highlightButton.bind(this, this.restartOrNextButton));\r\n                this.canvas.addEventListener(\"mouseleave\", this.unhighlightButton.bind(this, this.restartOrNextButton));\r\n                this.restartOrNextButton.addEventListener(\"mouseleave\", this.unhighlightButton.bind(this, this.restartOrNextButton));\r\n            }\r\n        }\r\n\r\n        // Initialize progress indicator\r\n        this.progress = new ProgressIndicator(this.canvas, this.backgroundFill);\r\n\r\n        //Check whether to fix the height of the canvas\r\n        if (container.hasAttribute('data-fix-height') || this.isAutoplay) {\r\n            this.fixedHeights = instructions.maxHeights;\r\n        }\r\n\r\n        //Initialize the font\r\n        [\r\n            this.fontFamily,\r\n            this.fontStyle,\r\n            this.fontWeight\r\n        ] = getFont(instructions);\r\n\r\n        //Initialize Components and display first step\r\n        this.initComponents(instructions);\r\n        this.updateFontSize();\r\n        this.recalc(true);\r\n\r\n        // Bind next step to canvas/text click if not autoplaying\r\n        if (!this.isAutoplay) {\r\n            this.canvas.addEventListener(\"click\", this.handleMouseClick);\r\n            if (this.textArea) {\r\n                this.textArea.addEventListener('click', this.handleMouseClick);\r\n            }\r\n        }\r\n\r\n        //Redraw when window size changes\r\n        this.recalc = this.recalc.bind(this);\r\n        window.addEventListener('resize', () => {\r\n            this.updateFontSize();\r\n            this.updateDimensions();\r\n            this.recalc(false);\r\n        });\r\n\r\n        // Add overlay for play if autoplaying\r\n        if (this.isAutoplay) {\r\n            this.overlayContainer = document.createElement(\"div\");\r\n            this.overlayContainer.className = \"overlayContainer\";\r\n            this.overlayContainer.addEventListener(\"click\", this.startAutoplay);\r\n\r\n            const playButton = document.createElement(\"span\");\r\n            playButton.className = \"material-icons playButton\";\r\n            playButton.innerHTML = \"play_arrow\";\r\n\r\n            this.overlayContainer.appendChild(playButton);\r\n            container.appendChild(this.overlayContainer);\r\n        }\r\n\r\n        // Check for mouse events\r\n        this.handleMouseMove = this.handleMouseMove.bind(this);\r\n        this.canvas.addEventListener(\"mousemove\", this.handleMouseMove);\r\n    }\r\n\r\n    /**\r\n     * Initialize the components/content and \r\n     * add general information.\r\n     */\r\n    protected initComponents(instructions: FileFormat) {\r\n        this.components = new ComponentModel(instructions);\r\n        this.components.setGenInfo('customColors', this.customColors);\r\n        this.components.setGenInfo('fixedHeights', this.fixedHeights);\r\n    }\r\n\r\n    /**\r\n     * Emphasize a button.\r\n     * @param button The element of the button.\r\n     */\r\n    protected highlightButton(button: HTMLElement) {\r\n        const set = new AnimationSet(() => { }, this.ctx, 0, 0, this.backgroundFill);\r\n\r\n        const anim = new class extends BezierCallback {\r\n            constructor() {\r\n                super(buttonHighlightDuration, buttonHighlightEasing, set);\r\n            }\r\n            protected step(completion: number): void {\r\n                const opacity = 0.4 * (1 - completion) + buttonHighlightedOpacity * completion;\r\n                button.style.opacity = \"\" + opacity;\r\n            }\r\n        };\r\n\r\n        set.addAnimation(anim);\r\n        set.start();\r\n    }\r\n\r\n    /**\r\n     * De-emphasize a button\r\n     * @param button The element of the button.\r\n     */\r\n    protected unhighlightButton(button: HTMLElement) {\r\n        const set = new AnimationSet(() => { }, this.ctx, 0, 0, this.backgroundFill);\r\n\r\n        const anim = new class extends BezierCallback {\r\n            constructor() {\r\n                super(buttonUnhighlightDuration, buttonUnhighlightEasing, set);\r\n            }\r\n            protected step(completion: number): void {\r\n                const opacity = buttonHighlightedOpacity * (1 - completion) + 0.4 * completion;\r\n                button.style.opacity = \"\" + opacity;\r\n            }\r\n        };\r\n\r\n        set.addAnimation(anim);\r\n        set.start();\r\n    }\r\n\r\n    /**\r\n     * Set what the cursor will be above the canvas.\r\n     * @param cursor The css style property for cursor.\r\n     */\r\n    setCursor(cursor: string) {\r\n        this.canvas.style.cursor = cursor;\r\n    }\r\n\r\n    /**\r\n     * Set what will be displayed as the text.\r\n     * @param innerHTML The inner HTML text.\r\n     */\r\n    setText(innerHTML: string) {\r\n        if (this.textArea) {\r\n            this.textArea.innerHTML = innerHTML;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Decide what to do when the mouse clicks.\r\n     * @param e The mouse event.\r\n     */\r\n    protected handleMouseClick(e: MouseEvent) {\r\n        if (this.mouseClickEvents.size > 0) {\r\n            // May be something to process\r\n            // Get the relative coords\r\n            const canvasRect = this.canvas.getBoundingClientRect();\r\n            const relX = e.clientX - canvasRect.left;\r\n            const relY = e.clientY - canvasRect.top;\r\n\r\n            // Get the layouts that the cursor is currently on\r\n            const currentlyOn = [];\r\n            this.mouseClickEvents.forEach((handler, layout) => {\r\n                if (layout.contains(relX, relY)) {\r\n                    currentlyOn.push(layout);\r\n                }\r\n            });\r\n\r\n            // list of all states which need to be drawn each frame\r\n            const allStates: LayoutState[] = [];\r\n            this.currStates.forEach(state => allStates.push(state));\r\n\r\n            // The animations that will be played.\r\n            const animSet = new AnimationSet(undefined, this.ctx, this.lastWidth, this.lastHeight, this.backgroundFill, allStates);\r\n\r\n            currentlyOn.forEach((layout: LayoutState) => {\r\n                let handler = this.mouseClickEvents.get(layout);\r\n                handler(layout, animSet, this);\r\n            });\r\n\r\n            animSet.start();\r\n        } else if (this.currStep >= this.steps.length - 1) {\r\n            this.restart();\r\n        } else {\r\n            this.nextStep();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fire mouse events if necessary when the mouse moves.\r\n     */\r\n    protected handleMouseMove(e: MouseEvent) {\r\n        if (this.mouseEnterEvents.size > 0 || this.mouseExitEvents.size > 0) {\r\n            // May be something to process\r\n            // Get the relative coords\r\n            const canvasRect = this.canvas.getBoundingClientRect();\r\n            const relX = e.clientX - canvasRect.left;\r\n            const relY = e.clientY - canvasRect.top;\r\n\r\n            // Get the layouts that the cursor is currently on\r\n            const currentlyOn = [];\r\n            this.mouseEnterEvents.forEach((handler, layout) => {\r\n                if (layout.contains(relX, relY)) {\r\n                    currentlyOn.push(layout);\r\n                }\r\n            });\r\n\r\n            this.mouseExitEvents.forEach((handler, layout) => {\r\n                if (layout.contains(relX, relY)) {\r\n                    currentlyOn.push(layout);\r\n                }\r\n            });\r\n\r\n            // list of all states which need to be drawn each frame\r\n            const allStates: LayoutState[] = [];\r\n            this.currStates.forEach(state => allStates.push(state));\r\n\r\n            // The animations that will be played.\r\n            const animSet = new AnimationSet(undefined, this.ctx, this.lastWidth, this.lastHeight, this.backgroundFill, allStates);\r\n\r\n            // For each layout the cursor is on, check if it\r\n            // was on beforehand. If it was not, fire enter\r\n            // event.\r\n            currentlyOn.forEach((layout: LayoutState) => {\r\n                if (this.mouseOnLast.indexOf(layout) === -1) {\r\n                    // Fire the enter event\r\n                    let handler = this.mouseEnterEvents.get(layout);\r\n                    handler(layout, animSet, this);\r\n                }\r\n            });\r\n\r\n            // For each layout the cursor was on, check if it\r\n            // is still on. If not, fire the exit event.\r\n            this.mouseOnLast.forEach((oldLayout: LayoutState) => {\r\n                if (currentlyOn.indexOf(oldLayout) === -1) {\r\n                    // Fire the exit event\r\n                    let handler = this.mouseExitEvents.get(oldLayout);\r\n                    handler(oldLayout, animSet, this);\r\n                }\r\n            });\r\n\r\n            this.mouseOnLast = currentlyOn;\r\n            animSet.start();\r\n\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @returns The total time this slideshow will take to play.\r\n     */\r\n    protected getTotalTime(): number {\r\n        let totalTime = 0;\r\n        // Look through each step\r\n        for (let i = 0; i < this.steps.length - 1; i++) {\r\n            const stepOptions = this.getStepOptions(i, i + 1);\r\n            // Find the duration for the actual step\r\n            const stepDuration = this.getDurations(stepOptions)[0];\r\n            // Find the duration for any delay\r\n            const delay = this.getAutoplayDelay(i);\r\n            \r\n            totalTime += stepDuration + delay;\r\n        }\r\n\r\n        // Add any delay at the end\r\n        totalTime += this.getAutoplayDelay(this.steps.length - 1);\r\n\r\n        return totalTime;\r\n    }\r\n\r\n    /**\r\n     * Start playing the steps one after another.\r\n     */\r\n    protected startAutoplay() {\r\n        // Remove play button\r\n        this.overlayContainer.style.display = \"none\";\r\n        // Create the progress indicator\r\n        const progressSet = new AnimationSet(\r\n            () => {}, this.ctx, 0, 0, this.backgroundFill\r\n        );\r\n        progressSet.addAnimation(new AutoplayProgressAnimation(\r\n            this.progress, progressSet, this.getTotalTime(), this.lastWidth, this.lastHeight\r\n        ));\r\n        this.autoplay();\r\n        progressSet.start();\r\n    }\r\n\r\n    /**\r\n     * Animate to the next step until done.\r\n     */\r\n    protected autoplay() {\r\n        if (this.currStep >= this.steps.length - 1) {\r\n            // At the end\r\n            setTimeout(() => {\r\n                this.stopAutoplay();\r\n                this.currStep = 0;\r\n                this.recalc(true);\r\n            }, this.getAutoplayDelay(this.steps.length - 1));\r\n        } else {\r\n            // Can go to next step\r\n            setTimeout(() => {\r\n                this.nextStep(() => {\r\n                    this.autoplay();\r\n                });\r\n            }, this.getAutoplayDelay(this.currStep));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Stop autoplaying.\r\n     */\r\n    protected stopAutoplay() {\r\n        this.overlayContainer.style.display = \"block\";\r\n    }\r\n\r\n    /**\r\n     * Get the delay before a step while autoplaying,\r\n     * or 0 if none exists.\r\n     * @param stepNum \r\n     */\r\n    protected getAutoplayDelay(stepNum: number): number {\r\n        if (this.isAutoplay.delays) {\r\n            if (this.isAutoplay.delays[stepNum]) {\r\n                return this.isAutoplay.delays[stepNum];\r\n            } else {\r\n                return 0;\r\n            }\r\n        } else {\r\n            return 0;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Updates the font size for this canvas.\r\n     * Should be called when the window size\r\n     * changes.\r\n     */\r\n    protected updateFontSize() {\r\n        this.fontSize = getFontSizeForTier(window['currentWidthTier']);\r\n    }\r\n\r\n    /**\r\n     * Update the dimensions of all content, and the current layout.\r\n     */\r\n    protected updateDimensions() {\r\n        this.forAllContent(content => {\r\n            content.recalcDimensions();\r\n        });\r\n        if (this.currRootContainer) {\r\n            this.currRootContainer.recalcDimensions();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Redraw the current step without animating.\r\n     * Does not recalculate layout.\r\n     */\r\n    protected redraw() {\r\n        this.ctx.save();\r\n        const pixelRatio = window.devicePixelRatio || 1;\r\n        this.ctx.fillStyle = this.backgroundFill;\r\n        this.ctx.fillRect(0, 0, this.canvas.width / pixelRatio, (this.canvas.height - 2) / pixelRatio);\r\n        this.ctx.restore();\r\n        this.currStates.forEach(f => {\r\n            this.ctx.save();\r\n            if (f.component instanceof EqContent) {\r\n                f.component.interpColorOff();\r\n                f.component.draw(f, f, 0, this.ctx);\r\n            }\r\n            this.ctx.restore();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Recalculates and redraws the current step.\r\n     * @param reparse Whether to reparse the container hierarchy.\r\n     */\r\n    protected recalc(reparse: boolean) {\r\n        let rootLayout;\r\n        [\r\n            this.currStates,\r\n            rootLayout,\r\n            this.mouseEnterEvents,\r\n            this.mouseExitEvents,\r\n            this.mouseClickEvents,\r\n            this.tempContent\r\n        ] = this.calcLayout(this.currStep, reparse);\r\n        this.mouseOnLast = [];\r\n        let [width, height] = this.getSize(rootLayout);\r\n        this.setSize(width, height);\r\n        this.redraw();\r\n        if (this.progress) {\r\n            this.progress.draw(this.currStep / (this.steps.length - 1), width, height);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * If possible, animate to the next step\r\n     * in the sequence.\r\n     * @param whenDone A function to call when the next step animation is complete.\r\n     */\r\n    protected nextStep(whenDone?: () => void) {\r\n        if (this.currStep + 1 >= this.steps.length || this.currAnimation) {\r\n            //Can't go to next step\r\n            return;\r\n        }\r\n\r\n        this.currStep++;\r\n\r\n        let oldStates = this.currStates;\r\n        let rootLayout\r\n        [\r\n            this.currStates,\r\n            rootLayout,\r\n            this.mouseEnterEvents,\r\n            this.mouseExitEvents,\r\n            this.mouseClickEvents,\r\n            this.tempContent\r\n        ] = this.calcLayout(this.currStep, true);\r\n        this.mouseOnLast = [];\r\n        let [width, height] = this.getSize(rootLayout);\r\n        this.currAnimation = this.diff(oldStates, width, height, this.currStep - 1, this.currStep, whenDone instanceof Function ? whenDone : undefined);\r\n        this.currAnimation.start();\r\n    }\r\n\r\n    /**\r\n     * If possible, animate to the previous step.\r\n     */\r\n    protected prevStep() {\r\n        if (this.currStep - 1 < 0) {\r\n            //Can't go to next step\r\n            return;\r\n        }\r\n\r\n        // Stop the current animation if there is one\r\n        if (this.currAnimation) {\r\n            this.currAnimation.stop();\r\n            this.redraw();\r\n        }\r\n\r\n        this.currStep--;\r\n\r\n        let oldStates = this.currStates;\r\n        let rootLayout;\r\n        [\r\n            this.currStates,\r\n            rootLayout,\r\n            this.mouseEnterEvents,\r\n            this.mouseExitEvents,\r\n            this.mouseClickEvents,\r\n            this.tempContent\r\n        ] = this.calcLayout(this.currStep, true);\r\n        this.mouseOnLast = [];\r\n        let [width, height] = this.getSize(rootLayout);\r\n        this.currAnimation = this.diff(oldStates, width, height, this.currStep + 1, this.currStep, undefined);\r\n        this.currAnimation.start();\r\n    }\r\n\r\n    /**\r\n     * Return to the first step.\r\n     */\r\n    protected restart() {\r\n        if (this.currAnimation || this.currStep === 0) {\r\n            //Can't go to next step\r\n            return;\r\n        }\r\n\r\n        let oldStep = this.currStep;\r\n        this.currStep = 0;\r\n\r\n        let oldStates = this.currStates;\r\n        let rootLayout;\r\n        [\r\n            this.currStates,\r\n            rootLayout,\r\n            this.mouseEnterEvents,\r\n            this.mouseExitEvents,\r\n            this.mouseClickEvents,\r\n            this.tempContent\r\n        ] = this.calcLayout(this.currStep, true);\r\n        this.mouseOnLast = [];\r\n        let [width, height] = this.getSize(rootLayout);\r\n        this.currAnimation = this.diff(oldStates, width, height, oldStep, 0, undefined);\r\n        this.currAnimation.start();\r\n    }\r\n\r\n    /**\r\n     * Run a callback for all content.\r\n     * @param forEach A function that will be passed each bit of content.\r\n     */\r\n    private forAllContent(forEach: (content: EqContent<any>) => void) {\r\n        this.components.forAllContent(forEach);\r\n        this.tempContent.forEach(forEach);\r\n    }\r\n\r\n    /**\r\n     * Calculates and returns a set of animations\r\n     * to play between the current and old step. \r\n     * Also changes the canvas dimensions to\r\n     * accommodate the new layout.\r\n     * \r\n     * @param oldStates The Map of layouts from the previous step.\r\n     * @param canvasWidth The width the canvas should be as of the current step.\r\n     * @param canvasHeight The height the canvas should be as of the current step.\r\n     * @param stepBefore The old step number.\r\n     * @param stepAfter The current step number.\r\n     * @param whenDone A function to call when the animation is done.\r\n     */\r\n    private diff(oldStates: Map<EqComponent<any>, LayoutState>, canvasWidth: number, canvasHeight: number,\r\n        stepBefore: number, stepAfter: number, whenDone: () => void): AnimationSet {\r\n\r\n        let updateDimenAfter = canvasHeight < this.lastHeight;\r\n        if (!updateDimenAfter) {\r\n            this.setSize(canvasWidth, canvasHeight);\r\n            /*\r\n            IE Workaround: Setting size erases canvas,\r\n            redraw immediately to avoid flash of blank.\r\n            */\r\n            if (isIE) {\r\n                let actualCurrStates = this.currStates;\r\n                this.currStates = oldStates;\r\n                this.redraw();\r\n                this.currStates = actualCurrStates;\r\n            }\r\n        }\r\n\r\n        let set = new AnimationSet(() => {\r\n            // When done\r\n            if (updateDimenAfter) {\r\n                this.setSize(canvasWidth, canvasHeight);\r\n                this.redraw();\r\n            }\r\n            // Update next/restart button\r\n            if (this.restartOrNextButton) {\r\n                if (stepAfter === this.steps.length - 1) {\r\n                    // Going to last step, show restart button (unless only two steps, can just go back)\r\n                    this.restartOrNextButton.innerHTML = 'refresh';\r\n                } else {\r\n                    // Not going to last step, show next step button\r\n                    this.restartOrNextButton.innerHTML = 'keyboard_arrow_right';\r\n                }\r\n            }\r\n            // If we weren't animating the progress bar, draw it on the final frame.\r\n            if (this.progress && updateDimenAfter) {\r\n                this.progress.draw(this.currStep / (this.steps.length - 1), canvasWidth, canvasHeight);\r\n            }\r\n            this.currAnimation = undefined;\r\n            if (whenDone) {\r\n                whenDone();\r\n            }\r\n        }, this.ctx, this.lastWidth, this.lastHeight - 2, this.backgroundFill);\r\n\r\n        // Get the step options for this transition\r\n        let stepOptions: TransitionOptionsFormat;\r\n        let reverseStep: boolean;\r\n        if (stepBefore < stepAfter) {\r\n            // Going forward\r\n            stepOptions = this.getStepOptions(stepBefore, stepAfter);\r\n            reverseStep = false;\r\n        } else {\r\n            // Going backwards\r\n            stepOptions = this.getStepOptions(stepAfter, stepBefore);\r\n            reverseStep = true;\r\n        }\r\n        // Whether a merge animation exists for this step\r\n        let mergeExists = (ref: string) => {\r\n            return stepOptions && stepOptions.merges && stepOptions.merges[ref];\r\n        };\r\n        // Whether a clone animation exists for this step\r\n        let cloneExists = (ref: string) => {\r\n            return stepOptions && stepOptions.clones && stepOptions.clones[ref];\r\n        };\r\n        // Whether an eval animation exists for this step\r\n        let evalExists = (ref: string) => {\r\n            return stepOptions && stepOptions.evals && stepOptions.evals[ref];\r\n        };\r\n        // Find the durations for each transition type (may be custom)\r\n        let [maxDuration, addDuration, moveDuration, removeDuration] = this.getDurations(stepOptions);\r\n        // Add and remove need to be switched if we're going backwards\r\n        if (reverseStep) {\r\n            const temp = addDuration;\r\n            addDuration = removeDuration;\r\n            removeDuration = temp;\r\n        }\r\n\r\n        // Add a merge animation\r\n        let addMerge = function (mergeToRef: string, stateBefore: LayoutState) {\r\n            let mergeTo = this.components.getContent(mergeToRef);\r\n            let mergeToNewState = this.currStates.get(mergeTo);\r\n            set.addAnimation(new MoveAnimation(stateBefore, mergeToNewState, set, this.ctx, moveDuration));\r\n        }.bind(this);\r\n        // Add a clone animation\r\n        let addClone = function (cloneFromRef: string, stateAfter: LayoutState) {\r\n            let cloneFrom = this.components.getContent(cloneFromRef);\r\n            let cloneFromOldState = oldStates.get(cloneFrom);\r\n            set.addAnimation(new MoveAnimation(cloneFromOldState, stateAfter, set, this.ctx, moveDuration));\r\n        }.bind(this);\r\n        // Add an eval animation\r\n        let addEval = function (evalToRef: string, stateBefore: LayoutState) {\r\n            let evalTo = this.components.getContent(evalToRef);\r\n            let evalToNewState = this.currStates.get(evalTo);\r\n            set.addAnimation(new EvalAnimation(stateBefore, evalToNewState, set, this.ctx, moveDuration));\r\n        }.bind(this);\r\n        // Add a reverse eval\r\n        let addRevEval = function (evalToRef: string, stateAfter: LayoutState) {\r\n            let evalTo = this.components.getContent(evalToRef);\r\n            let evalToOldState = oldStates.get(evalTo);\r\n            set.addAnimation(new ReverseEvalAnimation(evalToOldState, stateAfter, set, this.ctx, moveDuration));\r\n        }.bind(this);\r\n\r\n        // Animate the progress indicator\r\n        if (this.progress && !updateDimenAfter && !this.isAutoplay) {\r\n            set.addAnimation(\r\n                new ProgressAnimation(\r\n                    stepBefore, stepAfter, this.steps.length, this.progress, set, maxDuration,\r\n                    progressEasing, canvasWidth, canvasHeight\r\n                )\r\n            );\r\n        }\r\n\r\n        // Handle edge case:\r\n        // If autoplaying, need to make sure the animation runs for\r\n        // maxDuration, or else our calculated duration may be off\r\n        // depending on the two steps.\r\n        if (this.autoplay) {\r\n            set.addAnimation(new DummyAnimation(maxDuration, set));\r\n        }\r\n\r\n        // Look through content to see what has happened to it (avoiding containers)\r\n        this.forAllContent(content => {\r\n\r\n            let stateBefore: LayoutState = undefined;\r\n            // We may be initilizing, where there are no old frames and everything is added\r\n            if (oldStates !== undefined) stateBefore = oldStates.get(content);\r\n            let stateAfter: LayoutState = this.currStates.get(content);\r\n            let contentRef = content.getRef();\r\n\r\n            if (stateBefore && stateAfter) {\r\n                // Content has just moved\r\n                set.addAnimation(new MoveAnimation(stateBefore, stateAfter, set, this.ctx, moveDuration));\r\n\r\n            } else if (stateBefore) {\r\n                // Doesn't exist after, has been removed\r\n                if (mergeExists(contentRef)) {\r\n                    // Do a merge animation\r\n                    addMerge(stepOptions.merges[contentRef], stateBefore);\r\n                } else if (evalExists(contentRef)) {\r\n                    // Do an eval animation\r\n                    addEval(stepOptions.evals[contentRef], stateBefore);\r\n                } else if (reverseStep && cloneExists(contentRef)) {\r\n                    // Do a reverse clone, aka merge.\r\n                    // Cloning is \"to\": \"from\", need to work backwards\r\n                    addMerge(stepOptions.clones[contentRef], stateBefore);\r\n                } else {\r\n                    // Do a regular remove animation\r\n                    set.addAnimation(new RemoveAnimation(stateBefore, set, this.ctx, removeDuration));\r\n                }\r\n\r\n            } else if (stateAfter) {\r\n                // Doesn't exist before, has been added\r\n                if (cloneExists(contentRef)) {\r\n                    // Do a clone animation\r\n                    addClone(stepOptions.clones[contentRef], stateAfter);\r\n                } else if (reverseStep && mergeExists(contentRef)) {\r\n                    // Do a reverse merge, aka clone.\r\n                    // Merging is \"from\": \"to\", need to work backwards.\r\n                    addClone(stepOptions.merges[contentRef], stateAfter);\r\n                } else if (reverseStep && evalExists(contentRef)) {\r\n                    // Do a reverse eval\r\n                    addRevEval(stepOptions.evals[contentRef], stateAfter);\r\n                } else {\r\n                    set.addAnimation(new AddAnimation(stateAfter, set, this.ctx, addDuration));\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        return set;\r\n    }\r\n\r\n    /**\r\n     * Gets the dimensions of the canvas based on\r\n     * the root layout state.\r\n     * \r\n     * @param root The layout state of the root container.\r\n     */\r\n    protected getSize(root: LayoutState): [number, number] {\r\n        let rootHeight = root.height;\r\n        let rootWidth = root.width;\r\n        let currWidth = this.container.clientWidth;\r\n        let newWidth = rootWidth > currWidth ? rootWidth : currWidth;\r\n        return [newWidth, rootHeight];\r\n    }\r\n\r\n    /**\r\n     * Sets the dimensions of the canvas.\r\n     * \r\n     * @param newWidth The new width.\r\n     * @param newHeight The new height.\r\n     */\r\n    protected setSize(newWidth: number, newHeight: number) {\r\n        if (newWidth === this.lastWidth && newHeight === this.lastHeight) {\r\n            //Early return, no need to change size\r\n            return;\r\n        }\r\n\r\n        //Update canvas css size\r\n        this.canvas.style.width = newWidth + \"px\";\r\n        this.canvas.style.height = newHeight + \"px\";\r\n\r\n        //Update canvas pixel size for HDPI\r\n        const pixelRatio = window.devicePixelRatio || (isIE && window.screen['deviceXDPI'] / window.screen['logicalXDPI']) ||1;\r\n        this.canvas.width = newWidth * pixelRatio;\r\n        this.canvas.height = newHeight * pixelRatio;\r\n        this.ctx.scale(pixelRatio, pixelRatio);\r\n        this.ctx.font = this.fontWeight + \" \" + this.fontStyle + \" \" + this.fontSize + \"px \" + this.fontFamily;\r\n\r\n        this.lastHeight = newHeight;\r\n        this.lastWidth = newWidth;\r\n    }\r\n\r\n    /**\r\n     * Return the step options object for the\r\n     * transition between two steps. Returns\r\n     * undefined if there are no step options\r\n     * for that transition. Step2 must be greater\r\n     * than Step1.\r\n     * \r\n     * @param step1 The first step.\r\n     * @param step2 The second step.\r\n     */\r\n    protected getStepOptions(step1: number, step2: number): TransitionOptionsFormat {\r\n        if (!this.stepOptions) {\r\n            //No step options defined\r\n            return undefined;\r\n        }\r\n        if (step2 - step1 !== 1) {\r\n            //Steps are seperated or in the wrong order\r\n            return undefined;\r\n        }\r\n        return this.stepOptions[step2 - 1];\r\n    }\r\n\r\n    /**\r\n     * Given the options of a step, return the durations to use\r\n     * for that step.\r\n     * @param stepOptions The step options object.\r\n     * @returns [maxDuration, addDuration, moveDuration, removeDuration]\r\n     */\r\n    protected getDurations(stepOptions: TransitionOptionsFormat): [number, number, number, number] {\r\n        const moveDuration =    stepOptions && stepOptions.moveDuration ?   stepOptions.moveDuration :      defaultMoveDuration;\r\n        const addDuration =     stepOptions && stepOptions.addDuration ?    stepOptions.addDuration :       defaultAddDuration;\r\n        const removeDuration =  stepOptions && stepOptions.removeDuration ? stepOptions.removeDuration :    defaultRemoveDuration;\r\n        const maxDuration = Math.max(moveDuration, addDuration, removeDuration);\r\n        return [maxDuration, addDuration, moveDuration, removeDuration];\r\n    }\r\n\r\n    /**\r\n     * Calculate and return the layout for\r\n     * a particular step. Returns [all layouts, root layout, mouse enter events, mouse exit events, mouse click events, temp content].\r\n     * \r\n     * @param idx The step number.\r\n     * @param reparse Whether to re-create the container hierarchy.\r\n     */\r\n    protected calcLayout(idx: number, reparse: boolean): [Map<EqComponent<any>, LayoutState>, LayoutState,\r\n        Map<LayoutState, MouseEventCallback>,\r\n        Map<LayoutState, MouseEventCallback>,\r\n        Map<LayoutState, MouseEventCallback>,\r\n        EqContent<any>[]] {\r\n\r\n        //First create the structure of containers in memory\r\n        if (reparse) {\r\n            let rootObj = this.steps[idx].root;\r\n            this.currRootContainer = this.components.parseContainer(rootObj, 0);\r\n        }\r\n        //If content doesn't take up full width, center it\r\n        let width = this.container.clientWidth;\r\n        if (this.currRootContainer.getWidth() < width) {\r\n            this.currRootContainer.setWidth(width);\r\n        }\r\n        //Apply fixed height\r\n        if (this.fixedHeights) {\r\n            let height = this.fixedHeights[window['currentWidthTier']];\r\n            this.currRootContainer.setHeight(height);\r\n        }\r\n\r\n        //Set the text\r\n        if (reparse && this.textArea) {\r\n            this.textArea.innerHTML = this.steps[idx].text ? this.steps[idx].text : \"\";\r\n        }\r\n\r\n        //Get the color info\r\n        let colorsObj = this.steps[idx].color;\r\n        let opacityObj = this.steps[idx].opacity;\r\n\r\n        let allLayouts = newMap();\r\n        let mouseEnters = newMap();\r\n        let mouseExits = newMap();\r\n        let mouseClicks = newMap();\r\n        let tempContent = [];\r\n        let rootLayout = this.currRootContainer.addLayout(undefined, allLayouts, 0, 0, 1, opacityObj, colorsObj,\r\n            mouseEnters, mouseExits, mouseClicks, tempContent);\r\n        return [allLayouts, rootLayout, mouseEnters, mouseExits, mouseClicks, tempContent];\r\n    }\r\n}","import { FileFormat, ContainerFormat } from \"./FileFormat\";\r\nimport EqContent from \"../layout/EqContent\";\r\nimport { Map, newMap } from \"./helpers\";\r\nimport EqContainer from \"../layout/EqContainer\";\r\n\r\n/**\r\n * Passed to content decorator function to specify various things.\r\n */\r\ninterface ContentSpec {\r\n    // The identifying character that makes the first character\r\n    // of content references in the JSON files.\r\n    character: string;\r\n    // Function to initialize the content from the JSON file\r\n    // and general info.\r\n    initialize: (file: FileFormat, genInfo: object) => EqContent<any>[];\r\n    // Function to calculate general content information that\r\n    // any content may need. Called before the other function.\r\n    // General info is stored in an object.\r\n    calcInfo?: (file: FileFormat, genInfo: object) => void;\r\n}\r\n\r\nconst contentSpecs: ContentSpec[] = [];\r\n\r\nexport function Content(contentSpec: ContentSpec) {\r\n    contentSpecs.push(contentSpec);\r\n    return (construc: Function) => {};\r\n}\r\n\r\n// The function type used by containers to return instances of themselves.\r\ntype parseFunc = (\r\n    containerObj: ContainerFormat,\r\n    depth: number,\r\n    contentGetter: (ref: string) => EqContent<any>,\r\n    containerGetter: (obj: ContainerFormat, depth: number) => EqContainer<any>,\r\n    genInfo: object\r\n) => EqContainer<any>;\r\n\r\n/**\r\n * Passed to container decorator function to specify various things.\r\n */\r\ninterface ContainerSpec {\r\n    // The identifying string of the container, as specified in\r\n    // main/FileFormat.ContainerFormat.\r\n    typeString: string;\r\n    // The parser of the contaier\r\n    parse: parseFunc;\r\n}\r\n\r\nexport const containerParsers: {[typeString: string]: parseFunc} = {};\r\n\r\nexport function Container(containerSpec: ContainerSpec) {\r\n    containerParsers[containerSpec.typeString] = containerSpec.parse;\r\n    return (construc: Function) => {};\r\n}\r\n\r\n/**\r\n * Stores content/container information for a Canvas Controller in a way that's\r\n * modular. The decorator function above is used to mark content usable\r\n * here, and specifies how to load and store it.\r\n */\r\nexport class ComponentModel {\r\n\r\n    protected genInfo = {};\r\n    protected content: Map<string, EqContent<any>[]> = newMap();\r\n\r\n    /**\r\n     * Initialize the component model and the content\r\n     * in the file.\r\n     * @param file The file.\r\n     */\r\n    constructor(file: FileFormat) {\r\n        // Initialize general info\r\n        contentSpecs.forEach(spec => {\r\n            if (spec.calcInfo) {\r\n                spec.calcInfo(file, this.genInfo);\r\n            }\r\n        });\r\n        // Initialize content\r\n        contentSpecs.forEach(spec => {\r\n            this.content.set(spec.character, spec.initialize(file, this.genInfo));\r\n        });\r\n\r\n        this.getContent = this.getContent.bind(this);\r\n        this.parseContainer = this.parseContainer.bind(this);\r\n    }\r\n\r\n    /**\r\n     * Call a function for all content.\r\n     * @param callback The function.\r\n     */\r\n    forAllContent(callback: (content: EqContent<any>) => void) {\r\n        this.content.forEach(contentArr => {\r\n            contentArr.forEach(content => {\r\n                callback(content);\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get content by its reference.\r\n     * @param ref The content reference.\r\n     */\r\n    getContent(ref: string): EqContent<any> {\r\n        const contentType: string = ref.substring(0, 1);\r\n        const contentIndex: number = parseFloat(ref.substring(1, ref.length));\r\n        return this.content.get(contentType)[contentIndex];\r\n    }\r\n\r\n    /**\r\n     * Parse a container object recursively and return its\r\n     * class representation.\r\n     * @param containerObj The container object to parse.\r\n     * @param depth The depth in the container hierarchy.\r\n     */\r\n    parseContainer(containerObj: ContainerFormat, depth: number): EqContainer<any> {\r\n        return containerParsers[containerObj.type](\r\n            containerObj,\r\n            depth,\r\n            this.getContent,\r\n            this.parseContainer,\r\n            this.genInfo\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Set general info that content/containers might need\r\n     * to initialize.\r\n     * @param key The name of the info.\r\n     * @param val The info.\r\n     */\r\n    setGenInfo(key: string, val: any) {\r\n        this.genInfo[key] = val;\r\n    }\r\n\r\n}","import CanvasController from './CanvasController';\r\nimport { widthTiers } from './consts';\r\nimport { getWidthTier } from './helpers';\r\nimport { FileFormat } from './FileFormat';\r\n\r\n/**\r\n * Canvas controller that computes the max height of an\r\n * instructions object at each font size.\r\n */\r\nexport default class HeightComputeCanvasController extends CanvasController {\r\n\r\n    private origInstructions: FileFormat;\r\n\r\n    constructor(instructions: FileFormat) {\r\n        super(document.createElement('div'), instructions);\r\n        this.origInstructions = instructions;\r\n    }\r\n\r\n    /**\r\n     * Compute the maximum height of all steps for\r\n     * a width tier.\r\n     * @param tier The width tier.\r\n     */\r\n    private getMaxHeight(tier: number): number {\r\n        const win: any = window;\r\n        win.currentWidthTier = tier;\r\n        for (let i = 0; i < this.origInstructions.terms.length; i++) {\r\n            this.components.getContent('t' + i).recalcDimensions();\r\n        }\r\n        let maxHeight = 0;\r\n        for (let i = 0; i < this.steps.length; i++) {\r\n            const layout = this.calcLayout(i, true)[1];\r\n            if (layout.height > maxHeight) {\r\n                maxHeight = layout.height;\r\n            }\r\n        }\r\n        win.currentWidthTier = getWidthTier();\r\n        return maxHeight;\r\n    }\r\n\r\n    /**\r\n     * Compute and return the maximum height of every\r\n     * step for each font size tier. The array returned\r\n     * corresponds to each font size tier.\r\n     */\r\n    compute(): number[] {\r\n        const toReturn: number[] = [];\r\n        for (let i = 0; i < widthTiers.length; i++) {\r\n            toReturn.push(this.getMaxHeight(i));\r\n        }\r\n        return toReturn;\r\n    }\r\n}\r\n","import { progressOpacity } from './consts';\r\nimport EqContent from '../layout/EqContent';\r\nimport { line } from './helpers';\r\n\r\n/**\r\n * Given a canvas, draws a line at the bottom to indicate\r\n * the current completion.\r\n */\r\nexport default class ProgressIndicator {\r\n    \r\n    private ctx: CanvasRenderingContext2D;\r\n    private backgroundFill: string;\r\n\r\n    /**\r\n     * Create a new ProgressIndicator drawing\r\n     * to a canvas.\r\n     * @param canvas The canvas to draw to.\r\n     * @param backgroundFill The color to fill the background with. Each frame,\r\n     * the Progress Indicator erases itself independently to the rest of the canvas.\r\n     */\r\n    constructor(canvas: HTMLCanvasElement, backgroundFill: string) {\r\n        this.ctx = canvas.getContext(\"2d\");\r\n        this.backgroundFill = backgroundFill;\r\n    }\r\n\r\n    /**\r\n     * Draw the line on the canvas at some level of \r\n     * completion.\r\n     * @param completion The completion as a decimal.\r\n     * @param width The width of the canvas to draw on.\r\n     * @param height The height of the canvas to draw on.\r\n     */\r\n    public draw(completion: number, width: number, height: number) {\r\n        const color = EqContent.colors['default'];\r\n        this.ctx.strokeStyle = 'rgba(' + color[0] + ',' + color[1] + ',' + color[2] + ',' + progressOpacity + ')';\r\n        this.ctx.fillStyle = this.backgroundFill;\r\n        this.ctx.fillRect(0, height - 2, width, 2);\r\n        line(0, height - 1, width * completion, height - 1, this.ctx);\r\n    }\r\n\r\n}","import Padding from '../layout/Padding';\r\nimport bezier from 'bezier-easing';\r\n\r\n// The DEFAULT Google font, may be overridden.\r\nexport const defaultFontFamily = 'PT Serif'\r\n// Normal or italic\r\nexport const defaultFontStyle = 'Normal'\r\n// Must be supported by the google font\r\nexport const defaultFontWeight = '400'\r\n// The font size at each width tier below\r\nexport const fontSizes = [35, 30, 25]\r\n// The tiers at which font size will change.\r\n// More tiers means better layout but worse\r\n// file size.\r\nexport const widthTiers = [670, 500, 300]\r\n// Tuning variable, turn down for better\r\n// performance when loading files without\r\n// inbuilt metrics.Too low will give layout\r\n// innacuracies.\r\nexport const testCanvasFontSizeMultiple = 5\r\n// The width of the test canvas. Once again,\r\n// can turn down for better performance, but\r\n// will limit the maximum width of terms.\r\nexport const testCanvasWidth = 10000\r\n// The opacity of the progress bar\r\nexport const progressOpacity = 0.25\r\n\r\n// Layout:\r\nexport const defaultVBoxPadding = 0\r\nexport const defaultRootVBoxPadding = new Padding(18, 0, 20, 0)\r\nexport const defaultHBoxPadding = 0\r\nexport const defaultTightHBoxPadding = 0\r\nexport const defaultSubSuperPadding = Padding.even(0)\r\nexport const defaultRootPadding = Padding.even(0)\r\nexport const defaultQuizPadding = new Padding(0, 10, 0, 10)\r\nexport const defaultTablePadding = Padding.even(2)\r\nexport const termPadding = new Padding(10, 5, 10, 5)\r\nexport const tightTermPadding = new Padding(5, 2, 5, 2)\r\nexport const hDividerPadding = new Padding(0, 3, 0, 3)\r\nexport const vDividerPadding = new Padding(3, 0, 3, 0)\r\nexport const tableCellPadding = new Padding(7, 7, 7, 7)\r\nexport const tableMinCellDimen = 30\r\n// The scaling of exponents and subscripts.\r\nexport const expScale = 0.575\r\n// The proportion of exponents and subscripts that portrudes from the component they're 'attached' to.\r\nexport const defaultExpPortrusion = 0.1\r\n\r\n// Roots:\r\nexport const rootArgMarginLeft = 7\r\nexport const rootIndexScale = 0.5\r\n// The angle the small tip of the radical kink makes\r\n// to the rest of the kink.\r\nexport const rootKinkTipAngle = Math.PI / 2\r\nexport const rootKinkTipLength = 3\r\n\r\n// Curved outlines:\r\nexport const curvedOutlineBorderRadius = 5\r\nexport const curvedOutlineDefaultOpacity = 0.3\r\nexport const curvedOutlineColor = [255, 255, 255] as [number, number, number]\r\n\r\n// Radio buttons:\r\nexport const radioButtonDefaultOpacity = 0.3\r\nexport const radioButtonColor = [255, 255, 255] as [number, number, number]\r\n\r\n// Quizzes:\r\nexport const answerVMargin = 20\r\nexport const hoveredOutlineOpacity = 0.75\r\nexport const revealedOutlineOpacity = 1\r\nexport const outlineFadeInDuration = 300\r\nexport const outlineFadeInEasing = bezier(0.5, 0.5, 0.5, 0.5)\r\nexport const quizCorrectColor = [100, 221, 23] as [number, number, number]\r\nexport const quizIncorrectColor = [198, 40, 40] as [number, number, number]\r\nexport const quizCurvedOutlinePadding = new Padding(0, 5, 0, 5)\r\nexport const quizRadioButtonDimen = 35\r\nexport const quizRadioButtonPadding = Padding.even(10)\r\nexport const quizRadioButtonSelectDuration = 300\r\nexport const quizRadioButtonSelectEasing = bezier(0.0, 0.0, 0.2, 1)\r\nexport const quizRadioButtonDeselectDuration = 300\r\nexport const quizRadioButtonDeselectEasing = bezier(0.4, 0.0, 1, 1)\r\n\r\n// Creator:\r\nexport const creatorContainerPadding = Padding.even(30)\r\nexport const creatorHDividerPadding = new Padding(5, 15, 5, 15)\r\nexport const creatorVDividerPadding = new Padding(15, 5, 15, 5)\r\nexport const creatorSelectableHDividerPadding = new Padding(5, 0, 5, 0)\r\nexport const creatorSelectableVDividerPadding = new Padding(0, 5, 0, 5)\r\nexport const creatorContainerStroke = \"rgb(175, 175, 175)\"\r\nexport const creatorCaretFillStyle = '#eee'\r\nexport const creatorCaretFillStyleLighter = '#777'\r\nexport const creatorCaretSize = 5\r\nexport const creatorLineDash = [2]\r\nexport const creatorErrorTimeout = 5000\r\nexport const creatorTableMinCellDimen = 30\r\nexport const creatorPlusLineHalfLength = 5\r\n\r\n// Animations: durations are in MS\r\nexport const defaultAddDuration = 700\r\nexport const addEasing = bezier(0.0, 0.0, 0.2, 1)\r\nexport const defaultMoveDuration = 700\r\nexport const moveEasing = bezier(0.4, 0.0, 0.2, 1)\r\nexport const defaultRemoveDuration = 400\r\nexport const removeEasing = bezier(0.4, 0.0, 1, 1)\r\nexport const progressEasing = bezier(0.4, 0.0, 0.2, 1)\r\nexport const autoplayProgressEasing = bezier(0.5, 0.5, 0.5, 0.5)\r\n\r\n// Appearance:\r\nexport const colors = {\r\n    //RGB\r\n    \"red\": [229, 57, 53],\r\n    \"pink\": [247, 18, 171],\r\n    \"purple\": [170, 0, 255],\r\n    \"blue\": [27, 158, 245],\r\n    \"teal\": [0, 181, 193],\r\n    \"green\": [88, 199, 75],\r\n    \"orange\": [255, 102, 0],\r\n    \"default\": [255, 255, 255],\r\n    \"primary\": [212, 225, 87],\r\n    \"secondary\": [255, 193, 7]\r\n} as { [cName: string]: [number, number, number] }\r\nexport const fadedOpacity = 0.5\r\nexport const normalOpacity = 0.75\r\nexport const focusedOpacity = 1\r\nexport const backgroundColor = [0, 0, 0] as [number, number, number]\r\n\r\n// Button animations:\r\nexport const buttonHighlightedOpacity = 1\r\nexport const buttonHighlightDuration = 200\r\nexport const buttonHighlightEasing = bezier(0.0, 0.0, 0.2, 1)\r\nexport const buttonUnhighlightDuration = 200\r\nexport const buttonUnhighlightEasing = bezier(0.4, 0.0, 1, 1)","import { colors, defaultFontStyle, defaultFontWeight, defaultFontFamily, widthTiers, testCanvasWidth, testCanvasFontSizeMultiple, fontSizes } from './consts';\r\nimport Map from 'map-or-similar';\r\nimport { FileFormat, CustomFontFormat, GoogleFontFormat, MetricsFormat, ContainerFormat } from './FileFormat';\r\nimport EqComponent from '../layout/EqComponent';\r\nimport EqContainer from '../layout/EqContainer';\r\nimport EqContent from '../layout/EqContent';\r\n\r\n/**\r\n * Given an array of r, g, b, and a values respectively,\r\n * return the CSS representation of that color.\r\n * @param colorArr The CSS color.\r\n */\r\nexport function rgbaArrayToCssString(colorArr: number[]) {\r\n    const r = colorArr[0];\r\n    const g = colorArr[1];\r\n    const b = colorArr[2];\r\n    const a = colorArr[3];\r\n    if (a !== undefined) {\r\n        return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\r\n    } else {\r\n        return 'rgb(' + r + ',' + g + ',' + b + ')';\r\n    }\r\n}\r\n\r\n/**\r\n * Add styles based on the contents of consts\r\n * \r\n * @param otherColors If present, use other colors than the default.\r\n */\r\nexport function addStyleSheet(otherColors?: { [colName: string]: [number, number, number] }) {\r\n    const styleEl = document.createElement('style');\r\n    let styleText = '';\r\n    const colorObj = otherColors ? otherColors : colors;\r\n    Object.keys(colorObj).forEach(colorName => {\r\n        const colorVal = colorObj[colorName];\r\n        styleText += '.' + colorName + ' { color: ' + rgbaArrayToCssString(colorVal) + '}';\r\n    });\r\n    styleEl.appendChild(document.createTextNode(styleText));\r\n    document.head.appendChild(styleEl);\r\n}\r\n\r\n/**\r\n * Return the font family, style, and weight (in that order) to\r\n * use for a given instructions object.\r\n * @param instructions The instructions.\r\n */\r\nexport function getFont(instructions: FileFormat): [string, string, string] {\r\n    if (instructions.font) {\r\n        // There's a font set\r\n        if (instructions.font.type === \"c\") {\r\n            // There's a custom font\r\n            let font = instructions.font as CustomFontFormat;\r\n            return [\r\n                font.name,\r\n                font.style,\r\n                font.weight\r\n            ];\r\n        } else if (instructions.font.type === \"g\") {\r\n            let font = instructions.font as GoogleFontFormat;\r\n            // There's a google font\r\n            let descriptor: string = font.name;\r\n            let split: string[] = descriptor.split(\":\");\r\n            const fontFamily = split[0];\r\n            if (split[1]) {\r\n                // It has a special weight/italic\r\n                if (split[1].charAt(split[1].length - 1) === \"i\") {\r\n                    // Is italic\r\n                    return [\r\n                        fontFamily,\r\n                        'italic',\r\n                        split[1].substring(0, split[1].length - 1)\r\n                    ];\r\n                } else {\r\n                    // Not italic\r\n                    return [\r\n                        fontFamily,\r\n                        defaultFontStyle,\r\n                        split[1]\r\n                    ]\r\n                }\r\n            } else {\r\n                // No defined weight/italic\r\n                return [\r\n                    fontFamily,\r\n                    defaultFontStyle,\r\n                    defaultFontWeight\r\n                ];\r\n            }\r\n        } else {\r\n            throw \"Unrecognized custom font type\";\r\n        }\r\n    } else {\r\n        // Use default\r\n        return [\r\n            defaultFontFamily,\r\n            defaultFontStyle,\r\n            defaultFontWeight\r\n        ];\r\n    }\r\n}\r\n\r\n/**\r\n * Get the font metrics object for an instructions object.\r\n * @param instructions The instructions to get the metrics for.\r\n */\r\nexport function getMetrics(instructions: FileFormat): MetricsFormat[] {\r\n    const metricsArr = [];\r\n    // Calculate a metrics object for each width tier\r\n    for (let i = 0; i < widthTiers.length; i++) {\r\n        const metrics: any = {};\r\n        metricsArr.push(metrics);\r\n\r\n        metrics.widths = [];\r\n\r\n        /* Look for the max ascent and\r\n           descent, which all terms will use. */\r\n        let maxAscent = 0;\r\n        let maxDescent = 0;\r\n        instructions.terms.forEach(term => {\r\n            const termMetrics: any = measureTerm(term, i, instructions);\r\n            if (termMetrics.ascent > maxAscent) {\r\n                maxAscent = termMetrics.ascent;\r\n            }\r\n            if (termMetrics.descent > maxDescent) {\r\n                maxDescent = termMetrics.descent;\r\n            }\r\n            // All terms have their own width\r\n            metrics.widths.push(termMetrics.width);\r\n        });\r\n        metrics.ascent = maxAscent;\r\n        metrics.height = maxAscent + maxDescent;\r\n    }\r\n    return metricsArr;\r\n}\r\n\r\n/**\r\n * Measure the metrics for a term.\r\n * @param term The term to measure.\r\n * @param tier The width tier to measure this term for.\r\n * @param instructions The instructions object containing this term.\r\n */\r\nfunction measureTerm(term: string, tier: number, instructions: FileFormat): object {\r\n    const toReturn: any = {};\r\n\r\n    const fontSize = getFontSizeForTier(tier);\r\n\r\n    const [fontFamily, style, weight] = getFont(instructions);\r\n\r\n    // Create a canvas to measure with\r\n    const testCanvas = document.createElement('canvas');\r\n    testCanvas.width = testCanvasWidth;\r\n    testCanvas.height = fontSize * testCanvasFontSizeMultiple;\r\n    const testCtx = testCanvas.getContext('2d');\r\n    testCtx.font = weight + \" \" + style + \" \" + fontSize + \"px \" + fontFamily;\r\n\r\n    // Get the width\r\n    toReturn.width = testCtx.measureText(term).width;\r\n\r\n    // Draw the text on the canvas to measure ascent and descent\r\n    testCtx.fillStyle = 'white';\r\n    testCtx.fillRect(0, 0, testCanvas.width, testCanvas.height);\r\n    testCtx.fillStyle = 'black';\r\n    testCtx.fillText(term, 0, testCanvas.height / 2);\r\n\r\n    const image = testCtx.getImageData(0, 0, toReturn.width, testCanvas.height);\r\n    const imageData = image.data;\r\n\r\n    // Go down until we find text\r\n    let i = 0;\r\n    while (++i < imageData.length && imageData[i] === 255) { }\r\n    const ascent = i / (image.width * 4);\r\n\r\n    // Go up until we find text\r\n    i = imageData.length - 1;\r\n    while (--i > 0 && imageData[i] === 255) { }\r\n    const descent = i / (image.width * 4);\r\n\r\n    toReturn.ascent = testCanvas.height / 2 - ascent;\r\n    toReturn.descent = descent - testCanvas.height / 2;\r\n\r\n    return toReturn;\r\n}\r\n\r\n//Detects if the browser is ie\r\nlet userAgent = window.navigator.userAgent;\r\nexport const isIE = userAgent.indexOf('MSIE ') > -1 ||\r\n    userAgent.indexOf('Trident/') > -1 ||\r\n    userAgent.indexOf('Edge/') > -1;\r\n\r\n/**\r\n * Draws a line from one point to another.\r\n * \r\n * @param x1 Starting x.\r\n * @param y1 Starting y.\r\n * @param x2 End x.\r\n * @param y2 End y.\r\n * @param ctx The context to draw a line on.\r\n */\r\nexport function line(x1, y1, x2, y2, ctx: CanvasRenderingContext2D) {\r\n    ctx.beginPath();\r\n    ctx.moveTo(x1, y1);\r\n    ctx.lineTo(x2, y2);\r\n    ctx.stroke();\r\n}\r\n\r\n/**\r\n * Draws an equilateral stroked triangle based\r\n * on its center and width.\r\n * @param centX The X-ordinate of the center of the triangle.\r\n * @param centY The Y-ordinate of the center of the triangle.\r\n * @param width The width of the triangle.\r\n * @param height The height of the triangle.\r\n * @param ctx The context to render to.\r\n */\r\nexport function tri(centX: number, centY: number, width: number, height: number, ctx: CanvasRenderingContext2D) {\r\n    let tlx = centX - width / 2;\r\n    let tly = centY - height / 2;\r\n    ctx.beginPath();\r\n    ctx.moveTo(tlx, tly);\r\n    ctx.lineTo(tlx + width, tly);\r\n    ctx.lineTo(centX, tly + height);\r\n    ctx.lineTo(tlx, tly);\r\n    ctx.fill();\r\n}\r\n\r\nwindow['currentWidthTier'] = getWidthTier();\r\nwindow.addEventListener('resize', function () {\r\n    window['currentWidthTier'] = getWidthTier();\r\n});\r\n\r\n/**\r\n * Return the current width tier, as\r\n * defined by consts.widthTiers. The\r\n * returned number is the index of the\r\n * consts.widthTiers array. If the window\r\n * width is less than the minimum defined\r\n * there, returns the index of the minimum\r\n * width tier.\r\n */\r\nexport function getWidthTier(): number {\r\n    let currWidth = window.innerWidth;\r\n    for (let i = 0; i < widthTiers.length; i++) {\r\n        if (currWidth > widthTiers[i]) {\r\n            return i;\r\n        }\r\n    }\r\n    return widthTiers.length - 1;\r\n}\r\n\r\n/**\r\n * Calculates and returns the appropriate\r\n * font size for a width tier.\r\n */\r\nexport function getFontSizeForTier(tier: number): number {\r\n    return fontSizes[tier];\r\n}\r\n\r\nlet mapSupported = typeof window['Map'] === 'function';\r\n\r\n/**\r\n * Get a new Map, or Map-like-object\r\n * if Map is not supported. Available\r\n * operations are described by the interface\r\n * below.\r\n */\r\nexport function newMap(): Map<any, any> {\r\n    return mapSupported ? new window['Map']() : new Map();\r\n}\r\n\r\nexport interface Map<K, V> {\r\n    set(key: K, val: V);\r\n    get(key: K);\r\n    has(key: K);\r\n    delete(key: K);\r\n    forEach(callback: (val: V, key: K, object) => void);\r\n    size: number;\r\n}\r\n\r\n/**\r\n * Parse the children attribute of a container\r\n * JSON Object.\r\n * \r\n * @param children The children array.\r\n * @param depth The depth in the layout tree.\r\n */\r\nexport function parseContainerChildren\r\n(\r\n        children: any[], \r\n        depth: number, \r\n        parseContainer: (obj: ContainerFormat, depth: number) => EqContainer<any>,\r\n        contentGetter: (str: string) => EqContent<any>\r\n): EqComponent<any>[] {\r\n\r\n    const toReturn = [];\r\n    children.forEach(child => {\r\n        if (typeof child === 'object') {\r\n            if (child === null) {\r\n                toReturn.push(undefined);\r\n            } else {\r\n                toReturn.push(parseContainer(child, depth + 1));\r\n            }\r\n        } else if (typeof child === 'string') {\r\n            toReturn.push(contentGetter(child));\r\n        } else {\r\n            throw \"Invalid type of child in JSON file.\";\r\n        }\r\n    });\r\n    return toReturn;\r\n}","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./src/$$_lazy_route_resource lazy recursive\";","export default class Icon {\r\n    name: string;\r\n    onClickVar: () => void;\r\n    isActive: () => boolean;\r\n    constructor(name, onClick, isActive) {\r\n      this.name = name;\r\n      this.onClickVar = onClick;\r\n      this.isActive = isActive;\r\n      this.onClick = this.onClick.bind(this);\r\n    }\r\n\r\n    onClick(e: MouseEvent) {\r\n      e.stopPropagation();\r\n      // Don't allow click event when inactive.\r\n      if (this.isActive && !this.isActive()) {\r\n        return;\r\n      }\r\n      this.onClickVar();\r\n    }\r\n}\r\n","module.exports = \"#main-column {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    flex-wrap: nowrap;\\r\\n    max-height: 100vh;\\r\\n    position: relative;\\r\\n    z-index: 1;\\r\\n}\\r\\n\\r\\n#middle-row {\\r\\n    display: flex;\\r\\n    flex-direction: row;\\r\\n    flex-wrap: nowrap;\\r\\n    flex-grow: 1;\\r\\n}\\r\\n\\r\\n#background {\\r\\n    position: fixed;\\r\\n    top: 0px;\\r\\n    left: 0px;\\r\\n    bottom: 0px;\\r\\n    right: 0px;\\r\\n    background-color: rgba(255, 255, 255, 0.25);\\r\\n}\\r\\n\\r\\n#modal-inner {\\r\\n    left: 50%;\\r\\n    top: 50%;\\r\\n    -webkit-transform: translate(-50%, -50%);\\r\\n            transform: translate(-50%, -50%);\\r\\n    position: fixed;\\r\\n    background-color: #111;\\r\\n    width: 400px;\\r\\n    max-height: 100vh;\\r\\n    padding: 10px;\\r\\n    overflow-y: auto;\\r\\n    color: rgba(255, 255, 255, 0.9);\\r\\n}\\r\\n\\r\\n#error {\\r\\n    position: fixed;\\r\\n    z-index: 2;\\r\\n    padding: 10px;\\r\\n    bottom: 30px;\\r\\n    right: 30px;\\r\\n    background-color: black;\\r\\n    color: #EF5350;\\r\\n    border-radius: 5px;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    border: 1px solid rgba(255, 255, 255, 0.3);\\r\\n}\\r\\n\\r\\n#error .material-icons {\\r\\n    padding: 5px;\\r\\n    cursor: pointer;\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvYXBwLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxhQUFhO0lBQ2Isc0JBQXNCO0lBQ3RCLGlCQUFpQjtJQUNqQixpQkFBaUI7SUFDakIsa0JBQWtCO0lBQ2xCLFVBQVU7QUFDZDs7QUFFQTtJQUNJLGFBQWE7SUFDYixtQkFBbUI7SUFDbkIsaUJBQWlCO0lBQ2pCLFlBQVk7QUFDaEI7O0FBRUE7SUFDSSxlQUFlO0lBQ2YsUUFBUTtJQUNSLFNBQVM7SUFDVCxXQUFXO0lBQ1gsVUFBVTtJQUNWLDJDQUEyQztBQUMvQzs7QUFFQTtJQUNJLFNBQVM7SUFDVCxRQUFRO0lBQ1Isd0NBQWdDO1lBQWhDLGdDQUFnQztJQUNoQyxlQUFlO0lBQ2Ysc0JBQXNCO0lBQ3RCLFlBQVk7SUFDWixpQkFBaUI7SUFDakIsYUFBYTtJQUNiLGdCQUFnQjtJQUNoQiwrQkFBK0I7QUFDbkM7O0FBRUE7SUFDSSxlQUFlO0lBQ2YsVUFBVTtJQUNWLGFBQWE7SUFDYixZQUFZO0lBQ1osV0FBVztJQUNYLHVCQUF1QjtJQUN2QixjQUFjO0lBQ2Qsa0JBQWtCO0lBQ2xCLGFBQWE7SUFDYixtQkFBbUI7SUFDbkIsMENBQTBDO0FBQzlDOztBQUVBO0lBQ0ksWUFBWTtJQUNaLGVBQWU7QUFDbkIiLCJmaWxlIjoic3JjL2FwcC9hcHAuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIiNtYWluLWNvbHVtbiB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgIGZsZXgtd3JhcDogbm93cmFwO1xyXG4gICAgbWF4LWhlaWdodDogMTAwdmg7XHJcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XHJcbiAgICB6LWluZGV4OiAxO1xyXG59XHJcblxyXG4jbWlkZGxlLXJvdyB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZmxleC1kaXJlY3Rpb246IHJvdztcclxuICAgIGZsZXgtd3JhcDogbm93cmFwO1xyXG4gICAgZmxleC1ncm93OiAxO1xyXG59XHJcblxyXG4jYmFja2dyb3VuZCB7XHJcbiAgICBwb3NpdGlvbjogZml4ZWQ7XHJcbiAgICB0b3A6IDBweDtcclxuICAgIGxlZnQ6IDBweDtcclxuICAgIGJvdHRvbTogMHB4O1xyXG4gICAgcmlnaHQ6IDBweDtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yNSk7XHJcbn1cclxuXHJcbiNtb2RhbC1pbm5lciB7XHJcbiAgICBsZWZ0OiA1MCU7XHJcbiAgICB0b3A6IDUwJTtcclxuICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpO1xyXG4gICAgcG9zaXRpb246IGZpeGVkO1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzExMTtcclxuICAgIHdpZHRoOiA0MDBweDtcclxuICAgIG1heC1oZWlnaHQ6IDEwMHZoO1xyXG4gICAgcGFkZGluZzogMTBweDtcclxuICAgIG92ZXJmbG93LXk6IGF1dG87XHJcbiAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjkpO1xyXG59XHJcblxyXG4jZXJyb3Ige1xyXG4gICAgcG9zaXRpb246IGZpeGVkO1xyXG4gICAgei1pbmRleDogMjtcclxuICAgIHBhZGRpbmc6IDEwcHg7XHJcbiAgICBib3R0b206IDMwcHg7XHJcbiAgICByaWdodDogMzBweDtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IGJsYWNrO1xyXG4gICAgY29sb3I6ICNFRjUzNTA7XHJcbiAgICBib3JkZXItcmFkaXVzOiA1cHg7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4zKTtcclxufVxyXG5cclxuI2Vycm9yIC5tYXRlcmlhbC1pY29ucyB7XHJcbiAgICBwYWRkaW5nOiA1cHg7XHJcbiAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbn0iXX0= */\"","module.exports = \"<div    id=\\\"main-column\\\" \\r\\n        (dragenter)=\\\"$event.preventDefault()\\\"\\r\\n        (dragover)=\\\"$event.preventDefault(); redraw();\\\"\\r\\n        (drop)=\\\"stopDrag($event)\\\"\\r\\n        (click)=\\\"deselect();\\\">\\r\\n    <app-tool-bar [leftIcons]=\\\"getLeftIcons()\\\" [rightIcons]=\\\"getRightIcons()\\\"></app-tool-bar>\\r\\n    <div id=\\\"middle-row\\\">\\r\\n        <app-central-area style=\\\"flex-grow: 1; height: calc(100vh - 156px);\\\"></app-central-area>\\r\\n        <app-content-pane style=\\\"height: calc(100vh - 156px)\\\"></app-content-pane>\\r\\n    </div>\\r\\n    <app-steps></app-steps>\\r\\n    <div    id=\\\"background\\\" \\r\\n            *ngIf=\\\"displayingModal\\\"\\r\\n            (mousedown)=\\\"modal.remove();\\\">\\r\\n        <div id=\\\"modal-inner\\\" (mousedown)=\\\"$event.stopPropagation();\\\" (click)=\\\"$event.stopPropagation();\\\">\\r\\n            <ng-template appModalHost></ng-template>\\r\\n        </div>\\r\\n    </div>\\r\\n    <div id=\\\"error\\\" *ngIf=\\\"error.active\\\">\\r\\n        {{ error.text }}\\r\\n        <span class=\\\"material-icons\\\" (click)=\\\"error.active = false;\\\">clear</span>\\r\\n    </div>\\r\\n</div>\"","import { Component, ViewChild, ChangeDetectorRef, OnInit } from '@angular/core';\r\nimport Icon from './Icon';\r\nimport { UndoRedoService } from './undo-redo.service';\r\nimport { CentralAreaComponent } from './central-area/central-area.component';\r\nimport { ContentSelectionService } from './content-selection.service';\r\nimport { ContentPaneComponent } from './content-pane/content-pane.component';\r\nimport { ModalDirective } from './modal.directive';\r\nimport { ModalService } from './modal.service';\r\nimport { ColorPickerComponent } from './color-picker/color-picker.component';\r\nimport { LoadComponent } from './load/load.component';\r\nimport { SaveComponent } from './save/save.component';\r\nimport { PreviewComponent } from './preview/preview.component';\r\nimport { addStyleSheet } from '@shared/main/helpers';\r\nimport { SubSuperAlignmentComponent } from './sub-super-alignment/sub-super-alignment.component';\r\nimport { ErrorService } from './error.service';\r\nimport { FontSettingsComponent } from './font-settings/font-settings.component';\r\nimport { ProjectOptionsComponent } from './project-options/project-options.component';\r\nimport { QuizConfigurationComponent } from './quiz-configuration/quiz-configuration.component';\r\nimport { TableAddComponent } from './table-add/table-add.component';\r\nimport EqContent from '@shared/layout/EqContent';\r\nimport { colors } from '@shared/main/consts';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.css']\r\n})\r\nexport class AppComponent implements OnInit {\r\n\r\n  defaultLeftIcons: Icon[];\r\n  defaultRightIcons: Icon[];\r\n\r\n  selectedLeftIcons: Icon[];\r\n  selectedRightIcons: Icon[];\r\n\r\n  subSuperAlignIcon: Icon;\r\n  quizConfigIcon: Icon;\r\n  tableIcons: Icon[];\r\n\r\n  @ViewChild(CentralAreaComponent)\r\n  centre: CentralAreaComponent;\r\n\r\n  @ViewChild(ContentPaneComponent)\r\n  content: ContentPaneComponent;\r\n\r\n  private modalHostVar: ModalDirective;\r\n  displayingModal = false;\r\n  // Function called when the modal is shown,\r\n  // passed a directive with a ViewContainerRef\r\n  // of the inner modal container.\r\n  // once set, only called once.\r\n  onModalShow: (modalHost: ModalDirective) => void;\r\n\r\n  constructor(private undoRedo: UndoRedoService,\r\n              private selection: ContentSelectionService,\r\n              private modal: ModalService,\r\n              public cd: ChangeDetectorRef,\r\n              private error: ErrorService) {\r\n    this.undo = this.undo.bind(this);\r\n    this.redo = this.redo.bind(this);\r\n    this.load = this.load.bind(this);\r\n    this.save = this.save.bind(this);\r\n    this.play = this.play.bind(this);\r\n    this.deselect = this.deselect.bind(this);\r\n    this.changeFont = this.changeFont.bind(this);\r\n    this.openProjectOptions = this.openProjectOptions.bind(this);\r\n    this.modal.appComponent = this;\r\n    this.defaultLeftIcons = [];\r\n    this.defaultRightIcons = [\r\n      new Icon('save', this.save, () => true),\r\n      new Icon('get_app', this.load, () => true),\r\n      new Icon('play_arrow', this.play, () => true),\r\n      new Icon('undo', this.undo, this.undoRedo.canUndo),\r\n      new Icon('redo', this.redo, this.undoRedo.canRedo),\r\n      new Icon('font_download', this.changeFont, () => true),\r\n      new Icon('build', this.openProjectOptions, () => true)\r\n    ];\r\n    this.selectedLeftIcons = [\r\n      new Icon('clear', this.deselect, () => true)\r\n    ];\r\n    this.selectedRightIcons = [\r\n      new Icon('delete', () => {\r\n        this.selection.canvasInstance.delete();\r\n      }, () => this.selection.canvasInstance.canDelete()),\r\n      new Icon('palette', () => {\r\n        this.modal.show(ColorPickerComponent);\r\n      }, () => true)\r\n    ];\r\n    this.subSuperAlignIcon = new Icon('vertical_align_top', () => {\r\n      this.modal.show(SubSuperAlignmentComponent);\r\n    }, () => true);\r\n    this.quizConfigIcon = new Icon('star_half', () => {\r\n      this.modal.show(QuizConfigurationComponent);\r\n    }, () => true);\r\n    this.tableIcons = [\r\n      new Icon('add', () => {\r\n        this.modal.show(TableAddComponent);\r\n      }, () => true),\r\n      new Icon('border_outer', () => {\r\n        this.selection.canvasInstance.tableAddOuterBorder();\r\n      }, () => true),\r\n      new Icon('border_inner', () => {\r\n        this.selection.canvasInstance.tableAddInnerBorder();\r\n      }, () => true)\r\n    ];\r\n    this.undoRedo.publishChange(this.getDefaultInitialState());\r\n    addStyleSheet();\r\n  }\r\n\r\n  @ViewChild(ModalDirective)\r\n  set modalHost(newModalHost: ModalDirective) {\r\n    this.modalHostVar = newModalHost;\r\n    if (this.onModalShow) {\r\n      this.onModalShow(this.modalHostVar);\r\n    }\r\n    this.onModalShow = undefined;\r\n  }\r\n\r\n  get modalHost() {\r\n    return this.modalHostVar;\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    EqContent.colors = colors;\r\n  }\r\n\r\n  /**\r\n   * Get the state displayed when the creator\r\n   * is first loaded.\r\n   */\r\n  private getDefaultInitialState(): any {\r\n    return {\r\n      steps: [{\r\n        root: {\r\n          type: 'vbox',\r\n          children: []\r\n        }\r\n      }],\r\n      terms: []\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Get the icons to be displayed on the\r\n   * left based on the current state.\r\n   */\r\n  getLeftIcons() {\r\n    if (this.selection.selectedOnCanvas) {\r\n      return this.selectedLeftIcons;\r\n    } else {\r\n      return this.defaultLeftIcons;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the icons to be displayed on the\r\n   * right based on the current state.\r\n   */\r\n  getRightIcons() {\r\n    if (this.selection.selectedOnCanvas) {\r\n      if (this.selection.selectedOnCanvas === 'c4') {\r\n        // A subsuper is selected, offer option to change alignment.\r\n        return this.selectedRightIcons.concat([this.subSuperAlignIcon]);\r\n      } else if (this.selection.selectedOnCanvas === 'c5') {\r\n        // Quiz selected, offer option to change config\r\n        return this.selectedRightIcons.concat([this.quizConfigIcon]);\r\n      } else if (this.selection.selectedOnCanvas === 'c6') {\r\n        // Table selected, offer table options\r\n        return this.selectedRightIcons.concat(this.tableIcons);\r\n      } else {\r\n        return this.selectedRightIcons;\r\n      }\r\n    } else {\r\n      return this.defaultRightIcons;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Redraw the canvas.\r\n   */\r\n  redraw() {\r\n    this.centre.controller.redraw();\r\n  }\r\n\r\n  /**\r\n   * When a component is dropped not on the\r\n   * canvas, stop the adding behavior.\r\n   * @param e The drag event.\r\n   */\r\n  stopDrag(e: DragEvent) {\r\n    e.preventDefault();\r\n    this.selection.adding = undefined;\r\n    this.content.dragging = false;\r\n  }\r\n\r\n  /**\r\n   * Deselect anything on the content pane\r\n   * and canvas.\r\n   */\r\n  deselect() {\r\n    this.selection.adding = undefined;\r\n    this.selection.selectedOnCanvas = undefined;\r\n  }\r\n\r\n  /**\r\n   * Roll back to the last state.\r\n   */\r\n  undo() {\r\n    this.deselect();\r\n    this.undoRedo.undo();\r\n  }\r\n\r\n  /**\r\n   * Undo the last undo.\r\n   */\r\n  redo() {\r\n    this.deselect();\r\n    this.undoRedo.redo();\r\n  }\r\n\r\n  /**\r\n   * Save the current state to a file.\r\n   */\r\n  save() {\r\n    this.modal.show(SaveComponent);\r\n  }\r\n\r\n  /**\r\n   * Load from a file.\r\n   */\r\n  load() {\r\n    this.modal.show(LoadComponent);\r\n  }\r\n\r\n  /**\r\n   * Play the current state.\r\n   */\r\n  play() {\r\n    this.modal.show(PreviewComponent);\r\n  }\r\n\r\n  /**\r\n   * Change the current font.\r\n   */\r\n  changeFont() {\r\n    this.modal.show(FontSettingsComponent);\r\n  }\r\n\r\n  /**\r\n   * Show the project config dialog.\r\n   */\r\n  openProjectOptions() {\r\n    this.modal.show(ProjectOptionsComponent);\r\n  }\r\n}\r\n","import { BrowserModule } from '@angular/platform-browser';\r\nimport { NgModule } from '@angular/core';\r\n\r\nimport { AppComponent } from './app.component';\r\nimport { ToolBarComponent } from './tool-bar/tool-bar.component';\r\nimport { ContentPaneComponent } from './content-pane/content-pane.component';\r\nimport { CentralAreaComponent } from './central-area/central-area.component';\r\nimport { StepsComponent } from './steps/steps.component';\r\nimport { ModalDirective } from './modal.directive';\r\nimport { ColorPickerComponent } from './color-picker/color-picker.component';\r\nimport { LoadComponent } from './load/load.component';\r\nimport { SaveComponent } from './save/save.component';\r\nimport { PreviewComponent } from './preview/preview.component';\r\nimport { StepTextComponent } from './step-text/step-text.component';\r\nimport { TextEditorComponent } from './text-editor/text-editor.component';\r\nimport { SubSuperAlignmentComponent } from './sub-super-alignment/sub-super-alignment.component';\r\nimport { FormsModule } from '@angular/forms';\r\nimport {  StepOptionsComponent,\r\n          CloneContainerDirective,\r\n          MergeContainerDirective,\r\n          EvalContainerDirective } from './step-options/step-options.component';\r\nimport { TermTemplateComponent } from './term-template/term-template.component';\r\nimport { FontSettingsComponent } from './font-settings/font-settings.component';\r\nimport { CustomFontLoadFailComponent } from './custom-font-load-fail/custom-font-load-fail.component';\r\nimport { ProjectOptionsComponent } from './project-options/project-options.component';\r\nimport { QuizConfigurationComponent } from './quiz-configuration/quiz-configuration.component';\r\nimport { TableAddComponent } from './table-add/table-add.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AppComponent,\r\n    ToolBarComponent,\r\n    ContentPaneComponent,\r\n    CentralAreaComponent,\r\n    StepsComponent,\r\n    ModalDirective,\r\n    ColorPickerComponent,\r\n    LoadComponent,\r\n    SaveComponent,\r\n    PreviewComponent,\r\n    StepTextComponent,\r\n    TextEditorComponent,\r\n    SubSuperAlignmentComponent,\r\n    StepOptionsComponent,\r\n    CloneContainerDirective,\r\n    MergeContainerDirective,\r\n    EvalContainerDirective,\r\n    TermTemplateComponent,\r\n    FontSettingsComponent,\r\n    CustomFontLoadFailComponent,\r\n    ProjectOptionsComponent,\r\n    QuizConfigurationComponent,\r\n    TableAddComponent\r\n  ],\r\n  imports: [\r\n    BrowserModule,\r\n    FormsModule\r\n  ],\r\n  providers: [],\r\n  bootstrap: [AppComponent],\r\n  entryComponents: [\r\n    ColorPickerComponent,\r\n    LoadComponent,\r\n    SaveComponent,\r\n    PreviewComponent,\r\n    TextEditorComponent,\r\n    SubSuperAlignmentComponent,\r\n    StepOptionsComponent,\r\n    TermTemplateComponent,\r\n    FontSettingsComponent,\r\n    CustomFontLoadFailComponent,\r\n    ProjectOptionsComponent,\r\n    QuizConfigurationComponent,\r\n    TableAddComponent\r\n  ]\r\n})\r\nexport class AppModule { }\r\n","import CanvasController from '@shared/main/CanvasController';\r\nimport EqContainer from '@shared/layout/EqContainer';\r\nimport VBox from '@shared/layout/VBox';\r\nimport HBox from '@shared/layout/HBox';\r\nimport TightHBox from '@shared/layout/TightHBox';\r\nimport SubSuper from '@shared/layout/SubSuper';\r\nimport EqComponent from '@shared/layout/EqComponent';\r\nimport LayoutState from '@shared/animation/LayoutState';\r\nimport EqContent from '@shared/layout/EqContent';\r\nimport { deepClone, inLayout } from '../helpers';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport { ContentSelectionService } from '../content-selection.service';\r\nimport { SelectedStepService } from '../selected-step.service';\r\nimport { ErrorService } from '../error.service';\r\nimport RootContainer from '@shared/layout/RootContainer';\r\nimport Radical from '@shared/layout/Radical';\r\nimport { ContainerFormat, FileFormat } from '@shared/main/FileFormat';\r\nimport CreatorContainer from './CreatorContainer';\r\nimport CreatorRootContainer from './CreatorRootContainer';\r\nimport Quiz from '@shared/layout/Quiz';\r\nimport CreatorTable from './CreatorTable';\r\nimport TableContainer from '@shared/layout/TableContainer';\r\nimport { normalOpacity } from '@shared/main/consts';\r\nimport CreatorComponentModel from './CreatorComponentModel';\r\n// Imports that need to be included but aren't used directly\r\nimport './CreatorHBox';\r\nimport './CreatorQuiz';\r\nimport './CreatorRootContainer';\r\nimport './CreatorSubSuper';\r\nimport './CreatorTable';\r\nimport './CreatorTightHBox';\r\nimport './CreatorVBox';\r\nimport '@shared/layout/VCenterVBox';\r\nimport CreatorTightHBox from './CreatorTightHBox';\r\n\r\nexport default class CreatorCanvasController extends CanvasController {\r\n\r\n    private originalInstructions: FileFormat;\r\n\r\n    private rootContainer: EqContainer<any> & CreatorContainer;\r\n\r\n    private undoRedo: UndoRedoService;\r\n    private selection: ContentSelectionService;\r\n    private step: SelectedStepService;\r\n    private error: ErrorService;\r\n\r\n    protected components: CreatorComponentModel;\r\n\r\n    private selectedLayout: LayoutState;\r\n\r\n    constructor(container: HTMLElement, instructions, undoRedo, selection, step: SelectedStepService, error: ErrorService) {\r\n        super(container, instructions);\r\n        // Remove autoplay overlay if present\r\n        if (this.isAutoplay) {\r\n            container.removeChild(container.children[container.childElementCount - 1]);\r\n        }\r\n        this.fixedHeights = undefined;\r\n        // Remove lower area if present\r\n        if (container.childElementCount >= 2) {\r\n            container.removeChild(container.children[container.childElementCount - 1]);\r\n        }\r\n        this.undoRedo = undoRedo;\r\n        this.selection = selection;\r\n        this.step = step;\r\n        this.error = error;\r\n        this.redraw = this.redraw.bind(this);\r\n        this.delete = this.delete.bind(this);\r\n        this.selection.addSelectedOnCanvasListener(() => {\r\n            if (this.selection.selectedOnCanvas === undefined) {\r\n                this.selectedLayout = undefined;\r\n            }\r\n            this.redraw();\r\n        });\r\n        this.selection.canvasInstance = this;\r\n        this.currStep = step.selected;\r\n        // Second recalc after super constructor) needed because step is only updated here\r\n        this.recalc();\r\n        // Don't allow going to next step\r\n        this.canvas.removeEventListener('click', this.handleMouseClick as () => void);\r\n        this.canvas.removeEventListener('mousemove', this.handleMouseMove);\r\n        this.originalInstructions = instructions;\r\n        // Whether dragging or clicking, mouse up could mean add\r\n        this.onMoveOver = this.onMoveOver.bind(this);\r\n        this.onMouseUp = this.onMouseUp.bind(this);\r\n        this.canvas.addEventListener('click', this.onMouseUp);\r\n        this.canvas.addEventListener('drop', (e) => {\r\n            this.onMouseUp(e);\r\n            e.preventDefault();\r\n        });\r\n        this.canvas.addEventListener('dragover', this.onMoveOver);\r\n        this.canvas.addEventListener('dragenter', (e) => {\r\n            e.preventDefault();\r\n        });\r\n        this.canvas.setAttribute('droppable', 'true');\r\n    }\r\n\r\n    protected initComponents(instructions: FileFormat) {\r\n        this.components = new CreatorComponentModel(instructions);\r\n        this.components.setGenInfo('customColors', this.customColors);\r\n        this.components.setGenInfo('fixedHeights', this.fixedHeights);\r\n    }\r\n\r\n    /**\r\n     * Add an outer border to the currently selected\r\n     * table.\r\n     */\r\n    tableAddOuterBorder() {\r\n        const table = this.getSelectedLayout().component as CreatorTable;\r\n        const vLines = table.getVLines();\r\n        const hLines = table.getHLines();\r\n        const children = table.getChildren();\r\n        // Add left border, if none\r\n        if (!vLines[0]) {\r\n            vLines[0] = this.components.addVDivider();\r\n        }\r\n        // Add right border, if none\r\n        if (!vLines[children[0].length]) {\r\n            vLines[children[0].length] = this.components.addVDivider();\r\n        }\r\n        // Add top border, if none\r\n        if (!hLines[0]) {\r\n            hLines[0] = this.components.addHDivider();\r\n        }\r\n        // Add bottom border, if none\r\n        if (!hLines[children.length]) {\r\n            hLines[children.length] = this.components.addHDivider();\r\n        }\r\n        // Save changes\r\n        this.save();\r\n    }\r\n\r\n    /**\r\n     * Add inner borders to the currently selected\r\n     * table.\r\n     */\r\n    tableAddInnerBorder() {\r\n        const table = this.getSelectedLayout().component as CreatorTable;\r\n        const vLines = table.getVLines();\r\n        const hLines = table.getHLines();\r\n        const children = table.getChildren();\r\n\r\n        // Add each missing horizontal border\r\n        for (let r = 1; r < children.length; r++) {\r\n            if (!hLines[r]) {\r\n                hLines[r] = this.components.addHDivider();\r\n            }\r\n        }\r\n\r\n        // Add each missing vertical border\r\n        for (let c = 1; c < children[0].length; c++) {\r\n            if (!vLines[c]) {\r\n                vLines[c] = this.components.addVDivider();\r\n            }\r\n        }\r\n\r\n        this.save();\r\n    }\r\n\r\n    /**\r\n     * Fires when mouse moved over canvas.\r\n     * @param e The mouse event.\r\n     */\r\n    private onMoveOver(e: MouseEvent) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        if (this.selection.adding) {\r\n            this.previewAdd(e.offsetX, e.offsetY);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Fires when mouse is released over the canvas.\r\n     * @param e The mouse event.\r\n     */\r\n    private onMouseUp(e: MouseEvent) {\r\n        if (this.selection.adding) {\r\n            this.finalizeAdd(e.offsetX, e.offsetY);\r\n        } else {\r\n            e.stopPropagation();\r\n            this.select(e.offsetX, e.offsetY);\r\n        }\r\n    }\r\n\r\n    redraw() {\r\n        super.redraw();\r\n        this.currStates.forEach(l => {\r\n            if (l.component instanceof EqContainer) {\r\n                (l.component as unknown as CreatorContainer).creatorDraw(l, this.ctx);\r\n            }\r\n            if (this.selection) {\r\n                if (l.component instanceof EqContent &&\r\n                    l.component.getRef() === this.selection.adding) {\r\n                    // Highlight what's selected on the content pane.\r\n                    this.ctx.save();\r\n                    this.ctx.strokeStyle = '#2196F3';\r\n                    this.ctx.rect(l.tlx, l.tly, l.width, l.height);\r\n                    this.ctx.stroke();\r\n                    this.ctx.restore();\r\n                } else if (l === this.selectedLayout) {\r\n                    this.ctx.save();\r\n                    this.ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';\r\n                    this.ctx.fillRect(l.tlx, l.tly, l.width, l.height);\r\n                    this.ctx.restore();\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Recalculates and redraws the current step.\r\n     * Override to store the root layout for later.\r\n     */\r\n    protected recalc() {\r\n        // Whenever we recalc, the selection becomes invalid as we have new\r\n        // layout states.\r\n        if (this.selection) {\r\n            this.selection.selectedOnCanvas = undefined;\r\n            this.selectedLayout = undefined;\r\n        }\r\n        let rootLayout;\r\n        [this.currStates, rootLayout] = this.calcLayout(this.currStep, true);\r\n        this.rootContainer = rootLayout.component;\r\n        const [width, height] = this.getSize(rootLayout);\r\n        this.setSize(width, height);\r\n        this.redraw();\r\n    }\r\n\r\n    /**\r\n     * Add something at (x, y) and save the new state.\r\n     * @param x X-ordinate of mouse\r\n     * @param y Y-ordinate of mouse\r\n     */\r\n    private finalizeAdd(x: number, y: number) {\r\n        const newLayout = this.getChangedLayout(x, y, true);\r\n        this.undoRedo.publishChange(newLayout);\r\n        this.selection.adding = undefined;\r\n    }\r\n\r\n    /**\r\n     * Add something at (x, y), but show a preview without saving the state.\r\n     * @param x X-ordinate of mouse.\r\n     * @param y Y-ordinate of mouse.\r\n     */\r\n    private previewAdd(x: number, y: number) {\r\n        const newLayout: any = this.getChangedLayout(x, y, false);\r\n        const realSteps = this.steps;\r\n        this.steps = newLayout.steps;\r\n        super.recalc(true);\r\n        this.steps = realSteps;\r\n        let newRootState;\r\n        [this.currStates, newRootState] = this.calcLayout(this.currStep, true);\r\n        this.rootContainer = newRootState.component;\r\n    }\r\n\r\n    /**\r\n     * Get the new layout resulting from adding something at (x, y)\r\n     * @param x The x-ordinate of the mouse.\r\n     * @param y The y-ordinate of the mouse.\r\n     * @param final Whether this is a final add. If it is, errors are shown\r\n     *              and some content may be automatically added.\r\n     */\r\n    private getChangedLayout(x: number, y: number, final: boolean): FileFormat {\r\n        let modifyWith = (instructions: object) => {};\r\n        // Check if the content is already on the canvas\r\n        if (this.onCanvas()) {\r\n            if (final) {\r\n                this.error.text = 'Duplicate content not allowed in a step.';\r\n            }\r\n            return this.getLayoutForPublish(modifyWith);\r\n        }\r\n        const clickedLayout: LayoutState = this.getClickedLayout(x, y);\r\n        if (clickedLayout === undefined) {\r\n            // Didn't click on anything\r\n            return this.getLayoutForPublish(modifyWith);\r\n        } else if (clickedLayout.component instanceof EqContent) {\r\n            try {\r\n                // Add adjacent to content\r\n                const container: EqContainer<any> = clickedLayout.layoutParent.component as EqContainer<any>;\r\n                const toAdd = this.getAddComponent();\r\n                (container as unknown as CreatorContainer).addClickOnChild(clickedLayout, x, y, toAdd);\r\n                if (final) {\r\n                    modifyWith = this.autoAddContent(toAdd);\r\n                }\r\n            } catch (e) {\r\n                if (final) {\r\n                    this.error.text = e.message;\r\n                }\r\n            }\r\n        } else if (clickedLayout.component instanceof EqContainer) {\r\n            try {\r\n                const toAdd = this.getAddComponent();\r\n                (clickedLayout.component as unknown as CreatorContainer).addClick(clickedLayout, x, y, toAdd);\r\n                if (final) {\r\n                    modifyWith = this.autoAddContent(toAdd);\r\n                }\r\n            } catch (e) {\r\n                console.error(e);\r\n                if (final) {\r\n                    this.error.text = e.message;\r\n                }\r\n            }\r\n        } else {\r\n            return this.getLayoutForPublish(modifyWith);\r\n        }\r\n        return this.getLayoutForPublish(modifyWith);\r\n    }\r\n\r\n    /**\r\n     * Get the current layout in the format\r\n     * that can be published.\r\n     * @param modifyWith A function to modify the instructions with after the step has been changed.\r\n     */\r\n    private getLayoutForPublish(modifyWith: (instructions: object) => void): FileFormat {\r\n        const newStepLayout = this.rootContainer.toStepLayout(this);\r\n        const origInstructionsClone: any = deepClone(this.originalInstructions);\r\n        origInstructionsClone.steps[this.currStep].root = newStepLayout;\r\n        modifyWith(origInstructionsClone);\r\n        return origInstructionsClone;\r\n    }\r\n\r\n    /**\r\n     * When a final add happens, automatically\r\n     * add content to what was added if appropriate.\r\n     * Returns a function that will be passed the\r\n     * instructions object after the add. This can\r\n     * be used to add the content.\r\n     * @param addTo The component being added.\r\n     */\r\n    private autoAddContent(addTo: EqComponent<any>): (instructions: object) => void {\r\n        if (addTo instanceof RootContainer) {\r\n            // Add a radical automatically.\r\n            // Look for a radical not used on the\r\n            // current step, next step, or previous\r\n            // step.\r\n            const currState: any = this.undoRedo.getState();\r\n            const currStep = currState.steps[this.step.selected];\r\n            const nextStep = currState.steps[this.step.selected + 1];\r\n            const prevStep = currState.steps[this.step.selected - 1];\r\n            let unusedRef;\r\n            for (let i = 0; i < currState.radicals; i++) {\r\n                const ref = 'r' + i;\r\n                const inCurr = currStep && inLayout(currStep.root, ref);\r\n                const inNext = nextStep && inLayout(nextStep.root, ref);\r\n                const inPrev = prevStep && inLayout(prevStep.root, ref);\r\n                if (!(inCurr || inNext || inPrev)) {\r\n                    // Found an unused ref\r\n                    unusedRef = ref;\r\n                    break;\r\n                }\r\n            }\r\n            if (unusedRef) {\r\n                // Use a previously created radical, no need to add one in instructions.\r\n                (addTo as unknown as CreatorRootContainer).setRadical(this.components.getContent(unusedRef) as Radical);\r\n                return () => {};\r\n            } else {\r\n                // No radicals, or all used in adjacent steps.\r\n                const newRef = 'r' + this.components.numRadicals();\r\n                // Dummy radical, but doesn't matter. Contents of the\r\n                // container are serialized then re-created with the\r\n                // modifed instructions.\r\n                const dummyRadForSave = new Radical(newRef);\r\n                (addTo as unknown as CreatorRootContainer).setRadical(dummyRadForSave);\r\n                return (instructions: any) => {\r\n                    if (!instructions.radicals) {\r\n                        instructions.radicals = 0;\r\n                    }\r\n                    instructions.radicals++;\r\n                };\r\n            }\r\n        } else {\r\n            return () => {};\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Given clicked coordinates, find\r\n     * the layout that was clicked. If not\r\n     * found, returns undefined.\r\n     * @param x X-ordinate on the canvas.\r\n     * @param y Y-ordinate on the canvas.\r\n     */\r\n    protected getClickedLayout(x: number, y: number): LayoutState {\r\n        let clicked;\r\n        this.currStates.forEach(currState => {\r\n            if (!clicked && currState.contains(x, y)) {\r\n                clicked = currState;\r\n            }\r\n        });\r\n        return clicked;\r\n    }\r\n\r\n    /**\r\n     * Whether the component to be added\r\n     * is already on the canvas.\r\n     */\r\n    private onCanvas(): boolean {\r\n        // Duplicate containers allowed\r\n        if (this.selection.addingContainer()) {\r\n            return false;\r\n        }\r\n\r\n        return inLayout(this.steps[this.currStep].root, this.selection.adding);\r\n    }\r\n\r\n    /**\r\n     * Select something at (x, y)\r\n     * @param x X-ordinate of mouse.\r\n     * @param y Y-ordinate of mouse.\r\n     */\r\n    private select(x: number, y: number) {\r\n        const selectedLayout = this.getClickedLayout(x, y);\r\n        if (!selectedLayout) {\r\n            return;\r\n        }\r\n        const selectedComponent = selectedLayout.component;\r\n        const select = (ref: string) => {\r\n            this.selectedLayout = selectedLayout;\r\n            this.selection.selectedOnCanvas = ref;\r\n        };\r\n        if (selectedComponent instanceof EqContainer) {\r\n            if (selectedComponent instanceof CreatorTightHBox) {\r\n                select('c2');\r\n            } else if (selectedComponent instanceof HBox) {\r\n                select('c0');\r\n            } else if (selectedComponent instanceof Quiz) {\r\n                select('c5');\r\n            } else if (selectedComponent instanceof VBox) {\r\n                select('c1');\r\n            } else if (selectedComponent instanceof SubSuper) {\r\n                select('c4');\r\n            } else if (selectedComponent instanceof RootContainer) {\r\n                select('c3');\r\n            } else if (selectedComponent instanceof TableContainer) {\r\n                select('c6');\r\n            } else {\r\n                throw new Error('Unrecognized container selected.');\r\n            }\r\n        } else if (selectedComponent instanceof EqContent) {\r\n            select(selectedComponent.getRef());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Delete the currently selected component.\r\n     * @param state The layout state generated by a component.\r\n     */\r\n    delete() {\r\n        const parent = this.selectedLayout.layoutParent.component;\r\n        (parent as unknown as CreatorContainer).delete(this.selectedLayout.component);\r\n        const newLayout = this.getLayoutForPublish(() => {});\r\n        this.undoRedo.publishChange(newLayout);\r\n    }\r\n\r\n    /**\r\n     * Return whether something is selected\r\n     * and it can be deleted.\r\n     */\r\n    canDelete() {\r\n        return  this.selectedLayout &&\r\n                this.selectedLayout.layoutParent &&\r\n                !(this.selectedLayout.layoutParent.component instanceof SubSuper) &&\r\n                !(this.selectedLayout.layoutParent.component instanceof RootContainer && this.selectedLayout.component instanceof HBox);\r\n    }\r\n\r\n    /**\r\n     * Returns the thing to add as a component.\r\n     */\r\n    private getAddComponent(): EqComponent<any> {\r\n        if (this.selection.addingContainer()) {\r\n            // Adding a container\r\n            return this.components.parseContainer(this.selection.getContainer(), 0);\r\n        } else {\r\n            return this.components.getContent(this.selection.adding);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Apply color and opacity to the currently\r\n     * selected component. If content is selected,\r\n     * just applies to that content. If a container\r\n     * is selected, applies to all content contained\r\n     * within it.\r\n     * @param opacity The opacity to apply.\r\n     * @param colorName The name of the color to apply.\r\n     */\r\n    applyColorAndOpacity(opacity: number, colorName: string) {\r\n        const selected = this.selectedLayout.component;\r\n        const newState: any = this.undoRedo.getStateClone();\r\n        const step = newState.steps[this.currStep];\r\n        if (selected instanceof EqContent) {\r\n            this.applyColor(selected, colorName, step);\r\n            this.applyOpacity(selected, opacity, step);\r\n        } else if (selected instanceof EqContainer) {\r\n            (selected as unknown as CreatorContainer).forEachUnder((content) => {\r\n                this.applyColor(content, colorName, step);\r\n                this.applyOpacity(content, opacity, step);\r\n            });\r\n        }\r\n        this.undoRedo.publishChange(newState);\r\n    }\r\n\r\n    /**\r\n     * Applies color to a particular piece of content.\r\n     * @param content The content to apply color to.\r\n     * @param colorName The name of the color.\r\n     * @param stepObj The step object to apply to.\r\n     */\r\n    private applyColor(content: EqContent<any>, colorName: string, stepObj) {\r\n        if (stepObj.color === undefined) {\r\n            stepObj.color = {};\r\n        }\r\n        const ref = content.getRef();\r\n        if (colorName === 'default') {\r\n            // Remove any color already set for this content\r\n            delete stepObj.color[ref];\r\n            if (Object.keys(stepObj.color).length === 0) {\r\n                // Empty colors, delete as well\r\n                delete stepObj.color;\r\n            }\r\n        } else {\r\n            stepObj.color[ref] = colorName;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Applies opacity to a particular piece of content.\r\n     * @param content The content to apply opacity to.\r\n     * @param opacity The opacity to apply.\r\n     * @param stepObj The step object to apply to.\r\n     */\r\n    private applyOpacity(content: EqContent<any>, opacity: number, stepObj) {\r\n        if (stepObj.opacity === undefined) {\r\n            stepObj.opacity = {};\r\n        }\r\n        const ref = content.getRef();\r\n        if (opacity === normalOpacity) {\r\n            // Remove any opacity already set for this content\r\n            delete stepObj.opacity[ref];\r\n            if (Object.keys(stepObj.opacity).length === 0) {\r\n                // Empty opacity, delete as well\r\n                delete stepObj.opacity;\r\n            }\r\n        } else {\r\n            stepObj.opacity[ref] = opacity;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Change the currently showing step.\r\n     * @param newStep The new step to show.\r\n     */\r\n    showStep(newStep: number) {\r\n        this.currStep = newStep;\r\n        this.recalc();\r\n    }\r\n\r\n    /**\r\n     * Return the step layout of the currently\r\n     * selected container.\r\n     */\r\n    getStepLayoutOfSelected(): ContainerFormat {\r\n        const container = this.selectedLayout.component;\r\n        return (container as unknown as CreatorContainer).toStepLayout(this);\r\n    }\r\n\r\n    /**\r\n     * Get the currently selected layout state.\r\n     */\r\n    getSelectedLayout() {\r\n        return this.selectedLayout;\r\n    }\r\n\r\n    /**\r\n     * Create a new state with the changes\r\n     * made to this canvas saved.\r\n     */\r\n    save() {\r\n        const newState = this.undoRedo.getStateClone();\r\n        newState.steps[this.step.selected].root = this.rootContainer.toStepLayout(this);\r\n        newState.hDividers = this.components.numHDividers();\r\n        newState.vDividers = this.components.numVDividers();\r\n        this.undoRedo.publishChange(newState);\r\n    }\r\n}\r\n","import { ComponentModel, containerParsers } from '@shared/main/ComponentModel';\r\nimport { FileFormat, ContainerFormat } from '@shared/main/FileFormat';\r\nimport HDivider from '@shared/layout/HDivider';\r\nimport { creatorHDividerPadding, creatorVDividerPadding, vDividerPadding, hDividerPadding } from '@shared/main/consts';\r\nimport VDivider from '@shared/layout/VDivider';\r\nimport EqContainer from '@shared/layout/EqContainer';\r\n\r\nexport default class CreatorComponentModel extends ComponentModel {\r\n\r\n    constructor(file: FileFormat) {\r\n        super(file);\r\n        const hDividers = this.content.get('h');\r\n        const numHDividers = hDividers.length;\r\n        hDividers.length = 0;\r\n        for (let i = 0; i < numHDividers; i++) {\r\n            hDividers.push(new HDivider(creatorHDividerPadding, 'h' + i));\r\n        }\r\n        const vDividers = this.content.get('v');\r\n        const numVDividers = vDividers.length;\r\n        vDividers.length = 0;\r\n        for (let i = 0; i < numVDividers; i++) {\r\n            vDividers.push(new VDivider(creatorVDividerPadding, 'v' + i));\r\n        }\r\n    }\r\n\r\n    addVDivider(): VDivider {\r\n        const vDividers = this.content.get('v');\r\n        const newDivider = new VDivider(vDividerPadding, 'v' + vDividers.length);\r\n        vDividers.push(newDivider);\r\n        return newDivider;\r\n    }\r\n\r\n    addHDivider(): HDivider {\r\n        const hDividers = this.content.get('h');\r\n        const newDivider = new HDivider(hDividerPadding, 'h' + hDividers.length);\r\n        hDividers.push(newDivider);\r\n        return newDivider;\r\n    }\r\n\r\n    /**\r\n     * Return the amount of radicals there are currently.\r\n     */\r\n    numRadicals(): number {\r\n        return this.content.get('r').length;\r\n    }\r\n\r\n    /**\r\n     * Return the amount of v dividers there are currently.\r\n     */\r\n    numVDividers(): number {\r\n        return this.content.get('v').length;\r\n    }\r\n\r\n    /**\r\n     * Return the amount of h dividers there are currently.\r\n     */\r\n    numHDividers(): number {\r\n        return this.content.get('h').length;\r\n    }\r\n\r\n    /**\r\n     * Parse a container object recursively and return its\r\n     * class representation.\r\n     * Override to prefix the type with 'creator-' to\r\n     * allow customization of behavior.\r\n     * @param containerObj The container object to parse.\r\n     * @param depth The depth in the container hierarchy.\r\n     */\r\n    parseContainer(containerObj: ContainerFormat, depth: number): EqContainer<any> {\r\n        return containerParsers['creator-' + containerObj.type](\r\n            containerObj,\r\n            depth,\r\n            this.getContent,\r\n            this.parseContainer,\r\n            this.genInfo\r\n        );\r\n    }\r\n}\r\n","import LayoutState from '@shared/animation/LayoutState';\r\nimport EqComponent from '@shared/layout/EqComponent';\r\nimport CreatorContainer from './CreatorContainer';\r\nimport { tri } from '@shared/main/helpers';\r\nimport CanvasController from '@shared/main/CanvasController';\r\nimport { ContainerFormat } from '@shared/main/FileFormat';\r\nimport EqContainer from '@shared/layout/EqContainer';\r\nimport EqContent from '@shared/layout/EqContent';\r\nimport { creatorContainerPadding, creatorCaretFillStyleLighter, creatorCaretSize } from '@shared/main/consts';\r\n\r\n/**\r\n * Default methods for those declared in CreatorContainer.\r\n */\r\n\r\nexport function creatorContainerAddClick(clickedLayout: LayoutState, x: number, y: number, toAdd: EqComponent<any>): void {\r\n    const parentLayout = clickedLayout.layoutParent;\r\n    if (!parentLayout) {\r\n        // Can't add, no parent container\r\n        return;\r\n    }\r\n    const container = parentLayout.component as unknown as CreatorContainer;\r\n    if (container.addVertically()) {\r\n        // Add on top or bottom\r\n        if (clickedLayout.onTop(y)) {\r\n            // Add before this\r\n            container.addBefore(toAdd, this);\r\n        } else {\r\n            // Add after this\r\n            container.addAfter(toAdd, this);\r\n        }\r\n    } else if (container.addHorizontally()) {\r\n        // Add on left or right\r\n        if (clickedLayout.onLeft(x)) {\r\n            // Add before this\r\n            container.addBefore(toAdd, this);\r\n        } else {\r\n            // Add after this\r\n            container.addAfter(toAdd, this);\r\n        }\r\n    } else {\r\n        // Can't add inside this type of container\r\n        return;\r\n    }\r\n}\r\n\r\nexport function creatorContainerCreatorDraw(l: LayoutState, ctx: CanvasRenderingContext2D): void {\r\n    const parentLayout = l.layoutParent;\r\n    if (!parentLayout) {\r\n        return;\r\n    }\r\n    const pad = creatorContainerPadding.scale(l.scale);\r\n    const container = parentLayout.component as unknown as CreatorContainer;\r\n    if (container.addVertically()) {\r\n        // Add carets on top and bottom facing outwards\r\n        ctx.save();\r\n        ctx.fillStyle = creatorCaretFillStyleLighter;\r\n\r\n        ctx.save();\r\n        ctx.translate(l.tlx + l.width / 2, l.tly + pad.top / 4);\r\n        ctx.rotate(Math.PI);\r\n        ctx.scale(l.scale, l.scale);\r\n        tri(0, 0, creatorCaretSize, creatorCaretSize, ctx);\r\n        ctx.restore();\r\n\r\n        ctx.save();\r\n        ctx.translate(l.tlx + l.width / 2, l.tly + l.height - pad.bottom / 4);\r\n        ctx.scale(l.scale, l.scale);\r\n        tri(0, 0, creatorCaretSize, creatorCaretSize, ctx);\r\n        ctx.restore();\r\n\r\n        ctx.restore();\r\n\r\n    } else if (container.addHorizontally()) {\r\n        // Add carets on left and right facing outwards\r\n        ctx.save();\r\n        ctx.fillStyle = creatorCaretFillStyleLighter;\r\n\r\n        ctx.save();\r\n        ctx.translate(l.tlx + pad.left / 4, l.tly + l.height / 2);\r\n        ctx.rotate(Math.PI / 2);\r\n        ctx.scale(l.scale, l.scale);\r\n        tri(0, 0, creatorCaretSize, creatorCaretSize, ctx);\r\n        ctx.restore();\r\n\r\n        ctx.save();\r\n        ctx.translate(l.tlx + l.width - pad.right / 4, l.tly + l.height / 2);\r\n        ctx.rotate(-Math.PI / 2);\r\n        ctx.scale(l.scale, l.scale);\r\n        tri(0, 0, creatorCaretSize, creatorCaretSize, ctx);\r\n        ctx.restore();\r\n\r\n        ctx.restore();\r\n    }\r\n}\r\n\r\n/**\r\n * Returns an array of children of a container\r\n * as used in the step layout.\r\n * @param children The children array.\r\n * @param controller The canvas controller possessing this container.\r\n */\r\nexport function childrenToStepLayout(children: EqComponent<any>[], controller: CanvasController): (string | ContainerFormat)[] {\r\n    const toReturn: (string | ContainerFormat)[] = [];\r\n    children.forEach(comp => {\r\n        if (comp instanceof EqContainer) {\r\n            toReturn.push((comp as unknown as CreatorContainer).toStepLayout(controller));\r\n        } else if (comp instanceof EqContent) {\r\n            toReturn.push(comp.getRef());\r\n        } else {\r\n            throw new Error('unrecognized type');\r\n        }\r\n    });\r\n    return toReturn;\r\n}\r\n\r\nexport function linearContainerAddBefore(toAdd: EqComponent<any>, before: EqComponent<any>) {\r\n    this.addValid(toAdd);\r\n    const index = this.children.indexOf(before);\r\n    this.children.splice(index, 0, toAdd);\r\n}\r\n\r\nexport function linearContainerAddAfter(toAdd: EqComponent<any>, after: EqComponent<any>) {\r\n    this.addValid(toAdd);\r\n    const index = this.children.indexOf(after);\r\n    this.children.splice(index + 1, 0, toAdd);\r\n}\r\n\r\nexport function linearContainerForEachUnder(forEach: (content: EqContent<any>) => void) {\r\n    this.children.forEach(child => {\r\n        if (child instanceof EqContent) {\r\n            // Run the function\r\n            forEach(child);\r\n        } else if (child instanceof EqContainer) {\r\n            (child as unknown as CreatorContainer).forEachUnder(forEach);\r\n        } else {\r\n            throw new Error('unrecognized component type');\r\n        }\r\n    });\r\n}\r\n\r\nexport function linearContainerDelete(toDelete: EqComponent<any>) {\r\n    this.children.splice(this.children.indexOf(toDelete), 1);\r\n}\r\n","import HBox from '@shared/layout/HBox';\r\nimport LinearCreatorContainer from './LinearCreatorContainer';\r\nimport LayoutState from '@shared/animation/LayoutState';\r\nimport { line, tri, parseContainerChildren } from '@shared/main/helpers';\r\nimport {\r\n    creatorContainerCreatorDraw,\r\n    creatorContainerAddClick,\r\n    linearContainerAddBefore,\r\n    linearContainerAddAfter,\r\n    childrenToStepLayout,\r\n    linearContainerDelete,\r\n    linearContainerForEachUnder\r\n} from './CreatorContainerMethods';\r\nimport EqComponent from '@shared/layout/EqComponent';\r\nimport HDivider from '@shared/layout/HDivider';\r\nimport Radical from '@shared/layout/Radical';\r\nimport CanvasController from '@shared/main/CanvasController';\r\nimport { LinearContainerFormat } from '@shared/main/FileFormat';\r\nimport { creatorContainerStroke, creatorContainerPadding, creatorCaretFillStyle, creatorCaretSize } from '@shared/main/consts';\r\nimport { Container } from '@shared/main/ComponentModel';\r\n\r\n@Container({\r\n    typeString: 'creator-hbox',\r\n    parse: (containerObj, depth, contentGetter, containerGetter) => {\r\n        // Return HBox from file\r\n        const format = containerObj as LinearContainerFormat;\r\n        return new CreatorHBox(\r\n            parseContainerChildren(format.children, depth, containerGetter, contentGetter),\r\n            creatorContainerPadding);\r\n    }\r\n})\r\nexport default class CreatorHBox extends HBox implements LinearCreatorContainer {\r\n\r\n    delete = linearContainerDelete;\r\n    forEachUnder = linearContainerForEachUnder;\r\n    addBefore = linearContainerAddBefore;\r\n    addAfter = linearContainerAddAfter;\r\n\r\n    addVertically() {\r\n        return false;\r\n    }\r\n\r\n    addHorizontally() {\r\n        return true;\r\n    }\r\n\r\n    creatorDraw(l: LayoutState, ctx: CanvasRenderingContext2D) {\r\n        ctx.save();\r\n        ctx.strokeStyle = creatorContainerStroke;\r\n\r\n        // Outer border\r\n        ctx.beginPath();\r\n        ctx.rect(l.tlx, l.tly, l.width, l.height);\r\n        ctx.stroke();\r\n\r\n        const pad = creatorContainerPadding.scale(l.scale);\r\n\r\n        // Horizontal lines\r\n        const x1 = l.tlx + pad.left / 2;\r\n        const x2 = l.tlx + l.width - pad.right / 2;\r\n        const y1 = l.tly + pad.top / 2;\r\n        const y2 = l.tly + l.height - pad.bottom / 2;\r\n        line(x1, y1, x2, y1, ctx);\r\n        line(x1, y2, x2, y2, ctx);\r\n\r\n        // Carets\r\n        ctx.fillStyle = creatorCaretFillStyle;\r\n\r\n        ctx.save();\r\n        ctx.translate(l.tlx + pad.left * 0.75, l.tly + l.height / 2);\r\n        ctx.rotate(-Math.PI / 2);\r\n        ctx.scale(l.scale, l.scale);\r\n        tri(0, 0, creatorCaretSize, creatorCaretSize, ctx);\r\n        ctx.restore();\r\n\r\n        ctx.save();\r\n        ctx.translate(l.tlx + l.width - pad.right * 0.75, l.tly + l.height / 2);\r\n        ctx.rotate(Math.PI / 2);\r\n        ctx.scale(l.scale, l.scale);\r\n        tri(0, 0, creatorCaretSize, creatorCaretSize, ctx);\r\n        ctx.restore();\r\n\r\n        // Carets that depend on parent\r\n        creatorContainerCreatorDraw.call(this, l, ctx);\r\n\r\n        ctx.restore();\r\n    }\r\n\r\n    addClick(l: LayoutState, x: number, y: number, toAdd: EqComponent<any>) {\r\n        const pad = creatorContainerPadding.scale(l.scale);\r\n        // Make fake layout states to use like rectangles\r\n        const innerLeft = new LayoutState(\r\n            undefined,\r\n            undefined,\r\n            l.tlx + pad.left / 2,\r\n            l.tly + pad.top / 2,\r\n            pad.width() / 4,\r\n            l.height - pad.height() / 2,\r\n            1\r\n        );\r\n        const innerRight = new LayoutState(\r\n            undefined,\r\n            undefined,\r\n            l.tlx + l.width - pad.right,\r\n            l.tly + pad.top / 2,\r\n            pad.width() / 4,\r\n            l.height - pad.height() / 2,\r\n            1\r\n        );\r\n        if (innerLeft.contains(x, y)) {\r\n            // Add at start\r\n            this.addValid(toAdd);\r\n            this.children.unshift(toAdd);\r\n        } else if (innerRight.contains(x, y)) {\r\n            // Add at end\r\n            this.addValid(toAdd);\r\n            this.children.push(toAdd);\r\n        } else {\r\n            creatorContainerAddClick.call(this, l, x, y, toAdd);\r\n        }\r\n    }\r\n\r\n    addClickOnChild(clickedLayout: LayoutState, x: number, y: number, toAdd: EqComponent<any>) {\r\n        this.addValid(toAdd);\r\n        if (clickedLayout.onLeft(x)) {\r\n            // Add left\r\n            this.addBefore(toAdd, clickedLayout.component);\r\n        } else {\r\n            // Add right\r\n            this.addAfter(toAdd, clickedLayout.component);\r\n        }\r\n    }\r\n\r\n    addValid(toAdd: EqComponent<any>) {\r\n        if (toAdd instanceof HDivider) {\r\n            throw new Error('Fraction lines can only be added inside a vertical container.');\r\n        }\r\n        if (toAdd instanceof Radical) {\r\n            throw new Error('Radicals can only be added inside a root container.');\r\n        }\r\n    }\r\n\r\n    toStepLayout(controller: CanvasController): LinearContainerFormat {\r\n        return {\r\n            type: 'hbox',\r\n            children: childrenToStepLayout(this.children, controller)\r\n        };\r\n    }\r\n}\r\n","import Quiz from '@shared/layout/Quiz';\r\nimport LinearCreatorContainer from './LinearCreatorContainer';\r\nimport {\r\n    linearContainerDelete,\r\n    linearContainerForEachUnder,\r\n    linearContainerAddBefore,\r\n    linearContainerAddAfter,\r\n    creatorContainerCreatorDraw,\r\n    creatorContainerAddClick,\r\n    childrenToStepLayout\r\n} from './CreatorContainerMethods';\r\nimport LayoutState from '@shared/animation/LayoutState';\r\nimport { line, tri, parseContainerChildren } from '@shared/main/helpers';\r\nimport EqComponent from '@shared/layout/EqComponent';\r\nimport Radical from '@shared/layout/Radical';\r\nimport CanvasController, { MouseEventCallback } from '@shared/main/CanvasController';\r\nimport { QuizFormat } from '@shared/main/FileFormat';\r\nimport HDivider from '@shared/layout/HDivider';\r\nimport EqContent from '@shared/layout/EqContent';\r\nimport {\r\n    creatorContainerStroke,\r\n    creatorContainerPadding,\r\n    creatorCaretFillStyle,\r\n    creatorCaretSize,\r\n    curvedOutlineDefaultOpacity,\r\n    curvedOutlineColor,\r\n    radioButtonDefaultOpacity,\r\n    radioButtonColor,\r\n    quizCorrectColor,\r\n    quizIncorrectColor\r\n} from '@shared/main/consts';\r\nimport { Container } from '@shared/main/ComponentModel';\r\n\r\n@Container({\r\n    typeString: 'creator-quiz',\r\n    parse: (containerObj, depth, contentGetter, containerGetter) => {\r\n        const format = containerObj as QuizFormat;\r\n        return new CreatorQuiz(\r\n            parseContainerChildren(format.children, depth, containerGetter, contentGetter),\r\n            creatorContainerPadding,\r\n            format.answers,\r\n            curvedOutlineDefaultOpacity,\r\n            curvedOutlineColor,\r\n            radioButtonDefaultOpacity,\r\n            radioButtonColor,\r\n            quizCorrectColor,\r\n            quizIncorrectColor\r\n        );\r\n    }\r\n})\r\nexport default class CreatorQuiz extends Quiz implements LinearCreatorContainer {\r\n\r\n    forEachUnder = linearContainerForEachUnder;\r\n    addBefore = linearContainerAddBefore;\r\n    addAfter = linearContainerAddAfter;\r\n\r\n    saveAnswersAs: boolean[];\r\n\r\n    // Re-override to not account for extra spacing\r\n    protected calcHeight(): number {\r\n        let totalHeight = 0;\r\n        for (const currChild of this.children) {\r\n            totalHeight += currChild.getHeight();\r\n        }\r\n        return totalHeight + this.padding.height();\r\n    }\r\n\r\n    addHorizontally() {\r\n        return false;\r\n    }\r\n\r\n    addVertically() {\r\n        return true;\r\n    }\r\n\r\n    creatorDraw(l: LayoutState, ctx: CanvasRenderingContext2D) {\r\n        ctx.save();\r\n        ctx.strokeStyle = creatorContainerStroke;\r\n\r\n        // Outer border\r\n        ctx.beginPath();\r\n        ctx.rect(l.tlx, l.tly, l.width, l.height);\r\n        ctx.stroke();\r\n\r\n        const pad = creatorContainerPadding.scale(l.scale);\r\n\r\n        // Vertical lines\r\n        const y1 = l.tly + pad.top / 2;\r\n        const y2 = l.tly + l.height - pad.bottom / 2;\r\n        const x1 = l.tlx + pad.left / 2;\r\n        const x2 = l.tlx + l.width - pad.right / 2;\r\n        line(x1, y1, x1, y2, ctx);\r\n        line(x2, y1, x2, y2, ctx);\r\n\r\n        // Carets\r\n        ctx.fillStyle = creatorCaretFillStyle;\r\n\r\n        ctx.save();\r\n        ctx.translate(l.tlx + l.width / 2, l.tly + pad.top * 0.75);\r\n        ctx.scale(l.scale, l.scale);\r\n        tri(0, 0, creatorCaretSize, creatorCaretSize, ctx);\r\n        ctx.restore();\r\n\r\n        ctx.save();\r\n        ctx.translate(l.tlx + l.width / 2, l.tly + l.height - pad.top * 0.75);\r\n        ctx.rotate(Math.PI);\r\n        ctx.scale(l.scale, l.scale);\r\n        tri(0, 0, creatorCaretSize, creatorCaretSize, ctx);\r\n        ctx.restore();\r\n\r\n        // Carets that depend on parent\r\n        creatorContainerCreatorDraw.call(this, l, ctx);\r\n\r\n        ctx.restore();\r\n    }\r\n\r\n    addClick(l: LayoutState, x: number, y: number, toAdd: EqComponent<any>) {\r\n        const realPad = creatorContainerPadding.scale(l.scale);\r\n        // Create mock layout states to use like rectangles\r\n        const innerTop = new LayoutState(\r\n            undefined, undefined,\r\n            l.tlx + realPad.left / 2,\r\n            l.tly + realPad.top / 2,\r\n            l.width - realPad.width() / 2,\r\n            realPad.height() / 4,\r\n            1\r\n        );\r\n        const innerBot = new LayoutState(\r\n            undefined, undefined,\r\n            l.tlx + realPad.left / 2,\r\n            l.tly + l.height - realPad.bottom,\r\n            l.width - realPad.width() / 2,\r\n            realPad.height() / 4,\r\n            1\r\n        );\r\n        if (innerTop.contains(x, y)) {\r\n            // Add at start\r\n            this.addValid(toAdd);\r\n            this.children.unshift(toAdd);\r\n            this.answers = [];\r\n        } else if (innerBot.contains(x, y)) {\r\n            // Add at end\r\n            this.addValid(toAdd);\r\n            this.children.push(toAdd);\r\n            this.answers = [];\r\n        } else {\r\n            // Click wasn't on inner part, add adjacent to parent container.\r\n            creatorContainerAddClick(l, x, y, toAdd);\r\n        }\r\n    }\r\n\r\n    addClickOnChild(clickedLayout: LayoutState, x: number, y: number, toAdd: EqComponent<any>) {\r\n        this.addValid(toAdd);\r\n        if (clickedLayout.onTop(y)) {\r\n            // Add top\r\n            this.addBefore(toAdd, clickedLayout.component);\r\n        } else {\r\n            // Add bottom\r\n            this.addAfter(toAdd, clickedLayout.component);\r\n        }\r\n        // Invalidate answers\r\n        this.answers = [];\r\n    }\r\n\r\n    addValid(toAdd: EqComponent<any>) {\r\n        if (toAdd instanceof Radical) {\r\n            throw new Error('Radicals can only be added inside a root container.');\r\n        }\r\n        if (toAdd instanceof HDivider) {\r\n            throw new Error('Fraction Lines can only be added inside a vertical container.');\r\n        }\r\n    }\r\n\r\n    toStepLayout(controller: CanvasController): QuizFormat {\r\n        // Convert back to saved answer format\r\n        const saveAnswers = [];\r\n        (this.saveAnswersAs ? this.saveAnswersAs : this.answers).forEach((val, index) => {\r\n            if (val) {\r\n                saveAnswers.push(index);\r\n            }\r\n        });\r\n        if (this.saveAnswersAs) {\r\n            this.saveAnswersAs = undefined;\r\n        }\r\n        return {\r\n            type: 'quiz',\r\n            children: childrenToStepLayout(this.children, controller),\r\n            answers: saveAnswers\r\n        };\r\n    }\r\n\r\n    delete(toDelete: EqComponent<any>) {\r\n        // Invalidate answers\r\n        this.answers = [];\r\n        linearContainerDelete.call(this, toDelete);\r\n    }\r\n\r\n    // Override to not add outlines or extra spacing\r\n    addLayout(  parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>,\r\n                tlx: number, tly: number, currScale: number,\r\n                opacityObj: object, colorsObj: object,\r\n                mouseEnter: Map<LayoutState, MouseEventCallback>,\r\n                mouseExit: Map<LayoutState, MouseEventCallback>,\r\n                mouseClick: Map<LayoutState, MouseEventCallback>,\r\n                tempContent: EqContent<any>[]): LayoutState {\r\n\r\n        const state = new LayoutState(parentLayout, this, tlx, tly,\r\n            this.getWidth() * currScale,\r\n            this.getHeight() * currScale,\r\n            currScale);\r\n        const innerWidth = (this.getWidth() - this.padding.width()) * currScale;\r\n        let upToY = tly + this.padding.top * currScale;\r\n\r\n        for (const currChild of this.children) {\r\n            const childWidth = currChild.getWidth() * currScale;\r\n\r\n            // Position child in the middle horizontally\r\n            const childTLX = (innerWidth - childWidth) / 2 + this.padding.left * currScale + tlx;\r\n            const childLayout = currChild.addLayout(\r\n                state, layouts,\r\n                childTLX, upToY, currScale,\r\n                opacityObj, colorsObj,\r\n                mouseEnter, mouseExit, mouseClick,\r\n                tempContent\r\n            );\r\n            upToY += childLayout.height;\r\n        }\r\n\r\n        layouts.set(this, state);\r\n\r\n        return state;\r\n    }\r\n\r\n    /**\r\n     * Save a value of answers the next time\r\n     * toStepLayout is called.\r\n     * @param answers The value to save.\r\n     */\r\n    saveAnswers(answers: boolean[]) {\r\n        this.saveAnswersAs = answers;\r\n    }\r\n}\r\n","import RootContainer from '@shared/layout/RootContainer';\r\nimport CreatorContainer from './CreatorContainer';\r\nimport LayoutState from '@shared/animation/LayoutState';\r\nimport EqComponent from '@shared/layout/EqComponent';\r\nimport Radical from '@shared/layout/Radical';\r\nimport { creatorContainerAddClick, creatorContainerCreatorDraw, childrenToStepLayout } from './CreatorContainerMethods';\r\nimport CanvasController from '@shared/main/CanvasController';\r\nimport { RootContainerFormat } from '@shared/main/FileFormat';\r\nimport EqContent from '@shared/layout/EqContent';\r\nimport { creatorContainerPadding, creatorContainerStroke } from '@shared/main/consts';\r\nimport { Container } from '@shared/main/ComponentModel';\r\nimport CreatorHBox from './CreatorHBox';\r\nimport { parseContainerChildren } from '@shared/main/helpers';\r\n\r\n@Container({\r\n    typeString: 'creator-root',\r\n    parse: (containerObj, depth, contentGetter, containerGetter, genInfo) => {\r\n        const format = containerObj as RootContainerFormat;\r\n        const idx = new CreatorHBox(\r\n            parseContainerChildren(format.idx, depth, containerGetter, contentGetter),\r\n            creatorContainerPadding\r\n        );\r\n        const arg = new CreatorHBox(\r\n            parseContainerChildren(format.arg, depth, containerGetter, contentGetter),\r\n            creatorContainerPadding\r\n        );\r\n        let radical: Radical;\r\n        if (format.rad) {\r\n            radical = contentGetter(format.rad) as Radical;\r\n        }\r\n        return new CreatorRootContainer(idx, arg, radical, creatorContainerPadding, (genInfo as any).termHeights);\r\n    }\r\n})\r\nexport default class CreatorRootContainer extends RootContainer implements CreatorContainer {\r\n    /**\r\n     * When this container is clicked,\r\n     * add a component to it at some\r\n     * position. This default implementation\r\n     * adds the component adjacent to this one\r\n     * in the parent container of this container.\r\n     * @param clickedLayout The layout state (generated by this container) that was clicked.\r\n     * @param x The x-ordinate clicked.\r\n     * @param y The y-ordinate clicked.\r\n     * @param toAdd The component to add.\r\n     */\r\n    addClick(l: LayoutState, x: number, y: number, toAdd: EqComponent<any>) {\r\n        const pad = creatorContainerPadding.scale(l.scale);\r\n        // Make fake layout state to use like rectangles\r\n        const inner = new LayoutState(\r\n            undefined,\r\n            undefined,\r\n            l.tlx + pad.left,\r\n            l.tly + pad.top,\r\n            l.width - pad.width(),\r\n            l.height - pad.height(),\r\n            1\r\n        );\r\n        if (inner.contains(x, y)) {\r\n            if (!(toAdd instanceof Radical)) {\r\n                throw new Error('Only Radicals can be added to a Root Container.');\r\n            }\r\n            this.radical = toAdd;\r\n        } else {\r\n            creatorContainerAddClick.call(this, l, x, y, toAdd);\r\n        }\r\n    }\r\n\r\n    creatorDraw(l: LayoutState, ctx: CanvasRenderingContext2D) {\r\n        ctx.save();\r\n        ctx.strokeStyle = creatorContainerStroke;\r\n\r\n        // Outer border\r\n        ctx.beginPath();\r\n        ctx.rect(l.tlx, l.tly, l.width, l.height);\r\n        ctx.stroke();\r\n\r\n        ctx.restore();\r\n        creatorContainerCreatorDraw.call(this, l, ctx);\r\n    }\r\n\r\n    /**\r\n     * When one of this container's direct\r\n     * children is clicked, add a component\r\n     * adjacent to the clicked child.\r\n     * @param clickedLayout The layout state generated by the child.\r\n     * @param x The x-ordinate clicked.\r\n     * @param y The y-ordinate clicked.\r\n     * @param toAdd The component to add.\r\n     */\r\n    addClickOnChild(clickedLayout: LayoutState, x: number, y: number, toAdd: EqComponent<any>) {\r\n        return;\r\n    }\r\n\r\n    /**\r\n     * Returns an object representing\r\n     * the step layout that would generate\r\n     * this container.\r\n     */\r\n    toStepLayout(controller: CanvasController): RootContainerFormat {\r\n        const toReturn: any = {};\r\n        toReturn.type = 'root';\r\n        toReturn.idx = childrenToStepLayout(this.index.getChildren(), controller);\r\n        toReturn.arg = childrenToStepLayout(this.argument.getChildren(), controller);\r\n        if (this.radical) {\r\n            toReturn.rad = this.radical.getRef();\r\n        }\r\n        return toReturn;\r\n    }\r\n\r\n    /**\r\n     * Delete a child of this container.\r\n     * @param toDelete The child to delete.\r\n     */\r\n    delete(toDelete: EqComponent<any>) {\r\n        if (toDelete === this.radical) {\r\n            this.radical = undefined;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Runs a function for every piece of\r\n     * content under this container.\r\n     * @param forEach The function to run for content.\r\n     */\r\n    forEachUnder(forEach: (content: EqContent<any>) => void) {\r\n        (this.index as unknown as CreatorContainer).forEachUnder(forEach);\r\n        (this.argument as unknown as CreatorContainer).forEachUnder(forEach);\r\n        if (this.radical) {\r\n            forEach(this.radical);\r\n        }\r\n    }\r\n\r\n    setRadical(newRadical: Radical) {\r\n        this.radical = newRadical;\r\n    }\r\n\r\n    /**\r\n     * Whether this container lays out components vertically\r\n     * and more can be added.\r\n     */\r\n    addVertically(): boolean {\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Whether this container lays out components horizontally\r\n     * and more can be added.\r\n     */\r\n    addHorizontally(): boolean {\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Add a child before another.\r\n     * @param toAdd The child to add.\r\n     * @param before Add before this child.\r\n     */\r\n    addBefore(toAdd: EqComponent<any>, before: EqComponent<any>) {\r\n        return;\r\n    }\r\n\r\n    /**\r\n     * Add a child after another.\r\n     * @param toAdd The child to add.\r\n     * @param after Add after this child.\r\n     */\r\n    addAfter(toAdd: EqComponent<any>, after: EqComponent<any>) {\r\n        return;\r\n    }\r\n}\r\n","import SubSuper from '@shared/layout/SubSuper';\r\nimport CreatorContainer from './CreatorContainer';\r\nimport EqComponent from '@shared/layout/EqComponent';\r\nimport LayoutState from '@shared/animation/LayoutState';\r\nimport { creatorContainerCreatorDraw, childrenToStepLayout } from './CreatorContainerMethods';\r\nimport CanvasController from '@shared/main/CanvasController';\r\nimport { SubSuperContainerFormat } from '@shared/main/FileFormat';\r\nimport EqContent from '@shared/layout/EqContent';\r\nimport { creatorContainerStroke, defaultExpPortrusion, creatorContainerPadding } from '@shared/main/consts';\r\nimport { Container } from '@shared/main/ComponentModel';\r\nimport CreatorHBox from './CreatorHBox';\r\nimport { parseContainerChildren } from '@shared/main/helpers';\r\nimport CreatorTightHBox from './CreatorTightHBox';\r\n\r\n@Container({\r\n    typeString: 'creator-subSuper',\r\n    parse: (containerObj, depth, contentGetter, containerGetter) => {\r\n        // Return subSuper from file\r\n        const format = containerObj as SubSuperContainerFormat;\r\n        const top = new CreatorHBox(\r\n            parseContainerChildren(format.top, depth, containerGetter, contentGetter),\r\n            creatorContainerPadding\r\n        );\r\n        const middle = new CreatorTightHBox(\r\n            parseContainerChildren(format.middle, depth, containerGetter, contentGetter),\r\n            creatorContainerPadding\r\n        );\r\n        const bottom = new CreatorHBox(\r\n            parseContainerChildren(format.bottom, depth, containerGetter, contentGetter),\r\n            creatorContainerPadding\r\n        );\r\n        const portrusion = format.portrusion ? format.portrusion : defaultExpPortrusion;\r\n        return new CreatorSubSuper(top, middle, bottom, portrusion, creatorContainerPadding);\r\n    }\r\n})\r\nexport default class CreatorSubSuper extends SubSuper implements CreatorContainer {\r\n\r\n    // Used in creator: What to save portrusionProportion as.\r\n    private savePortrusionAs: number;\r\n\r\n    addVertically() {\r\n        return false;\r\n    }\r\n\r\n    addHorizontally() {\r\n        return false;\r\n    }\r\n\r\n    addBefore(e: EqComponent<any>, b: EqComponent<any>) {\r\n        return;\r\n    }\r\n\r\n    addAfter(e: EqComponent<any>, b: EqComponent<any>) {\r\n        return;\r\n    }\r\n\r\n    creatorDraw(l: LayoutState, ctx: CanvasRenderingContext2D) {\r\n        ctx.save();\r\n        ctx.strokeStyle = creatorContainerStroke;\r\n\r\n        // Outer border\r\n        ctx.beginPath();\r\n        ctx.rect(l.tlx, l.tly, l.width, l.height);\r\n        ctx.stroke();\r\n\r\n        ctx.restore();\r\n        creatorContainerCreatorDraw(l, ctx);\r\n    }\r\n\r\n    addClick(clickedLayout: LayoutState, x: number, y: number, toAdd: EqComponent<any>) {\r\n        if (x - clickedLayout.tlx < this.padding.left * clickedLayout.scale) {\r\n            const container = clickedLayout.layoutParent.component as unknown as CreatorContainer;\r\n            container.addClickOnChild(clickedLayout, x, y, toAdd);\r\n        } else if (clickedLayout.tlx + clickedLayout.width - x < this.padding.right * clickedLayout.scale) {\r\n            const container = clickedLayout.layoutParent.component as unknown as CreatorContainer;\r\n            container.addClickOnChild(clickedLayout, x, y, toAdd);\r\n        } else {\r\n            return;\r\n        }\r\n    }\r\n\r\n    addClickOnChild(clickedLayout: LayoutState, x: number, y: number, toAdd: EqComponent<any>) {\r\n        return;\r\n    }\r\n\r\n    toStepLayout(controller: CanvasController): SubSuperContainerFormat {\r\n        const toReturn: SubSuperContainerFormat = {\r\n            type: 'subSuper',\r\n            top: childrenToStepLayout(this.top.getChildren(), controller),\r\n            middle: childrenToStepLayout(this.middle.getChildren(), controller),\r\n            bottom: childrenToStepLayout(this.bottom.getChildren(), controller)\r\n        };\r\n        if (this.savePortrusionAs) {\r\n            if (this.savePortrusionAs !== defaultExpPortrusion) {\r\n                toReturn.portrusion = this.savePortrusionAs;\r\n            }\r\n            this.savePortrusionAs = undefined;\r\n        } else if (this.portrusionProportion !== defaultExpPortrusion) {\r\n            toReturn.portrusion = this.portrusionProportion;\r\n        }\r\n        return toReturn;\r\n    }\r\n\r\n    delete(toDelete: EqComponent<any>) {\r\n        throw new Error('Cannot delete children from a SubSuper container.');\r\n    }\r\n\r\n    forEachUnder(forEach: (content: EqContent<any>) => void) {\r\n        (this.top as unknown as CreatorContainer).forEachUnder(forEach);\r\n        (this.middle as unknown as CreatorContainer).forEachUnder(forEach);\r\n        (this.bottom as unknown as CreatorContainer).forEachUnder(forEach);\r\n    }\r\n\r\n    /**\r\n     * Save this SubSuper as having\r\n     * a particular portrusion proportion. The\r\n     * next time toStepLayout is called, this\r\n     * number will be saved, but this container\r\n     * isn't considered to have the proportion.\r\n     * @param saveAs What to save portrusion as.\r\n     */\r\n    savePortrusion(saveAs: number) {\r\n        this.savePortrusionAs = saveAs;\r\n    }\r\n}\r\n","import TableContainer, { parseChildren2D, parseChildrenObj } from '@shared/layout/TableContainer';\r\nimport CreatorContainer from './CreatorContainer';\r\nimport LayoutState from '@shared/animation/LayoutState';\r\nimport EqComponent from '@shared/layout/EqComponent';\r\nimport CanvasController from '@shared/main/CanvasController';\r\nimport { ContainerFormat, TableFormat } from '@shared/main/FileFormat';\r\nimport EqContent from '@shared/layout/EqContent';\r\nimport EqContainer from '@shared/layout/EqContainer';\r\nimport HDivider from '@shared/layout/HDivider';\r\nimport VDivider from '@shared/layout/VDivider';\r\nimport { line } from '@shared/main/helpers';\r\nimport { creatorContainerCreatorDraw, creatorContainerAddClick } from './CreatorContainerMethods';\r\nimport Radical from '@shared/layout/Radical';\r\nimport {\r\n    creatorTableMinCellDimen,\r\n    creatorContainerStroke,\r\n    creatorLineDash,\r\n    creatorPlusLineHalfLength,\r\n    creatorContainerPadding,\r\n} from '@shared/main/consts';\r\nimport { Container } from '@shared/main/ComponentModel';\r\nimport Padding from '@shared/layout/Padding';\r\n\r\n@Container({\r\n    typeString: 'creator-table',\r\n    parse: (containerObj, depth, contentGetter, containerGetter, inf) => {\r\n        // Not selectable\r\n        const format = containerObj as TableFormat;\r\n        return new CreatorTable(\r\n            creatorContainerPadding,\r\n            parseChildren2D(format.children, containerGetter, contentGetter),\r\n            parseChildrenObj(format.hLines, contentGetter),\r\n            parseChildrenObj(format.vLines, contentGetter),\r\n            11,\r\n            Padding.even(0)\r\n        );\r\n    }\r\n})\r\nexport default class CreatorTable extends TableContainer implements CreatorContainer {\r\n    /**\r\n     * Return the mimimum dimension in either axis\r\n     * for a table cell.\r\n     */\r\n    protected getMinCellDimen(): number {\r\n        return creatorTableMinCellDimen;\r\n    }\r\n\r\n    getHLines(): { [index: number]: EqComponent<any> } {\r\n        return this.hLines;\r\n    }\r\n\r\n    getVLines(): { [index: number]: EqComponent<any> } {\r\n        return this.vLines;\r\n    }\r\n\r\n    getChildren(): EqComponent<any>[][] {\r\n        return this.children;\r\n    }\r\n\r\n    /**\r\n     * When one of this container's direct\r\n     * children is clicked, add a component\r\n     * adjacent to the clicked child.\r\n     * @param clickedLayout The layout state generated by the child.\r\n     * @param x The x-ordinate clicked.\r\n     * @param y The y-ordinate clicked.\r\n     * @param toAdd The component to add.\r\n     */\r\n    addClickOnChild(clickedLayout: LayoutState, x: number, y: number, toAdd: EqComponent<any>): void {\r\n        // Not valid in any case\r\n        return;\r\n    }\r\n\r\n    /**\r\n     * Returns an object representing\r\n     * the step layout that would generate\r\n     * this container.\r\n     */\r\n    toStepLayout(controller: CanvasController): ContainerFormat {\r\n        // Convert 2d array of components to 2d array to save\r\n        const saveChildren = [];\r\n        for (const row of this.children) {\r\n            const rowArr = [];\r\n            for (const currChild of row) {\r\n                if (currChild) {\r\n                    if (currChild instanceof EqContainer) {\r\n                        const stepLayout = (currChild as unknown as CreatorContainer).toStepLayout(controller);\r\n                        rowArr.push(stepLayout);\r\n                    } else if (currChild instanceof EqContent) {\r\n                        rowArr.push(currChild.getRef());\r\n                    }\r\n                } else {\r\n                    rowArr.push(null);\r\n                }\r\n            }\r\n            saveChildren.push(rowArr);\r\n        }\r\n\r\n        // Convert vLines to step format\r\n        const saveVLines = {};\r\n        Object.keys(this.vLines).forEach(index => {\r\n            const component = this.vLines[index];\r\n            saveVLines[index] = (component as EqContent<any>).getRef();\r\n        });\r\n\r\n        // Convert hLines to step format\r\n        const saveHLines = {};\r\n        Object.keys(this.hLines).forEach(index => {\r\n            const component = this.hLines[index];\r\n            saveHLines[index] = (component as EqContent<any>).getRef();\r\n        });\r\n\r\n        const toReturn = {\r\n            type: 'table',\r\n            children: saveChildren,\r\n            vLines: saveVLines,\r\n            hLines: saveHLines\r\n        } as TableFormat;\r\n        return toReturn;\r\n    }\r\n\r\n    /**\r\n     * Delete a child of this container.\r\n     * @param toDelete The child to delete.\r\n     */\r\n    delete(toDelete: EqComponent<any>): void {\r\n        // Deleting always valid\r\n        if (toDelete instanceof HDivider) {\r\n            // Find the hDivider and delete it\r\n            for (const index of Object.keys(this.hLines)) {\r\n                const hDivider = this.hLines[index];\r\n                if (hDivider === toDelete) {\r\n                    // Found it\r\n                    delete this.hLines[index];\r\n                    return;\r\n                }\r\n            }\r\n            throw new Error('HDivider not found');\r\n        } else if (toDelete instanceof VDivider) {\r\n            // Find the vDivider and delete it\r\n            for (const index of Object.keys(this.vLines)) {\r\n                const vDivider = this.vLines[index];\r\n                if (vDivider === toDelete) {\r\n                    // Found it\r\n                    delete this.vLines[index];\r\n                    return;\r\n                }\r\n            }\r\n            throw new Error('VDivider not found');\r\n        } else {\r\n            // Must be in children array\r\n            for (const row of this.children) {\r\n                for (let c = 0; c < row.length; c++) {\r\n                    const currChild = row[c];\r\n                    if (currChild === toDelete) {\r\n                        // Found it\r\n                        row[c] = null;\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n            throw new Error('Child not found');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Runs a function for every piece of\r\n     * content under this container.\r\n     * @param forEach The function to run for content.\r\n     */\r\n    forEachUnder(forEach: (content: EqContent<any>) => void): void {\r\n        Object.keys(this.hLines).forEach(index => {\r\n            // tslint:disable-next-line:no-shadowed-variable\r\n            const line = this.hLines[index];\r\n            forEach(line);\r\n        });\r\n        Object.keys(this.vLines).forEach(index => {\r\n            // tslint:disable-next-line:no-shadowed-variable\r\n            const line = this.vLines[index];\r\n            forEach(line);\r\n        });\r\n        for (const row of this.children) {\r\n            for (const currChild of row) {\r\n                if (currChild) {\r\n                    if (currChild instanceof EqContent) {\r\n                        forEach(currChild);\r\n                    } else if (currChild instanceof EqContainer) {\r\n                        (currChild as EqContainer<any> & CreatorContainer).forEachUnder(forEach);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Whether this container lays out components vertically\r\n     * and more can be added.\r\n     */\r\n    addVertically(): boolean {\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Whether this container lays out components horizontally\r\n     * and more can be added.\r\n     */\r\n    addHorizontally(): boolean {\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Add a child before another.\r\n     * @param toAdd The child to add.\r\n     * @param before Add before this child.\r\n     */\r\n    addBefore(toAdd: EqComponent<any>, before: EqComponent<any>): void {\r\n        return;\r\n    }\r\n\r\n    /**\r\n     * Add a child after another.\r\n     * @param toAdd The child to add.\r\n     * @param after Add after this child.\r\n     */\r\n    addAfter(toAdd: EqComponent<any>, after: EqComponent<any>): void {\r\n        return;\r\n    }\r\n\r\n    /**\r\n     * When this container is clicked,\r\n     * add a component to it at some\r\n     * position. This default implementation\r\n     * adds the component adjacent to this one\r\n     * in the parent container of this container.\r\n     * @param clickedLayout The layout state (generated by this container) that was clicked.\r\n     * @param x The x-ordinate clicked.\r\n     * @param y The y-ordinate clicked.\r\n     * @param toAdd The component to add.\r\n     */\r\n    addClick(clickedLayout: LayoutState, x: number, y: number, toAdd: EqComponent<any>): void {\r\n        // Generate some fake layout states where children\r\n        // or lines were NOT created.\r\n        const emptyChildLayouts: LayoutState[][] = [];\r\n        const emptyVLineLayouts: LayoutState[] = [];\r\n        const emptyHLineLayouts: LayoutState[] = [];\r\n\r\n        let upToY = clickedLayout.tly + this.padding.top + this.getLineStroke();\r\n        for (let r = 0; r < this.children.length; r++) {\r\n            // Do the row\r\n            let upToX = clickedLayout.tlx + this.padding.left + this.getLineStroke();\r\n            const rowHeight = this.heights[r];\r\n\r\n            // Add hline placeholder before row if there is one\r\n            if (!this.hLines[r]) {\r\n                emptyHLineLayouts[r] = new LayoutState(\r\n                    undefined, undefined,\r\n                    clickedLayout.tlx + this.padding.left, upToY - this.getLineStroke(),\r\n                    clickedLayout.width - this.padding.width(), this.getLineStroke(), 1\r\n                );\r\n            }\r\n\r\n            emptyChildLayouts[r] = [];\r\n\r\n            for (let c = 0; c < this.children[r].length; c++) {\r\n                // Do each column\r\n                const colWidth = this.widths[c];\r\n\r\n                // Add vline placeholder before column if there is one\r\n                if (!this.vLines[c]) {\r\n                    emptyVLineLayouts[c] = new LayoutState(\r\n                        undefined, undefined,\r\n                        upToX - this.getLineStroke(), clickedLayout.tly + this.padding.top,\r\n                        this.getLineStroke(), clickedLayout.height - this.padding.height(), 1\r\n                    );\r\n                }\r\n\r\n                const currChild = this.children[r][c];\r\n                if (!currChild) {\r\n                    // Add child layout placeholder\r\n                    emptyChildLayouts[r][c] = new LayoutState(\r\n                        undefined, undefined,\r\n                        upToX, upToY, colWidth, rowHeight, 1\r\n                    );\r\n                }\r\n                upToX += colWidth + this.getLineStroke();\r\n\r\n                // Add vline placeholder after last column if there is one\r\n                if (c === this.children[r].length - 1 && !this.vLines[c + 1]) {\r\n                    emptyVLineLayouts[c + 1] = new LayoutState(\r\n                        undefined, undefined,\r\n                        upToX - this.getLineStroke(), clickedLayout.tly + this.padding.top,\r\n                        this.getLineStroke(), clickedLayout.height - this.padding.height(), 1\r\n                    );\r\n                }\r\n            }\r\n            upToY += rowHeight + this.getLineStroke();\r\n\r\n            // Add hline placeholder before row if there is one\r\n            if (r === this.children.length - 1 && !this.hLines[r + 1]) {\r\n                emptyHLineLayouts[r + 1] = new LayoutState(\r\n                    undefined, undefined,\r\n                    clickedLayout.tlx + this.padding.left, upToY - this.getLineStroke(),\r\n                    clickedLayout.width - this.padding.width(), this.getLineStroke(), 1\r\n                );\r\n            }\r\n        }\r\n\r\n        // Check if the click was on any of the placeholders\r\n        for (let r = 0; r < this.children.length; r++) {\r\n            for (let c = 0; c < this.children[r].length; c++) {\r\n                if (emptyChildLayouts[r][c] && emptyChildLayouts[r][c].contains(x, y)) {\r\n                    // Click was on this placeholder\r\n                    // Some content types not allowed\r\n                    if (toAdd instanceof Radical) {\r\n                        throw new Error('Cannot add that here');\r\n                    } else if (toAdd instanceof HDivider) {\r\n                        throw new Error('Cannot add that here');\r\n                    } else if (toAdd instanceof VDivider) {\r\n                        throw new Error('Cannot add that here');\r\n                    }\r\n                    this.children[r][c] = toAdd;\r\n\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check if the click was on any h lines\r\n        for (let r = 0; r <= this.children.length; r++) {\r\n            if (emptyHLineLayouts[r] && emptyHLineLayouts[r].contains(x, y)) {\r\n                // Click was on this placeholder\r\n                // Only an hLine is allowed to be added\r\n                if (!(toAdd instanceof HDivider)) {\r\n                    throw new Error('Only Horizontal Lines can be added here.');\r\n                }\r\n                this.hLines[r] = toAdd;\r\n                return;\r\n            }\r\n        }\r\n\r\n        // Check if the click was on any v lines\r\n        for (let c = 0; c <= this.children[0].length; c++) {\r\n            if (emptyVLineLayouts[c] && emptyVLineLayouts[c].contains(x, y)) {\r\n                // Click was on this placeholder\r\n                // Only an hLine is allowed to be added\r\n                if (!(toAdd instanceof VDivider)) {\r\n                    throw new Error('Only Vertical Lines can be added here.');\r\n                }\r\n                this.vLines[c] = toAdd;\r\n                return;\r\n            }\r\n        }\r\n\r\n        // If get to here, couldn't find anything else.\r\n        creatorContainerAddClick.call(this, clickedLayout, x, y, toAdd);\r\n    }\r\n\r\n    /**\r\n     * Draws the container on the canvas,\r\n     * only used in the creator. This default\r\n     * implementation draws carets on the outer\r\n     * half of the padding, depending on the\r\n     * parent container.\r\n     * @param l The layout of this container.\r\n     * @param ctx The graphics context to draw to.\r\n     */\r\n    creatorDraw(l: LayoutState, ctx: CanvasRenderingContext2D): void {\r\n        ctx.save();\r\n\r\n        // Draw an outline\r\n        ctx.strokeStyle = creatorContainerStroke;\r\n        ctx.strokeRect(l.tlx, l.tly, l.width, l.height);\r\n\r\n        // If any lines are not present, draw them as dotted lines\r\n        const hLinesToDraw = new Set();\r\n        for (let r = 0; r <= this.children.length; r++) {\r\n            if (!this.hLines[r]) {\r\n                hLinesToDraw.add(r);\r\n            }\r\n        }\r\n\r\n        const vLinesToDraw = new Set();\r\n        for (let c = 0; c <= this.children[0].length; c++) {\r\n            if (!this.vLines[c]) {\r\n                vLinesToDraw.add(c);\r\n            }\r\n        }\r\n\r\n        // Draw h lines\r\n        ctx.save();\r\n        ctx.setLineDash(creatorLineDash);\r\n        ctx.strokeStyle = creatorContainerStroke;\r\n        let upToY = l.tly + this.padding.top;\r\n        for (let r = 0; r <= this.children.length; r++) {\r\n            if (hLinesToDraw.has(r)) {\r\n                line(l.tlx + this.padding.left,\r\n                    upToY + this.getLineStroke() / 2,\r\n                    l.tlx + l.width - this.padding.right,\r\n                    upToY + this.getLineStroke() / 2, ctx);\r\n            }\r\n            upToY += this.getLineStroke() + this.heights[r];\r\n        }\r\n\r\n        // Draw v lines\r\n        let upToX = l.tlx + this.padding.left;\r\n        for (let c = 0; c <= this.children[0].length; c++) {\r\n            if (vLinesToDraw.has(c)) {\r\n                line(upToX + this.getLineStroke() / 2,\r\n                    l.tly + this.padding.top,\r\n                    upToX + this.getLineStroke() / 2,\r\n                    l.tly + l.height - this.padding.bottom, ctx);\r\n            }\r\n            upToX += this.getLineStroke() + this.widths[c];\r\n        }\r\n        ctx.restore();\r\n\r\n        // Draw a small plus in the center of any cell not\r\n        // occupied.\r\n        upToY = l.tly + this.padding.top + this.getLineStroke();\r\n        for (let r = 0; r < this.children.length; r++) {\r\n            // Do the row\r\n            upToX = l.tlx + this.padding.left + this.getLineStroke();\r\n            const rowHeight = this.heights[r];\r\n            for (let c = 0; c < this.children[r].length; c++) {\r\n                // Do each column\r\n                const colWidth = this.widths[c];\r\n\r\n                const currChild = this.children[r][c];\r\n                if (!currChild) {\r\n                    // Draw plus\r\n                    ctx.save();\r\n                    ctx.translate(upToX + colWidth / 2, upToY + rowHeight / 2);\r\n                    ctx.strokeStyle = creatorContainerStroke;\r\n                    line(-creatorPlusLineHalfLength, 0, creatorPlusLineHalfLength, 0, ctx);\r\n                    line(0, -creatorPlusLineHalfLength, 0, creatorPlusLineHalfLength, ctx);\r\n                    ctx.restore();\r\n                }\r\n                upToX += colWidth + this.getLineStroke();\r\n            }\r\n            upToY += rowHeight + this.getLineStroke();\r\n        }\r\n\r\n        ctx.restore();\r\n\r\n        // Carets that depend on parent\r\n        creatorContainerCreatorDraw.call(this, l, ctx);\r\n    }\r\n\r\n}\r\n","import CreatorHBox from './CreatorHBox';\r\nimport CanvasController, { MouseEventCallback } from '@shared/main/CanvasController';\r\nimport { LinearContainerFormat } from '@shared/main/FileFormat';\r\nimport { childrenToStepLayout } from './CreatorContainerMethods';\r\nimport Term from '@shared/layout/Term';\r\nimport LayoutState from '@shared/animation/LayoutState';\r\nimport EqComponent from '@shared/layout/EqComponent';\r\nimport TermLayoutState from '@shared/animation/TermLayoutState';\r\nimport EqContent from '@shared/layout/EqContent';\r\nimport { termPadding, tightTermPadding, creatorContainerPadding } from '@shared/main/consts';\r\nimport { Container } from '@shared/main/ComponentModel';\r\nimport { parseContainerChildren } from '@shared/main/helpers';\r\n\r\nconst widthDiff = termPadding.width() - tightTermPadding.width();\r\n\r\n@Container({\r\n    typeString: 'creator-tightHBox',\r\n    parse: (containerObj, depth, contentGetter, containerGetter) => {\r\n        const format = containerObj as LinearContainerFormat;\r\n        // Return HBox from file\r\n        return new CreatorTightHBox(\r\n            parseContainerChildren(format.children, depth, containerGetter, contentGetter),\r\n            creatorContainerPadding\r\n        );\r\n    }\r\n})\r\nexport default class CreatorTightHBox extends CreatorHBox {\r\n\r\n    // Override to have right type\r\n    toStepLayout(controller: CanvasController): LinearContainerFormat {\r\n        return {\r\n            type: 'tightHBox',\r\n            children: childrenToStepLayout(this.children, controller)\r\n        };\r\n    }\r\n\r\n    // Override to account for reduced width of tight terms.\r\n    protected calcWidth(): number {\r\n        let totalWidth = 0;\r\n        let numTerms = 0;\r\n        for (const currChild of this.children) {\r\n            totalWidth += currChild.getWidth();\r\n            if (currChild instanceof Term) {\r\n                numTerms++;\r\n            }\r\n        }\r\n        return totalWidth + this.padding.width() - numTerms * widthDiff;\r\n    }\r\n\r\n    // Override to reduce term padding.\r\n    addLayout(  parentLayout: LayoutState, layouts: Map<EqComponent<any>, LayoutState>,\r\n                tlx: number, tly: number, currScale: number,\r\n                opacityObj: object, colorsObj: object,\r\n                mouseEnter: Map<LayoutState, MouseEventCallback>,\r\n                mouseExit: Map<LayoutState, MouseEventCallback>,\r\n                mouseClick: Map<LayoutState, MouseEventCallback>,\r\n                tempContent: EqContent<any>[]): LayoutState {\r\n        const state = new LayoutState(\r\n                            parentLayout, this, tlx, tly,\r\n                            this.getWidth() * currScale,\r\n                            this.getHeight() * currScale,\r\n                            currScale);\r\n        const innerHeight = (this.getHeight() - this.padding.height()) * currScale;\r\n        let upToX = tlx + this.padding.left * currScale;\r\n\r\n        for (const currChild of this.children) {\r\n            const childHeight = currChild.getHeight() * currScale;\r\n\r\n            // Position child in the middle vertically\r\n            const childTLY = (innerHeight - childHeight) / 2 + this.padding.top * currScale + tly;\r\n            const childLayout = currChild.addLayout(state, layouts,\r\n                                                    upToX, childTLY, currScale,\r\n                                                    opacityObj, colorsObj,\r\n                                                    mouseEnter, mouseExit, mouseClick, tempContent);\r\n            if (currChild instanceof Term) {\r\n                (childLayout as TermLayoutState).tighten(widthDiff * currScale);\r\n            }\r\n            upToX += childLayout.width;\r\n        }\r\n\r\n\r\n        layouts.set(this, state);\r\n\r\n        return state;\r\n    }\r\n}\r\n","import VBox from '@shared/layout/VBox';\r\nimport LinearCreatorContainer from './LinearCreatorContainer';\r\nimport LayoutState from '@shared/animation/LayoutState';\r\nimport { line, tri, parseContainerChildren } from '@shared/main/helpers';\r\nimport {\r\n    creatorContainerCreatorDraw,\r\n    creatorContainerAddClick,\r\n    childrenToStepLayout,\r\n    linearContainerDelete,\r\n    linearContainerForEachUnder,\r\n    linearContainerAddBefore,\r\n    linearContainerAddAfter\r\n} from './CreatorContainerMethods';\r\nimport EqComponent from '@shared/layout/EqComponent';\r\nimport Radical from '@shared/layout/Radical';\r\nimport CanvasController from '@shared/main/CanvasController';\r\nimport { LinearContainerFormat } from '@shared/main/FileFormat';\r\nimport { creatorContainerStroke, creatorContainerPadding, creatorCaretFillStyle, creatorCaretSize } from '@shared/main/consts';\r\nimport { Container } from '@shared/main/ComponentModel';\r\n\r\n@Container({\r\n    typeString: 'creator-vbox',\r\n    parse: (containerObj, depth, contentGetter, containerGetter) => {\r\n        const format = containerObj as LinearContainerFormat;\r\n        // Return VBox from file\r\n        return new CreatorVBox(\r\n            parseContainerChildren(format.children, depth, containerGetter, contentGetter),\r\n            creatorContainerPadding\r\n        );\r\n    }\r\n})\r\nexport default class CreatorVBox extends VBox implements LinearCreatorContainer {\r\n\r\n    delete = linearContainerDelete;\r\n    forEachUnder = linearContainerForEachUnder;\r\n    addBefore = linearContainerAddBefore;\r\n    addAfter = linearContainerAddAfter;\r\n\r\n    addHorizontally() {\r\n        return false;\r\n    }\r\n\r\n    addVertically() {\r\n        return true;\r\n    }\r\n\r\n    creatorDraw(l: LayoutState, ctx: CanvasRenderingContext2D) {\r\n        ctx.save();\r\n        ctx.strokeStyle = creatorContainerStroke;\r\n\r\n        // Outer border\r\n        ctx.beginPath();\r\n        ctx.rect(l.tlx, l.tly, l.width, l.height);\r\n        ctx.stroke();\r\n\r\n        const pad = creatorContainerPadding.scale(l.scale);\r\n\r\n        // Vertical lines\r\n        const y1 = l.tly + pad.top / 2;\r\n        const y2 = l.tly + l.height - pad.bottom / 2;\r\n        const x1 = l.tlx + pad.left / 2;\r\n        const x2 = l.tlx + l.width - pad.right / 2;\r\n        line(x1, y1, x1, y2, ctx);\r\n        line(x2, y1, x2, y2, ctx);\r\n\r\n        // Carets\r\n        ctx.fillStyle = creatorCaretFillStyle;\r\n\r\n        ctx.save();\r\n        ctx.translate(l.tlx + l.width / 2, l.tly + pad.top * 0.75);\r\n        ctx.scale(l.scale, l.scale);\r\n        tri(0, 0, creatorCaretSize, creatorCaretSize, ctx);\r\n        ctx.restore();\r\n\r\n        ctx.save();\r\n        ctx.translate(l.tlx + l.width / 2, l.tly + l.height - pad.top * 0.75);\r\n        ctx.rotate(Math.PI);\r\n        ctx.scale(l.scale, l.scale);\r\n        tri(0, 0, creatorCaretSize, creatorCaretSize, ctx);\r\n        ctx.restore();\r\n\r\n        // Carets that depend on parent\r\n        creatorContainerCreatorDraw.call(this, l, ctx);\r\n\r\n        ctx.restore();\r\n    }\r\n\r\n    addClick(l: LayoutState, x: number, y: number, toAdd: EqComponent<any>) {\r\n        const realPad = creatorContainerPadding.scale(l.scale);\r\n        // Create mock layout states to use like rectangles\r\n        const innerTop = new LayoutState(\r\n            undefined, undefined,\r\n            l.tlx + realPad.left / 2,\r\n            l.tly + realPad.top / 2,\r\n            l.width - realPad.width() / 2,\r\n            realPad.height() / 4,\r\n            1\r\n        );\r\n        const innerBot = new LayoutState(\r\n            undefined, undefined,\r\n            l.tlx + realPad.left / 2,\r\n            l.tly + l.height - realPad.bottom,\r\n            l.width - realPad.width() / 2,\r\n            realPad.height() / 4,\r\n            1\r\n        );\r\n        if (innerTop.contains(x, y)) {\r\n            // Add at start\r\n            this.addValid(toAdd);\r\n            this.children.unshift(toAdd);\r\n        } else if (innerBot.contains(x, y)) {\r\n            // Add at end\r\n            this.addValid(toAdd);\r\n            this.children.push(toAdd);\r\n        } else {\r\n            // Click wasn't on inner part, add adjacent to parent container.\r\n            creatorContainerAddClick(l, x, y, toAdd);\r\n        }\r\n    }\r\n\r\n    addClickOnChild(clickedLayout: LayoutState, x: number, y: number, toAdd: EqComponent<any>) {\r\n        this.addValid(toAdd);\r\n        if (clickedLayout.onTop(y)) {\r\n            // Add top\r\n            this.addBefore(toAdd, clickedLayout.component);\r\n        } else {\r\n            // Add bottom\r\n            this.addAfter(toAdd, clickedLayout.component);\r\n        }\r\n    }\r\n\r\n    addValid(toAdd: EqComponent<any>) {\r\n        if (toAdd instanceof Radical) {\r\n            throw new Error('Radicals can only be added inside a root container.');\r\n        }\r\n    }\r\n\r\n    toStepLayout(controller: CanvasController): LinearContainerFormat {\r\n        return {\r\n            type: 'vbox',\r\n            children: childrenToStepLayout(this.children, controller)\r\n        };\r\n    }\r\n}\r\n","module.exports = \"#outer {\\r\\n    overflow-y: scroll;\\r\\n    overflow-x: auto;\\r\\n    max-width: calc(100vw - 250px);\\r\\n    height: 100%;\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY2VudHJhbC1hcmVhL2NlbnRyYWwtYXJlYS5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksa0JBQWtCO0lBQ2xCLGdCQUFnQjtJQUNoQiw4QkFBOEI7SUFDOUIsWUFBWTtBQUNoQiIsImZpbGUiOiJzcmMvYXBwL2NlbnRyYWwtYXJlYS9jZW50cmFsLWFyZWEuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIiNvdXRlciB7XHJcbiAgICBvdmVyZmxvdy15OiBzY3JvbGw7XHJcbiAgICBvdmVyZmxvdy14OiBhdXRvO1xyXG4gICAgbWF4LXdpZHRoOiBjYWxjKDEwMHZ3IC0gMjUwcHgpO1xyXG4gICAgaGVpZ2h0OiAxMDAlO1xyXG59Il19 */\"","module.exports = \"<div #outer id=\\\"outer\\\">\\r\\n    <app-step-text></app-step-text>\\r\\n    <div #eqContainer></div>\\r\\n</div>\"","import { Component, OnInit, ViewChild, ElementRef, AfterViewInit } from '@angular/core';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport CreatorCanvasController from './CreatorCanvasController';\r\nimport { ContentSelectionService } from '../content-selection.service';\r\nimport { SelectedStepService } from '../selected-step.service';\r\nimport { ErrorService } from '../error.service';\r\n\r\n@Component({\r\n  selector: 'app-central-area',\r\n  templateUrl: './central-area.component.html',\r\n  styleUrls: ['./central-area.component.css']\r\n})\r\nexport class CentralAreaComponent implements OnInit, AfterViewInit {\r\n\r\n  @ViewChild('eqContainer')\r\n  containerEl: ElementRef;\r\n\r\n  controller: CreatorCanvasController;\r\n\r\n  constructor(private undoRedo: UndoRedoService,\r\n              private selection: ContentSelectionService,\r\n              private step: SelectedStepService,\r\n              private error: ErrorService) {\r\n    this.undoRedo.subscribe(this.updateState.bind(this));\r\n    this.step.subscribe(newStep => {\r\n      this.controller.showStep(newStep);\r\n    });\r\n    this.selection.addAddListener(() => {\r\n      this.controller.redraw();\r\n    });\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.updateState(this.undoRedo.getState());\r\n  }\r\n\r\n  /**\r\n   * Update the canvas when the state changes.\r\n   * @param newState The new state to show.\r\n   */\r\n  updateState(newState: any) {\r\n    const scrollBefore = this.containerEl.nativeElement.scrollTop;\r\n    this.containerEl.nativeElement.innerHTML = '';\r\n    this.selection.resetSelectedOnCanvasListeners();\r\n    this.controller = new CreatorCanvasController(\r\n      this.containerEl.nativeElement,\r\n      newState,\r\n      this.undoRedo,\r\n      this.selection,\r\n      this.step,\r\n      this.error\r\n    );\r\n    this.containerEl.nativeElement.scrollTop = scrollBefore;\r\n  }\r\n\r\n}\r\n","module.exports = \"#bottom-row {\\r\\n    display: flex;\\r\\n}\\r\\n\\r\\n.selector span {\\r\\n    line-height: 22px;\\r\\n    font-size: 18px;\\r\\n    vertical-align: middle;\\r\\n}\\r\\n\\r\\n.white {\\r\\n    color: rgba(255, 255, 255, 0.9);\\r\\n}\\r\\n\\r\\n.black {\\r\\n    color: rgba(0, 0, 0, 0.8);\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29sb3ItcGlja2VyL2NvbG9yLXBpY2tlci5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksYUFBYTtBQUNqQjs7QUFFQTtJQUNJLGlCQUFpQjtJQUNqQixlQUFlO0lBQ2Ysc0JBQXNCO0FBQzFCOztBQUVBO0lBQ0ksK0JBQStCO0FBQ25DOztBQUVBO0lBQ0kseUJBQXlCO0FBQzdCIiwiZmlsZSI6InNyYy9hcHAvY29sb3ItcGlja2VyL2NvbG9yLXBpY2tlci5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiI2JvdHRvbS1yb3cge1xyXG4gICAgZGlzcGxheTogZmxleDtcclxufVxyXG5cclxuLnNlbGVjdG9yIHNwYW4ge1xyXG4gICAgbGluZS1oZWlnaHQ6IDIycHg7XHJcbiAgICBmb250LXNpemU6IDE4cHg7XHJcbiAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xyXG59XHJcblxyXG4ud2hpdGUge1xyXG4gICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC45KTtcclxufVxyXG5cclxuLmJsYWNrIHtcclxuICAgIGNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuOCk7XHJcbn0iXX0= */\"","module.exports = \"<div class=\\\"title\\\">OPACITY</div>\\r\\n<div>\\r\\n  <span class=\\\"selector\\\" *ngFor=\\\"let data of opacityData; let idx = index;\\\" [style.color]=\\\"data.color\\\" (click)=\\\"selectO(idx)\\\">\\r\\n    <span *ngIf=\\\"selectedOpacityIdx === idx\\\" class=\\\"material-icons tick white\\\">\\r\\n      check_circle_outline\\r\\n    </span>\\r\\n    {{ data.text }}\\r\\n  </span>\\r\\n</div>\\r\\n<div class=\\\"title\\\">COLOR</div>\\r\\n<div>\\r\\n  <span class=\\\"selector white\\\" *ngFor=\\\"let data of colorData; let idx = index;\\\" [style.backgroundColor]=\\\"data.color\\\" (click)=\\\"selectC(idx)\\\">\\r\\n    <span *ngIf=\\\"selectedColorIdx === idx\\\" class=\\\"material-icons tick\\\" [class.black]=\\\"data.text === 'Default'\\\">\\r\\n      check_circle_outline\\r\\n    </span>\\r\\n    <span [class.black]=\\\"data.text === 'Default'\\\">\\r\\n      {{ data.text }}\\r\\n    </span>\\r\\n  </span>\\r\\n</div>\\r\\n<div id=\\\"bottom-row\\\">\\r\\n  <div class=\\\"button\\\" (click)=\\\"apply();\\\">Apply</div>\\r\\n</div>\"","import { Component, OnInit } from '@angular/core';\r\nimport { ContentSelectionService } from '../content-selection.service';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport { ModalService } from '../modal.service';\r\nimport { cap } from '../helpers';\r\nimport { fadedOpacity, normalOpacity, focusedOpacity, colors } from '@shared/main/consts';\r\n\r\n@Component({\r\n  selector: 'app-color-picker',\r\n  templateUrl: './color-picker.component.html',\r\n  styleUrls: ['./color-picker.component.css']\r\n})\r\nexport class ColorPickerComponent implements OnInit {\r\n\r\n  opacityData: SelectorData[] = [];\r\n  selectedOpacityIdx: number;\r\n\r\n  colorData: SelectorData[] = [];\r\n  selectedColorIdx: number;\r\n  defaultColorIdx: number;\r\n\r\n  constructor(private selection: ContentSelectionService, private undoRedo: UndoRedoService, private modal: ModalService) {\r\n    this.opacityData = [\r\n      new SelectorData('rgba(255, 255, 255, ' + fadedOpacity + ')', 'Faded'),\r\n      new SelectorData('rgba(255, 255, 255, ' + normalOpacity + ')', 'Normal'),\r\n      new SelectorData('rgba(255, 255, 255, ' + focusedOpacity + ')', 'Focused')\r\n    ];\r\n    const colNames = Object.keys(colors);\r\n    this.colorData = colNames\r\n      .map(colName => {\r\n        const colVal = colors[colName];\r\n        return new SelectorData('rgb(' + colVal[0] + ',' + colVal[1] + ',' + colVal[2] + ')', cap(colName));\r\n      });\r\n    this.defaultColorIdx = colNames.indexOf('default');\r\n\r\n    // Find the color and opacity of what's selected\r\n    const selectedRef = this.selection.selectedOnCanvas;\r\n    const state: any = this.undoRedo.getState();\r\n    const step: any = state.steps[0];\r\n    // If selected already has opacity, show it as selected\r\n    if (step.opacity && step.opacity[selectedRef]) {\r\n      const opacity = step.opacity[selectedRef];\r\n      if (opacity === fadedOpacity) {\r\n        this.selectedOpacityIdx = 0;\r\n      } else if (opacity === focusedOpacity) {\r\n        this.selectedOpacityIdx = 2;\r\n      }\r\n    } else {\r\n      this.selectDefaultOpacity();\r\n    }\r\n    // If selected already has color, show it as selected\r\n    if (step.color && step.color[selectedRef]) {\r\n      const colName = step.color[selectedRef];\r\n      this.selectedColorIdx = colNames.indexOf(colName);\r\n    } else {\r\n      this.selectDefaultColor();\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  /**\r\n   * Select the default opacity.\r\n   */\r\n  selectDefaultOpacity() {\r\n    this.selectedOpacityIdx = 1;\r\n  }\r\n\r\n  /**\r\n   * Select an opacity using an index.\r\n   * @param idx The index.\r\n   */\r\n  selectO(idx: number) {\r\n    this.selectedOpacityIdx = idx;\r\n  }\r\n\r\n  /**\r\n   * Select the default color.\r\n   */\r\n  selectDefaultColor() {\r\n    this.selectedColorIdx = this.defaultColorIdx;\r\n  }\r\n\r\n  /**\r\n   * Select a color using an index.\r\n   * Automatically focus color, unless\r\n   * the default color is selected.\r\n   * @param idx The index.\r\n   */\r\n  selectC(idx: number) {\r\n    this.selectedColorIdx = idx;\r\n    if (idx === this.defaultColorIdx) {\r\n      this.selectedOpacityIdx = 1;\r\n    } else {\r\n      this.selectedOpacityIdx = 2;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Apply the selected color\r\n   * and opacity to whatever is\r\n   * selected on the canvas.\r\n   */\r\n  apply() {\r\n    let opacity: number;\r\n    switch (this.selectedOpacityIdx) {\r\n      case 0: opacity = fadedOpacity;   break;\r\n      case 1: opacity = normalOpacity;  break;\r\n      case 2: opacity = focusedOpacity; break;\r\n      default:  throw new Error('Illegal selected opacity index.');\r\n    }\r\n    const colorName = Object.keys(colors)[this.selectedColorIdx];\r\n    this.selection.canvasInstance.applyColorAndOpacity(opacity, colorName);\r\n    this.modal.remove();\r\n  }\r\n\r\n}\r\n\r\nexport class SelectorData {\r\n  constructor(public color: string, public text: string) { }\r\n}\r\n","module.exports = \"#outer {\\r\\n    width: 250px;\\r\\n    border-left: 1px solid rgba(255, 255, 255, 0.1);\\r\\n    max-height: 100%;\\r\\n    overflow-x: auto;\\r\\n    color: rgba(255,255,255,0.9);\\r\\n}\\r\\n\\r\\n#inner {\\r\\n    padding: 7.5px;\\r\\n}\\r\\n\\r\\np {\\r\\n    font-size: 10px;\\r\\n    color: rgba(255,255,255,0.6);\\r\\n    text-align: center;\\r\\n    padding-top: 10px;\\r\\n    margin-bottom: -10px;\\r\\n}\\r\\n\\r\\n.selector span {\\r\\n    line-height: 22px;\\r\\n    font-size: 18px;\\r\\n    vertical-align: middle;\\r\\n}\\r\\n\\r\\n.selector span:hover {\\r\\n    background-color: rgba(0, 0, 0, 0.1);\\r\\n}\\r\\n\\r\\n.color {\\r\\n    border: 1px solid #2196F3;\\r\\n}\\r\\n\\r\\n.selected {\\r\\n    background-color: rgba(255, 255, 255, 0.25);\\r\\n}\\r\\n\\r\\n.grab {\\r\\n    cursor: -webkit-grab;\\r\\n    cursor: grab;\\r\\n}\\r\\n\\r\\n.more {\\r\\n    margin-left: 5px;\\r\\n}\\r\\n\\r\\n.material-icons {\\r\\n    cursor: pointer;\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY29udGVudC1wYW5lL2NvbnRlbnQtcGFuZS5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksWUFBWTtJQUNaLCtDQUErQztJQUMvQyxnQkFBZ0I7SUFDaEIsZ0JBQWdCO0lBQ2hCLDRCQUE0QjtBQUNoQzs7QUFFQTtJQUNJLGNBQWM7QUFDbEI7O0FBRUE7SUFDSSxlQUFlO0lBQ2YsNEJBQTRCO0lBQzVCLGtCQUFrQjtJQUNsQixpQkFBaUI7SUFDakIsb0JBQW9CO0FBQ3hCOztBQUVBO0lBQ0ksaUJBQWlCO0lBQ2pCLGVBQWU7SUFDZixzQkFBc0I7QUFDMUI7O0FBRUE7SUFDSSxvQ0FBb0M7QUFDeEM7O0FBRUE7SUFDSSx5QkFBeUI7QUFDN0I7O0FBRUE7SUFDSSwyQ0FBMkM7QUFDL0M7O0FBRUE7SUFDSSxvQkFBWTtJQUFaLFlBQVk7QUFDaEI7O0FBRUE7SUFDSSxnQkFBZ0I7QUFDcEI7O0FBRUE7SUFDSSxlQUFlO0FBQ25CIiwiZmlsZSI6InNyYy9hcHAvY29udGVudC1wYW5lL2NvbnRlbnQtcGFuZS5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiI291dGVyIHtcclxuICAgIHdpZHRoOiAyNTBweDtcclxuICAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpO1xyXG4gICAgbWF4LWhlaWdodDogMTAwJTtcclxuICAgIG92ZXJmbG93LXg6IGF1dG87XHJcbiAgICBjb2xvcjogcmdiYSgyNTUsMjU1LDI1NSwwLjkpO1xyXG59XHJcblxyXG4jaW5uZXIge1xyXG4gICAgcGFkZGluZzogNy41cHg7XHJcbn1cclxuXHJcbnAge1xyXG4gICAgZm9udC1zaXplOiAxMHB4O1xyXG4gICAgY29sb3I6IHJnYmEoMjU1LDI1NSwyNTUsMC42KTtcclxuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgIHBhZGRpbmctdG9wOiAxMHB4O1xyXG4gICAgbWFyZ2luLWJvdHRvbTogLTEwcHg7XHJcbn1cclxuXHJcbi5zZWxlY3RvciBzcGFuIHtcclxuICAgIGxpbmUtaGVpZ2h0OiAyMnB4O1xyXG4gICAgZm9udC1zaXplOiAxOHB4O1xyXG4gICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcclxufVxyXG5cclxuLnNlbGVjdG9yIHNwYW46aG92ZXIge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjEpO1xyXG59XHJcblxyXG4uY29sb3Ige1xyXG4gICAgYm9yZGVyOiAxcHggc29saWQgIzIxOTZGMztcclxufVxyXG5cclxuLnNlbGVjdGVkIHtcclxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yNSk7XHJcbn1cclxuXHJcbi5ncmFiIHtcclxuICAgIGN1cnNvcjogZ3JhYjtcclxufVxyXG5cclxuLm1vcmUge1xyXG4gICAgbWFyZ2luLWxlZnQ6IDVweDtcclxufVxyXG5cclxuLm1hdGVyaWFsLWljb25zIHtcclxuICAgIGN1cnNvcjogcG9pbnRlcjtcclxufSJdfQ== */\"","module.exports = \"<div id=\\\"outer\\\">\\r\\n  <p>{{ getHelpText() }}</p>\\r\\n  <div id=\\\"inner\\\">\\r\\n    <div class=\\\"title\\\">CONTAINERS</div>\\r\\n    <span class=\\\"selector grab\\\" \\r\\n          *ngFor=\\\"let container of containers; let cIndex = index;\\\"\\r\\n          (click)=\\\"select('c' + cIndex, $event)\\\"\\r\\n          (dragstart)=\\\"deselect(); setAdding('c' + cIndex); dragging = true;\\\"\\r\\n          [ngClass]=\\\"{'selected': selection.adding === 'c' + cIndex,\\r\\n                      'color': selection.selectedOnCanvas === 'c' + cIndex}\\\"\\r\\n          draggable=\\\"true\\\">\\r\\n      {{ container }}\\r\\n    </span>\\r\\n    <div class=\\\"title\\\">TERMS</div>\\r\\n    <span class=\\\"selector grab\\\" \\r\\n          *ngFor=\\\"let term of terms; let tIndex = index;\\\"\\r\\n          (click)=\\\"select('t' + tIndex, $event)\\\"\\r\\n          [ngClass]=\\\"{'selected': selection.adding === 't' + tIndex,\\r\\n                      'color': selection.selectedOnCanvas === 't' + tIndex}\\\"\\r\\n          draggable=\\\"true\\\"\\r\\n          (dragstart)=\\\"deselect(); dragging = true; setAdding('t' + tIndex);\\\">\\r\\n      {{ term }}\\r\\n      <span *ngIf=\\\"selection.adding === 't' + tIndex && !dragging\\\"\\r\\n            class=\\\"material-icons\\\"\\r\\n            (click)=\\\"delete($event)\\\">\\r\\n          delete\\r\\n      </span>\\r\\n    </span>\\r\\n    <span class=\\\"selector material-icons color\\\" \\r\\n          (click)=\\\"addTerm()\\\"\\r\\n          *ngIf=\\\"!addingTerm\\\">\\r\\n          add\\r\\n    </span>\\r\\n    <span class=\\\"selector color\\\" *ngIf=\\\"addingTerm\\\">\\r\\n      <input  type=\\\"text\\\" \\r\\n              (keyup)=\\\"addTermTyped($event)\\\" \\r\\n              (blur)=\\\"finishAddingTerm(false)\\\"\\r\\n              #termInput>\\r\\n      <span class=\\\"material-icons more\\\" (mousedown)=\\\"showTermTemplate()\\\">more_horiz</span>\\r\\n    </span>\\r\\n    <div class=\\\"title\\\">HORIZONTAL LINES</div>\\r\\n    <span class=\\\"selector grab\\\" \\r\\n          *ngFor=\\\"let hDivider of getCountArray(hDividers); let hIndex = index;\\\"\\r\\n          (click)=\\\"select('h' + hIndex, $event)\\\"\\r\\n          (dragstart)=\\\"deselect(); dragging = true; setAdding('h' + hIndex);\\\"\\r\\n          [ngClass]=\\\"{'selected': selection.adding === 'h' + hIndex,\\r\\n                      'color': selection.selectedOnCanvas === 'h' + hIndex}\\\"\\r\\n          draggable=\\\"true\\\">\\r\\n      {{ hDivider }}\\r\\n      <span *ngIf=\\\"selection.adding === 'h' + hIndex && !dragging\\\"\\r\\n            class=\\\"material-icons\\\"\\r\\n            (click)=\\\"delete($event)\\\">\\r\\n          delete\\r\\n      </span>\\r\\n    </span>\\r\\n    <span class=\\\"selector material-icons color\\\" \\r\\n          (click)=\\\"addHDivider($event)\\\">\\r\\n          add\\r\\n    </span>\\r\\n    <div class=\\\"title\\\">VERTICAL LINES</div>\\r\\n    <span class=\\\"selector grab\\\" \\r\\n          *ngFor=\\\"let vDivider of getCountArray(vDividers); let vIndex = index;\\\"\\r\\n          (click)=\\\"select('v' + vIndex, $event)\\\"\\r\\n          (dragstart)=\\\"deselect(); dragging = true; setAdding('v' + vIndex);\\\"\\r\\n          [ngClass]=\\\"{'selected': selection.adding === 'v' + vIndex,\\r\\n                      'color': selection.selectedOnCanvas === 'v' + vIndex}\\\"\\r\\n          draggable=\\\"true\\\">\\r\\n      {{ vDivider }}\\r\\n      <span *ngIf=\\\"selection.adding === 'v' + vIndex && !dragging\\\"\\r\\n            class=\\\"material-icons\\\"\\r\\n            (click)=\\\"delete($event)\\\">\\r\\n          delete\\r\\n      </span>\\r\\n    </span>\\r\\n    <span class=\\\"selector material-icons color\\\" \\r\\n          (click)=\\\"addVDivider($event)\\\">\\r\\n          add\\r\\n    </span>\\r\\n    <div class=\\\"title\\\">RADICALS</div>\\r\\n    <span class=\\\"selector grab\\\" \\r\\n          *ngFor=\\\"let radical of getCountArray(radicals); let rIndex = index;\\\"\\r\\n          (click)=\\\"select('r' + rIndex, $event)\\\"\\r\\n          (dragstart)=\\\"deselect(); dragging = true; setAdding('r' + rIndex);\\\"\\r\\n          [ngClass]=\\\"{'selected': selection.adding === 'r' + rIndex,\\r\\n                      'color': selection.selectedOnCanvas === 'r' + rIndex}\\\"\\r\\n          draggable=\\\"true\\\">\\r\\n      {{ radical }}\\r\\n      <span *ngIf=\\\"selection.adding === 'r' + rIndex && !dragging\\\"\\r\\n            class=\\\"material-icons\\\"\\r\\n            (click)=\\\"delete($event)\\\">\\r\\n          delete\\r\\n      </span>\\r\\n    </span>\\r\\n    <span class=\\\"selector material-icons color\\\" \\r\\n          (click)=\\\"addRadical($event)\\\">\\r\\n          add\\r\\n    </span>\\r\\n  </div>\\r\\n</div>\"","import { Component, ViewChildren, AfterViewInit } from '@angular/core';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport { QueryList } from '@angular/core';\r\nimport { ContentSelectionService } from '../content-selection.service';\r\nimport { ErrorService } from '../error.service';\r\nimport { getMetrics } from '@shared/main/helpers';\r\nimport { ModalService } from '../modal.service';\r\nimport { TermTemplateComponent } from '../term-template/term-template.component';\r\nimport {\r\n  TransitionOptionsFormat,\r\n  ContainerFormat,\r\n  LinearContainerFormat,\r\n  SubSuperContainerFormat,\r\n  QuizFormat,\r\n  RootContainerFormat,\r\n  TableFormat\r\n} from '@shared/main/FileFormat';\r\n\r\n@Component({\r\n  selector: 'app-content-pane',\r\n  templateUrl: './content-pane.component.html',\r\n  styleUrls: ['./content-pane.component.css']\r\n})\r\nexport class ContentPaneComponent implements AfterViewInit {\r\n\r\n  containers: string[];\r\n\r\n  addingTerm: boolean;\r\n  lastTermAddText = '';\r\n  terms: string[];\r\n  @ViewChildren('termInput') termInputEl: QueryList<any>;\r\n\r\n  hDividers = 0;\r\n  vDividers = 0;\r\n\r\n  radicals = 0;\r\n\r\n  dragging = false;\r\n\r\n  constructor(private undoRedo: UndoRedoService,\r\n              private selection: ContentSelectionService,\r\n              private error: ErrorService,\r\n              private modal: ModalService) {\r\n    this.containers = [\r\n      'Horizontal',\r\n      'Vertical',\r\n      'Tight Horizontal',\r\n      'Root',\r\n      'Exponent/Subscript',\r\n      'Quiz',\r\n      'Table'\r\n    ];\r\n    this.updateState = this.updateState.bind(this);\r\n    undoRedo.subscribe(this.updateState);\r\n    this.updateState(undoRedo.getState());\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    // Focus the term input whenever it appears\r\n    this.termInputEl.changes.subscribe({\r\n      next(ql) {\r\n        if (ql.first) {\r\n          ql.first.nativeElement.focus();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get the help text that is displayed\r\n   * on the top of the content pane.\r\n   */\r\n  getHelpText(): string {\r\n    if (this.addingTerm) {\r\n      return 'Press Enter to Add.';\r\n    } else if (this.dragging) {\r\n      return 'Drag to the Left to Add.';\r\n    } else if (this.selection.adding !== undefined) {\r\n      return 'Click on the Left to Add.';\r\n    } else {\r\n      return 'Click to Select.';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Turn the 'add term' button into\r\n   * a text box to add a term.\r\n   */\r\n  addTerm() {\r\n    this.addingTerm = true;\r\n  }\r\n\r\n  /**\r\n   * Called when the keyboard is typed when adding a term.\r\n   * @param e The event.\r\n   */\r\n  addTermTyped(e: KeyboardEvent) {\r\n    if (e.key === 'Enter') {\r\n      this.finishAddingTerm(true);\r\n      return;\r\n    }\r\n    this.lastTermAddText = (e.target as HTMLInputElement).value;\r\n  }\r\n\r\n  /**\r\n   * Typing the term is finished, add it to the state.\r\n   * @param fromKey Whether this function is called as a result of a key press.\r\n   */\r\n  finishAddingTerm(fromKey: boolean) {\r\n    if (!this.addingTerm) {\r\n      // Caused by input being removed activating blur\r\n      return;\r\n    }\r\n    const termText = this.lastTermAddText.trim();\r\n    if (termText === '') {\r\n      if (fromKey) {\r\n        // User pressed enter to add, let them know invalid\r\n        this.error.text = 'Blank terms are not allowed.';\r\n        return;\r\n      } else {\r\n        // User pressed somewhere else, just cancel the adding.\r\n        this.addingTerm = false;\r\n        return;\r\n      }\r\n    }\r\n    const newState: any = this.undoRedo.getStateClone();\r\n    if (!newState.terms) {\r\n      newState.terms = [];\r\n    }\r\n    const newIndex = newState.terms.length;\r\n    newState.terms.push(termText);\r\n    newState.metrics = getMetrics(newState);\r\n    this.undoRedo.publishChange(newState);\r\n    this.lastTermAddText = '';\r\n    this.addingTerm = false;\r\n    this.select('t' + newIndex, undefined);\r\n  }\r\n\r\n  /**\r\n   * Get a string array representing counting from 1\r\n   * to a number.\r\n   * @param countTo The number to count to.\r\n   */\r\n  getCountArray(countTo: number): string[] {\r\n    const toReturn: string[] = [];\r\n    for (let i = 0; i < countTo; i++) {\r\n      toReturn.push('' + (i + 1));\r\n    }\r\n    return toReturn;\r\n  }\r\n\r\n  /**\r\n   * Add a new hDivider.\r\n   * @param e The mouse event.\r\n   */\r\n  addHDivider(e: MouseEvent) {\r\n    e.stopPropagation();\r\n    const newState: any = this.undoRedo.getStateClone();\r\n    if (!newState.hDividers) {\r\n      newState.hDividers = 0;\r\n    }\r\n    const newIndex = newState.hDividers;\r\n    this.select('h' + newIndex, undefined);\r\n    newState.hDividers++;\r\n    this.undoRedo.publishChange(newState);\r\n  }\r\n\r\n  /**\r\n   * Add a new vDivider.\r\n   * @param e The mouse event.\r\n   */\r\n  addVDivider(e: MouseEvent) {\r\n    e.stopPropagation();\r\n    const newState: any = this.undoRedo.getStateClone();\r\n    if (!newState.vDividers) {\r\n      newState.vDividers = 0;\r\n    }\r\n    const newIndex = newState.vDividers;\r\n    this.select('v' + newIndex, undefined);\r\n    newState.vDividers++;\r\n    this.undoRedo.publishChange(newState);\r\n  }\r\n\r\n  /**\r\n   * Add a new radical.\r\n   * @param e The mouse event.\r\n   */\r\n  addRadical(e: MouseEvent) {\r\n    e.stopPropagation();\r\n    const newState: any = this.undoRedo.getStateClone();\r\n    if (!newState.radicals) {\r\n      newState.radicals = 0;\r\n    }\r\n    const newIndex = newState.radicals;\r\n    this.select('r' + newIndex, undefined);\r\n    newState.radicals++;\r\n    this.undoRedo.publishChange(newState);\r\n  }\r\n\r\n  /**\r\n   * Select a container or some content.\r\n   * @param ref The reference of the content.\r\n   *            Here a 'c' prefix is used for containers, which isn't valid in the context of a canvas controller.\r\n   * @param e The mouse event.\r\n   */\r\n  select(ref: string, e: MouseEvent) {\r\n    this.setAdding(ref);\r\n    if (e) {\r\n      e.stopPropagation();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Deselect whatever is selected.\r\n   */\r\n  deselect() {\r\n    this.selection.adding = undefined;\r\n    this.selection.selectedOnCanvas = undefined;\r\n  }\r\n\r\n  setAdding(toAdd: string) {\r\n    this.selection.adding = toAdd;\r\n  }\r\n\r\n  /**\r\n   * Delete the currently selected content.\r\n   * @param e The Mouse event.\r\n   */\r\n  delete(e: MouseEvent) {\r\n    e.stopPropagation();\r\n    const newState = this.undoRedo.getStateClone();\r\n    // We know it's a string, delete button only shows up for content\r\n    const ref = this.selection.adding as string;\r\n    const type = ref.charAt(0);\r\n    const index = parseInt(ref.substring(1, ref.length), 10);\r\n    switch (type) {\r\n      case 't':\r\n        newState.terms.splice(index, 1);\r\n        break;\r\n      case 'h':\r\n        newState.hDividers--;\r\n        break;\r\n      case 'r':\r\n        newState.radicals--;\r\n        break;\r\n      case 'v':\r\n        newState.vDividers--;\r\n        break;\r\n      default:\r\n        throw new Error('Undefined content type.');\r\n    }\r\n\r\n    // We've just removed the content from the arrays,\r\n    // so now any reference to content later in the\r\n    // array will be incorrect.\r\n    if (newState.steps) {\r\n      newState.steps.forEach(step => {\r\n        removeAndShiftContent(step.root);\r\n        // Color info also invalidated\r\n        if (step.color) {\r\n          removeDeletedKeys(step.color);\r\n        }\r\n        if (step.opacity) {\r\n          removeDeletedKeys(step.opacity);\r\n        }\r\n      });\r\n    }\r\n\r\n    // Remove the object from step options\r\n    if (newState.stepOpts) {\r\n      Object.keys(newState.stepOpts).forEach(stepNum => {\r\n        const stepOpts: TransitionOptionsFormat = newState.stepOpts[stepNum];\r\n        if (stepOpts.clones) {\r\n          stepOpts.clones = removeDeletedKeysOrValues(stepOpts.clones) as { [ref: string]: string};\r\n        }\r\n        if (stepOpts.evals) {\r\n          stepOpts.evals = removeDeletedKeysOrValues(stepOpts.evals) as { [ref: string]: string};\r\n        }\r\n        if (stepOpts.merges) {\r\n          stepOpts.merges = removeDeletedKeysOrValues(stepOpts.merges) as { [ref: string]: string};\r\n        }\r\n      });\r\n    }\r\n\r\n    this.deselect();\r\n    newState.metrics = getMetrics(newState);\r\n    this.undoRedo.publishChange(newState);\r\n\r\n    // For a container/content hierarchy, remove any reference\r\n    // to the content being removed, and shift other content\r\n    // so it still refers to the same thing.\r\n    function removeAndShiftContent(container: ContainerFormat) {\r\n      if (container.type === 'hbox' || container.type === 'vbox' || container.type === 'tightHBox') {\r\n        const cont = container as LinearContainerFormat;\r\n        removeOrShiftValues(cont.children, false);\r\n        // Doing this leaves 'holes' in the array, get rid of them:\r\n        cont.children = cont.children.filter(child => child !== null);\r\n\r\n      } else if (container.type === 'subSuper') {\r\n        const cont = container as SubSuperContainerFormat;\r\n        // Just recursively check the three components\r\n        removeAndShiftContent({type: 'hbox', children: cont.top} as ContainerFormat);\r\n        removeAndShiftContent({type: 'hbox', children: cont.middle} as ContainerFormat);\r\n        removeAndShiftContent({type: 'hbox', children: cont.bottom} as ContainerFormat);\r\n\r\n      } else if (container.type === 'quiz') {\r\n        const cont = container as QuizFormat;\r\n        // Just like a vbox, but answers is no longer valid:\r\n        cont.answers = [];\r\n        removeAndShiftContent({type: 'hbox', children: cont.children} as ContainerFormat);\r\n\r\n      } else if (container.type === 'root') {\r\n        const cont = container as RootContainerFormat;\r\n        // Check radical\r\n        if (ref === cont.rad) {\r\n          delete cont.rad;\r\n        } else if (type === 'r') {\r\n          // Check if need to shift radical down\r\n          const radIndex = parseInt(cont.rad.substring(1, cont.rad.length), 10);\r\n          if (radIndex > index) {\r\n            cont.rad = 'r' + (radIndex - 1);\r\n          }\r\n        }\r\n\r\n      } else if (container.type === 'table') {\r\n        const cont = container as TableFormat;\r\n        // Remove/shift lines\r\n        removeOrShiftValues(cont.hLines, false);\r\n        removeOrShiftValues(cont.vLines, false);\r\n        // Remove/shift child array\r\n        // tslint:disable-next-line:prefer-for-of\r\n        for (let r = 0; r < cont.children.length; r++) {\r\n          removeOrShiftValues(cont.children[r], true);\r\n        }\r\n      }\r\n    }\r\n\r\n    // Looks through the keys of an object to\r\n    // find deleted references.\r\n    function removeDeletedKeys(deleteIn: object) {\r\n      Object.keys(deleteIn).forEach(key => {\r\n        const val = deleteIn[key];\r\n        if (key.charAt(0) === type) {\r\n          // Same content type\r\n          const keyIndex = parseFloat(key.substring(1, key.length));\r\n          if (keyIndex === index) {\r\n            // Reference to deleted content, delete it\r\n            delete deleteIn[key];\r\n          } else if (keyIndex > index) {\r\n            // Deletion affected array, shift this key index down\r\n            const newKey = key.charAt(0) + (keyIndex - 1);\r\n            delete deleteIn[key];\r\n            deleteIn[newKey] = val;\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    // Delete the ref or shift down when necessary,\r\n    // looking in the keys of an object.\r\n    function removeOrShiftValues(lookIn: object, leaveNull: boolean) {\r\n      // Treat array as key/val pair\r\n      Object.keys(lookIn).forEach(childNum => {\r\n        const child = lookIn[childNum];\r\n        if (typeof child === 'string') {\r\n          // Is content, could be what we deleted\r\n          const childType = child.charAt(0);\r\n          const childIndex = parseInt(child.substring(1, child.length), 10);\r\n          if (child === ref) {\r\n            // Is what we deleted\r\n            if (leaveNull) {\r\n              lookIn[childNum] = null;\r\n            } else {\r\n              delete lookIn[childNum];\r\n            }\r\n          } else if (childType === type) {\r\n            // Is same type of content\r\n            if (childIndex > index) {\r\n              // Is above in array, need to shift down\r\n              lookIn[childNum] = childType + (childIndex - 1);\r\n            }\r\n          }\r\n        } else if (typeof child === 'object' && child !== null) {\r\n          // Is object, recursively check\r\n          removeAndShiftContent(child as ContainerFormat);\r\n        }\r\n      });\r\n    }\r\n\r\n    // Look through an object, removing the deleted reference\r\n    // whether it's in a key or value, moving others down into\r\n    // the removed space. Return the new object.\r\n    function removeDeletedKeysOrValues(deleteIn: object): object {\r\n      const toReturn = {};\r\n      // Transform to an array of arrays for easier processing\r\n      const asArray = Object.keys(deleteIn).map(key => [key, deleteIn[key]]);\r\n      // Find deleted values or ones that need to be shifted\r\n      asArray.forEach(keyValuePair => {\r\n        // Seperate key and value into their parts\r\n        let key = keyValuePair[0];\r\n        let value = keyValuePair[1];\r\n        const keyType = key.charAt(0);\r\n        const valType = key.charAt(0);\r\n        const keyIndex = parseInt(key.substring(1, key.length), 10);\r\n        const valIndex = parseInt(value.substring(1, value.length), 10);\r\n        if (key === ref || value === ref) {\r\n          // Do nothing, doesn't get transferred to new object\r\n          return;\r\n        }\r\n        // Check if key needs to be moved down\r\n        if (keyType === type && keyIndex > index) {\r\n          key = keyType + (keyIndex - 1);\r\n        }\r\n        // Check if value needs to be moved down\r\n        if (valType === type && valIndex > index) {\r\n          value = valType + (valIndex - 1);\r\n        }\r\n        // Add to the new object\r\n        toReturn[key] = value;\r\n      });\r\n      return toReturn;\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * Show the term template with commonly used\r\n   * text.\r\n   */\r\n  showTermTemplate() {\r\n    this.modal.show(TermTemplateComponent);\r\n  }\r\n\r\n  /**\r\n   * Update the view when the state changes.\r\n   * @param newState The new state.\r\n   */\r\n  updateState(newState: any) {\r\n    this.terms = newState.terms ? newState.terms : [];\r\n    this.hDividers = newState.hDividers ? newState.hDividers : 0;\r\n    this.vDividers = newState.vDividers ? newState.vDividers : 0;\r\n    this.radicals = newState.radicals ? newState.radicals : 0;\r\n    this.addingTerm = false;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport CreatorCanvasController from './central-area/CreatorCanvasController';\r\nimport { ContainerFormat } from '@shared/main/FileFormat';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ContentSelectionService {\r\n\r\n  containerObjGetters: (() => ContainerFormat)[] = [\r\n    () => {\r\n      return {\r\n        type: 'hbox',\r\n        children: []\r\n      };\r\n    },\r\n    () => {\r\n      return {\r\n        type: 'vbox',\r\n        children: []\r\n      };\r\n    },\r\n    () => {\r\n      return {\r\n        type: 'tightHBox',\r\n        children: []\r\n      };\r\n    },\r\n    () => {\r\n      return {\r\n        type: 'root',\r\n        idx: [],\r\n        arg: []\r\n      };\r\n    },\r\n    () => {\r\n      return {\r\n          type: 'subSuper',\r\n          top: [],\r\n          middle: [],\r\n          bottom: []\r\n      };\r\n    },\r\n    () => {\r\n      return {\r\n        type: 'quiz',\r\n        children: [],\r\n        answers: []\r\n      };\r\n    },\r\n    () => {\r\n      return {\r\n        type: 'table',\r\n        children: [\r\n          [null]\r\n        ],\r\n        hLines: {},\r\n        vLines: {}\r\n      };\r\n    }\r\n  ];\r\n\r\n  // The reference of what is selected on the pane.\r\n  // For containers, the prefix 'c' is used which\r\n  // is not valid in the context of the player.\r\n  // addingContainer() and getContainer() must be used\r\n  // to check for this.\r\n  private addingVar: string;\r\n\r\n  // The listeners that will be run when the above\r\n  // variable\r\n  private addingListeners: (() => void)[] = [];\r\n\r\n  // The reference of what is selected on the canvas,\r\n  // with the same 'c' prefix for containers as above.\r\n  private selectedOnCanvasVar: string;\r\n\r\n  private selectedOnCanvasListeners: (() => void)[] = [];\r\n\r\n  // The singleton instance of CreatorCanvasController.\r\n  canvasInstance: CreatorCanvasController;\r\n\r\n  constructor() { }\r\n\r\n  get selectedOnCanvas() {\r\n    return this.selectedOnCanvasVar;\r\n  }\r\n\r\n  set selectedOnCanvas(newSelectedOnCanvas: string) {\r\n    this.selectedOnCanvasVar = newSelectedOnCanvas;\r\n    this.selectedOnCanvasListeners.forEach(listener => {\r\n      listener();\r\n    });\r\n  }\r\n\r\n  get adding() {\r\n    return this.addingVar;\r\n  }\r\n\r\n  set adding(newAdding: string) {\r\n    this.addingVar = newAdding;\r\n    this.selectedOnCanvas = undefined;\r\n    this.addingListeners.forEach(listener => {\r\n      listener();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Add a new listener that will be run when the\r\n   * 'adding' variable changes.\r\n   * @param listener The new listener.\r\n   */\r\n  addAddListener(listener: () => void) {\r\n    this.addingListeners.push(listener);\r\n  }\r\n\r\n  /**\r\n   * Add a new listener that will be run when the\r\n   * 'selectedOnCanvas' variable changes.\r\n   * @param listener The new listener.\r\n   */\r\n  addSelectedOnCanvasListener(listener: () => void) {\r\n    this.selectedOnCanvasListeners.push(listener);\r\n  }\r\n\r\n  /**\r\n   * Remove all current selected on canvas listeners.\r\n   */\r\n  resetSelectedOnCanvasListeners() {\r\n    this.addingListeners = [];\r\n  }\r\n\r\n  /**\r\n   * Returns whether we are adding a container.\r\n   */\r\n  addingContainer(): boolean {\r\n    return this.adding.charAt(0) === 'c';\r\n  }\r\n\r\n  /**\r\n   * Returns the object representation of the\r\n   * container we are adding.\r\n   */\r\n  getContainer(): ContainerFormat {\r\n    const type = this.adding.charAt(0);\r\n    if (type !== 'c') {\r\n      throw new Error('Cannot add container. The type of adding is not a container.');\r\n    }\r\n    const idx = parseFloat(this.adding.substring(1, this.adding.length));\r\n    return this.containerObjGetters[idx]();\r\n  }\r\n\r\n  /**\r\n   * Whether a container is selected on the\r\n   * canvas.\r\n   */\r\n  containerSelected(): boolean {\r\n    return this.selectedOnCanvas.charAt(0) === 'c';\r\n  }\r\n}\r\n","module.exports = \"#outer {\\r\\n    padding: 10px;\\r\\n    color: rgba(255, 255, 255, 0.9);\\r\\n}\\r\\n\\r\\nul {\\r\\n    list-style: disc inside none;\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvY3VzdG9tLWZvbnQtbG9hZC1mYWlsL2N1c3RvbS1mb250LWxvYWQtZmFpbC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksYUFBYTtJQUNiLCtCQUErQjtBQUNuQzs7QUFFQTtJQUNJLDRCQUE0QjtBQUNoQyIsImZpbGUiOiJzcmMvYXBwL2N1c3RvbS1mb250LWxvYWQtZmFpbC9jdXN0b20tZm9udC1sb2FkLWZhaWwuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIiNvdXRlciB7XHJcbiAgICBwYWRkaW5nOiAxMHB4O1xyXG4gICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC45KTtcclxufVxyXG5cclxudWwge1xyXG4gICAgbGlzdC1zdHlsZTogZGlzYyBpbnNpZGUgbm9uZTtcclxufSJdfQ== */\"","module.exports = \"<div id=\\\"outer\\\">\\r\\n    <p>\\r\\n        Couldn't load the custom font. The animation will still be saved with this font,\\r\\n        and the player will also attempt to load it. There are a few reasons the creator\\r\\n        may not be able to load the custom font:\\r\\n      </p>\\r\\n      <ul>\\r\\n        <li>\\r\\n          The URL given is relative to where the animation file will be hosted, and the\\r\\n          creator is not hosted from the same place.\\r\\n        </li>\\r\\n        <li>\\r\\n          The website where the font is hosted does not allow cross-origin requests to\\r\\n          the font.\\r\\n        </li>\\r\\n        <li>\\r\\n          The URL given is incorrect, or the font is not available in the chosen style.\\r\\n        </li>\\r\\n      </ul>\\r\\n      <div style=\\\"display: flex\\\">\\r\\n        <span class=\\\"button\\\" (click)=\\\"modal.remove()\\\">\\r\\n          Ok\\r\\n        </span>\\r\\n      </div>      \\r\\n</div>\"","import { Component, OnInit } from '@angular/core';\r\nimport { ModalService } from '../modal.service';\r\n\r\n@Component({\r\n  selector: 'app-custom-font-load-fail',\r\n  templateUrl: './custom-font-load-fail.component.html',\r\n  styleUrls: ['./custom-font-load-fail.component.css']\r\n})\r\nexport class CustomFontLoadFailComponent implements OnInit {\r\n\r\n  constructor(private modal: ModalService) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { creatorErrorTimeout } from '@shared/main/consts';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ErrorService {\r\n\r\n  private textVar: string;\r\n  active: boolean;\r\n  private timeoutID;\r\n\r\n  constructor() { }\r\n\r\n  get text() {\r\n    return this.textVar;\r\n  }\r\n\r\n  set text(newText: string) {\r\n    this.textVar = newText;\r\n    this.active = true;\r\n    if (this.timeoutID) {\r\n      clearInterval(this.timeoutID);\r\n    }\r\n    this.timeoutID = setTimeout(() => {\r\n      this.active = false;\r\n    }, creatorErrorTimeout);\r\n  }\r\n}\r\n","module.exports = \"p {\\r\\n    padding: 10px 0px;\\r\\n    color: rgba(255, 255, 255, 0.8);\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvZm9udC1zZXR0aW5ncy9mb250LXNldHRpbmdzLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxpQkFBaUI7SUFDakIsK0JBQStCO0FBQ25DIiwiZmlsZSI6InNyYy9hcHAvZm9udC1zZXR0aW5ncy9mb250LXNldHRpbmdzLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyJwIHtcclxuICAgIHBhZGRpbmc6IDEwcHggMHB4O1xyXG4gICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC44KTtcclxufSJdfQ== */\"","module.exports = \"<div class=\\\"title\\\">Font Type</div>\\r\\n<select #fontType (select)=\\\"fontTypeChanged($event.target.value);\\\">\\r\\n  <option value=\\\"default\\\">Default Font</option>\\r\\n  <option value=\\\"google fonts\\\">Font from Google Fonts</option>\\r\\n  <option value=\\\"custom font\\\">Custom Font</option>\\r\\n</select>\\r\\n\\r\\n<!-- Options for Google fonts -->\\r\\n<div *ngIf=\\\"fontType.value === 'google fonts'\\\">\\r\\n  <p>Browse Google Fonts <a href=\\\"https://fonts.google.com\\\" target=\\\"blank\\\">here</a> and find a font and style.</p>\\r\\n  <div class=\\\"title\\\">Font Name</div>\\r\\n  <p>For example: 'Lato'</p>\\r\\n  <input type=\\\"text\\\" #gfName>\\r\\n  <div class=\\\"title\\\">Font Weight</div>\\r\\n  <p>Not all of the weights below may be available. To check, select the font on Google Fonts and navigate to 'customize'.</p>\\r\\n  <select #gfFontWeight>\\r\\n    <option value=\\\"100\\\">100 (Thin)</option>\\r\\n    <option value=\\\"200\\\">200</option>\\r\\n    <option value=\\\"300\\\">300 (Light)</option>\\r\\n    <option value=\\\"400\\\">400 (Regular)</option>\\r\\n    <option value=\\\"500\\\">500 (Medium)</option>\\r\\n    <option value=\\\"600\\\">600</option>\\r\\n    <option value=\\\"700\\\">700 (Bold)</option>\\r\\n    <option value=\\\"800\\\">800 (Black)</option>\\r\\n  </select>\\r\\n  <div class=\\\"title\\\">Font Style</div>\\r\\n  <input type=\\\"checkbox\\\" #gfItalic>Make this font italic.<br>\\r\\n</div>\\r\\n\\r\\n<!-- Options for Custom fonts -->\\r\\n<div *ngIf=\\\"fontType.value === 'custom font'\\\">\\r\\n  <div class=\\\"title\\\">Name</div>\\r\\n  <p>\\r\\n    Can be anything, as long as it isn't the name of another font used on the same page.\\r\\n  </p>\\r\\n  <input type=\\\"text\\\" #cfName>\\r\\n  <div class=\\\"title\\\">Weight</div>\\r\\n  <select #cfFontWeight>\\r\\n      <option value=\\\"100\\\">100 (Thin)</option>\\r\\n      <option value=\\\"200\\\">200</option>\\r\\n      <option value=\\\"300\\\">300 (Light)</option>\\r\\n      <option value=\\\"400\\\">400 (Regular)</option>\\r\\n      <option value=\\\"500\\\">500 (Medium)</option>\\r\\n      <option value=\\\"600\\\">600</option>\\r\\n      <option value=\\\"700\\\">700 (Bold)</option>\\r\\n      <option value=\\\"800\\\">800 (Black)</option>\\r\\n    </select>\\r\\n    <div class=\\\"title\\\">Style</div>\\r\\n    <input type=\\\"checkbox\\\" #cfItalic>Make this font italic.<br>\\r\\n    <div class=\\\"title\\\">URL</div>\\r\\n    <p>\\r\\n      The relative path or URL to where your font can be found.\\r\\n      For example:<br>\\r\\n      fonts/my-font.otf<br>\\r\\n      Or:<br>\\r\\n      www.mywebsite.com/fonts/my-font.ttf\\r\\n    </p>\\r\\n    <input type=\\\"text\\\" #cfURL>\\r\\n</div>\\r\\n\\r\\n<div style=\\\"display: flex;\\\">\\r\\n  <span class=\\\"button\\\" (click)=\\\"apply()\\\">Apply</span>\\r\\n</div>\\r\\n\\r\\n<p *ngIf=\\\"loadingText\\\">\\r\\n  loading...\\r\\n</p>\\r\\n\\r\\n<p *ngIf=\\\"errorText\\\">\\r\\n  Couldn't find that font. Double check the font name, and make sure it's available in the\\r\\n  selected style.\\r\\n</p>\"","import { Component, OnInit, ViewChild, ElementRef, AfterViewInit, ChangeDetectorRef } from '@angular/core';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport { FontUpdateService } from '../font-update.service';\r\nimport { ModalService } from '../modal.service';\r\nimport { CustomFontLoadFailComponent } from '../custom-font-load-fail/custom-font-load-fail.component';\r\nimport { getMetrics } from '@shared/main/helpers';\r\n\r\n@Component({\r\n  selector: 'app-font-settings',\r\n  templateUrl: './font-settings.component.html',\r\n  styleUrls: ['./font-settings.component.css']\r\n})\r\nexport class FontSettingsComponent implements OnInit, AfterViewInit {\r\n\r\n  @ViewChild('fontType')\r\n  fontType: ElementRef<HTMLSelectElement>;\r\n\r\n  @ViewChild('gfName')\r\n  googleFontName: ElementRef<HTMLInputElement>;\r\n\r\n  @ViewChild('gfFontWeight')\r\n  googleFontWeight: ElementRef<HTMLSelectElement>;\r\n\r\n  @ViewChild('gfItalic')\r\n  googleFontItalic: ElementRef<HTMLInputElement>;\r\n\r\n  @ViewChild('cfName')\r\n  customFontName: ElementRef<HTMLInputElement>;\r\n\r\n  @ViewChild('cfFontWeight')\r\n  customFontWeight: ElementRef<HTMLSelectElement>;\r\n\r\n  @ViewChild('cfItalic')\r\n  customFontItalic: ElementRef<HTMLInputElement>;\r\n\r\n  @ViewChild('cfURL')\r\n  customFontURL: ElementRef<HTMLInputElement>;\r\n\r\n  loadingText = false;\r\n  errorText = false;\r\n\r\n  constructor(private undoRedo: UndoRedoService,\r\n              private cd: ChangeDetectorRef,\r\n              private fontLoader: FontUpdateService,\r\n              private modal: ModalService) {}\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    // Initialize UI with the current font\r\n    const currState: any = this.undoRedo.getState();\r\n    if (currState.font || currState.saveLaterFont) {\r\n      const font = currState.saveLaterFont ? currState.saveLaterFont : currState.font;\r\n      if (font.type === 'g') {\r\n        this.fontType.nativeElement.value = 'google fonts';\r\n        this.cd.detectChanges();\r\n        // Name contains actual name, weight, and italic\r\n        const fullName: string = font.name;\r\n        const nameSplit = fullName.split(':');\r\n        const name = nameSplit[0];\r\n        this.googleFontName.nativeElement.value = name;\r\n        // Check if italic\r\n        let weightAndItalic = nameSplit[1];\r\n        if (weightAndItalic.charAt(weightAndItalic.length - 1) === 'i') {\r\n          // Italic\r\n          this.googleFontItalic.nativeElement.checked = true;\r\n          // Trim to be just the weight\r\n          weightAndItalic = weightAndItalic.substring(0, weightAndItalic.length - 1);\r\n        } else {\r\n          this.googleFontItalic.nativeElement.checked = false;\r\n        }\r\n        this.googleFontWeight.nativeElement.value = weightAndItalic;\r\n      } else if (font.type === 'c') {\r\n        // Current font is custom\r\n        this.fontType.nativeElement.value = 'custom font';\r\n        this.cd.detectChanges();\r\n        this.customFontName.nativeElement.value = font.name;\r\n        this.customFontItalic.nativeElement.checked = font.style === 'italic';\r\n        this.customFontWeight.nativeElement.value = font.weight;\r\n        this.customFontURL.nativeElement.value = font.src;\r\n      }\r\n    }\r\n    this.cd.detectChanges();\r\n  }\r\n\r\n  /**\r\n   * Load the font, showing an error if it can't be loaded.\r\n   */\r\n  apply() {\r\n    const fontType = this.fontType.nativeElement.value;\r\n    if (fontType === 'default') {\r\n      // Don't need to load anything.\r\n      // Erase any custom font.\r\n      const newState: any = this.undoRedo.getStateClone();\r\n      delete newState.font;\r\n      delete newState.saveLaterFont;\r\n      newState.metrics = getMetrics(newState);\r\n      this.undoRedo.publishChange(newState);\r\n      this.modal.remove();\r\n    } else if (fontType === 'google fonts') {\r\n        // Load the google font\r\n        this.loadingText = true;\r\n        const name = this.googleFontName.nativeElement.value;\r\n        const weight = this.googleFontWeight.nativeElement.value;\r\n        const italic = this.googleFontItalic.nativeElement.checked ? 'i' : '';\r\n        const fontObj = {\r\n          type: 'g',\r\n          name: name + ':' + weight + italic\r\n        };\r\n        // If successful\r\n        const onSuccess = () => {\r\n          const newState: any = this.undoRedo.getStateClone();\r\n          delete newState.saveLaterFont;\r\n          newState.font = fontObj;\r\n          newState.metrics = getMetrics(newState);\r\n          this.undoRedo.publishChange(newState);\r\n          this.modal.remove();\r\n        };\r\n        // If unsuccessful\r\n        const onFail = () => {\r\n          this.loadingText = false;\r\n          this.errorText = true;\r\n        };\r\n        this.fontLoader.load(fontObj, onSuccess, onFail);\r\n    } else if (fontType === 'custom font') {\r\n        // Load the custom font\r\n        const fontName = this.customFontName.nativeElement.value;\r\n        const fontStyle = this.customFontItalic.nativeElement.checked ? 'italic' : 'normal';\r\n        const fontWeight = this.customFontWeight.nativeElement.value;\r\n        const fontSrc = this.customFontURL.nativeElement.value;\r\n        const fontObj = {\r\n          type: 'c',\r\n          name: fontName,\r\n          style: fontStyle,\r\n          weight: fontWeight,\r\n          src: fontSrc\r\n        };\r\n        // If successful\r\n        const onSuccess = () => {\r\n          const newState: any = this.undoRedo.getStateClone();\r\n          delete newState.saveLaterFont;\r\n          newState.font = fontObj;\r\n          newState.metrics = getMetrics(newState);\r\n          this.undoRedo.publishChange(newState);\r\n          this.modal.remove();\r\n        };\r\n        // If fail\r\n        const onFail = () => {\r\n          const newState: any = this.undoRedo.getStateClone();\r\n          delete newState.font;\r\n          newState.saveLaterFont = fontObj;\r\n          newState.metrics = getMetrics(newState);\r\n          this.undoRedo.publishChange(newState);\r\n          this.modal.remove();\r\n          setTimeout(() => {\r\n            this.modal.show(CustomFontLoadFailComponent);\r\n          }, 10);\r\n        };\r\n        this.fontLoader.load(fontObj, onSuccess, onFail);\r\n    }\r\n  }\r\n}\r\n","import { Injectable, OnInit } from '@angular/core';\r\nimport * as WebFont from 'webfontloader';\r\nimport { FontFormat, GoogleFontFormat, CustomFontFormat } from '@shared/main/FileFormat';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class FontUpdateService implements OnInit {\r\n\r\n  // Stores the font face declarations\r\n  // for loaded fonts.\r\n  private styleEl: Element;\r\n\r\n  constructor() {\r\n    this.styleEl = document.createElement('style');\r\n    document.head.appendChild(this.styleEl);\r\n  }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  /**\r\n   * Attempt to load a font, call a callback\r\n   * on success or failure.\r\n   * @param fontObj An object representing the font to load. In the same format as\r\n   *                that of the JSON files.\r\n   * @param onSuccess Called when the loading of the font was successful. After this,\r\n   *                  the font is loaded and can be used in Canvas instances.\r\n   * @param onFail Called when the loading of the font was unsuccessful.\r\n   */\r\n  load(fontObj: FontFormat, onSuccess: () => void, onFail: () => void) {\r\n    // Parse the font object\r\n    let loadObj: WebFont.Config;\r\n    if (fontObj.type === 'g') {\r\n      // Load google font\r\n      const font = fontObj as GoogleFontFormat;\r\n      loadObj = {\r\n        google: {\r\n          families: [font.name]\r\n        }\r\n      };\r\n    } else if (fontObj.type === 'c') {\r\n      // Load custom font\r\n      // Add a font face declaration\r\n      const font = fontObj as CustomFontFormat;\r\n      const fontFaceText =\r\n                    '@font-face {' +\r\n                        'font-family: ' + font.name + ';' +\r\n                        'font-style: ' + font.style + ';' +\r\n                        'font-weight: ' + font.weight + ';' +\r\n                        'src: url(' + font.src + ');' +\r\n                    '}';\r\n      this.styleEl.appendChild(document.createTextNode(fontFaceText));\r\n      // Create the object for the loader\r\n      let loaderString = font.name + ':';\r\n      if (font.style === 'normal') {\r\n        loaderString += 'n';\r\n      } else if (font.style === 'italic') {\r\n        loaderString += 'i';\r\n      } else {\r\n        throw new Error('Unrecognized custom font style');\r\n      }\r\n      loaderString += font.weight;\r\n      loadObj = {\r\n        custom: {\r\n          families: [loaderString]\r\n        }\r\n      };\r\n    } else {\r\n      throw new Error('Unrecognized font object type');\r\n    }\r\n    // Load the font\r\n    loadObj.active = onSuccess;\r\n    loadObj.inactive = onFail;\r\n    WebFont.load(loadObj);\r\n  }\r\n}\r\n","import { ContainerFormat } from '@shared/main/FileFormat';\r\nimport _ from 'lodash';\r\n\r\n/**\r\n * Recursively checks if a reference\r\n * exists inside a step layout.\r\n * @param toCheck The step layout to check.\r\n * @param ref The ref to look for.\r\n */\r\nexport function inLayout(toCheck: ContainerFormat, ref: string): boolean {\r\n    let found = false;\r\n    if (!toCheck) {\r\n        return found;\r\n    }\r\n    Object.keys(toCheck).forEach(key => {\r\n        const value = toCheck[key];\r\n        if (typeof value === 'object') {\r\n            if (inLayout(value, ref)) {\r\n                found = true;\r\n            }\r\n        } else if (typeof value === 'string') {\r\n            if (value === ref) {\r\n                found = true;\r\n            }\r\n        }\r\n    });\r\n    return found;\r\n}\r\n\r\n/**\r\n * Deeply clones an object, ie clones it\r\n * and all of its child objects.\r\n * @param toClone The object to clone.\r\n */\r\nexport function deepClone(toClone: object): object {\r\n    return _.cloneDeep(toClone);\r\n}\r\n\r\n/**\r\n * Capitalize the first letter of a string.\r\n * @param str String to capitalize.\r\n */\r\nexport const cap = (str: string) => str.charAt(0).toUpperCase() + str.slice(1);\r\n/**\r\n * Decapitalize the first letter of a string.\r\n * @param str String to de-capitalize.\r\n */\r\nexport const deCap = (str: string) => str.charAt(0).toLowerCase() + str.slice(1);\r\n","module.exports = \"p {\\r\\n    font-size: 12px;\\r\\n    text-align: center;\\r\\n    color: rgba(229,57,53, 1);\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvbG9hZC9sb2FkLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxlQUFlO0lBQ2Ysa0JBQWtCO0lBQ2xCLHlCQUF5QjtBQUM3QiIsImZpbGUiOiJzcmMvYXBwL2xvYWQvbG9hZC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsicCB7XHJcbiAgICBmb250LXNpemU6IDEycHg7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICBjb2xvcjogcmdiYSgyMjksNTcsNTMsIDEpO1xyXG59Il19 */\"","module.exports = \"<div class=\\\"title\\\">FILE</div>\\r\\n<input #input type=\\\"file\\\" accept=\\\".json\\\">\\r\\n<div class=\\\"title\\\">PASTE</div>\\r\\n<textarea #textArea rows=\\\"6\\\" cols=\\\"55\\\"></textarea>\\r\\n<div style=\\\"display: flex; flex-direction: column; align-items: center;\\\">\\r\\n  <p>Loading will erase the current project! If you want to keep it, save first.</p>\\r\\n  <span class=\\\"button\\\" (click)=\\\"load();\\\">Load</span>\\r\\n</div>\\r\\n<p *ngIf=\\\"showLoading\\\">\\r\\n  loading...\\r\\n</p>\"","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport { ModalService } from '../modal.service';\r\nimport { ErrorService } from '../error.service';\r\nimport { SelectedStepService } from '../selected-step.service';\r\nimport { FontUpdateService } from '../font-update.service';\r\nimport { getMetrics } from '@shared/main/helpers';\r\nimport { defaultFontFamily, defaultFontWeight } from '@shared/main/consts';\r\n\r\n@Component({\r\n  selector: 'app-load',\r\n  templateUrl: './load.component.html',\r\n  styleUrls: ['./load.component.css']\r\n})\r\nexport class LoadComponent implements OnInit {\r\n\r\n  @ViewChild('input')\r\n  inputEl: ElementRef;\r\n\r\n  @ViewChild('textArea')\r\n  textAreaEl: ElementRef;\r\n\r\n  showLoading = false;\r\n\r\n  constructor(private undoRedo: UndoRedoService,\r\n              private modal: ModalService,\r\n              private error: ErrorService,\r\n              private step: SelectedStepService,\r\n              private fontLoader: FontUpdateService) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  /**\r\n   * Load the uploaded file/pasted text.\r\n   */\r\n  load() {\r\n    if (this.inputEl.nativeElement.files.length > 0) {\r\n      // File has been uploaded\r\n      const reader = new FileReader();\r\n      reader.addEventListener('load', () => {\r\n        this.loadFile(reader.result as string);\r\n      });\r\n      reader.readAsText(this.inputEl.nativeElement.files[0]);\r\n    } else {\r\n      // No file, check textarea instead\r\n      this.loadFile(this.textAreaEl.nativeElement.value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Once the file has been retrieved as a\r\n   * string, loads it.\r\n   * @param fileStr The file as a string.\r\n   */\r\n  loadFile(fileStr: string) {\r\n    const oldHistory = this.undoRedo.getHistory();\r\n    const oldStep = this.step.selected;\r\n    try {\r\n      const fileObj: any = JSON.parse(fileStr);\r\n      // Load the font that the animation uses\r\n      this.showLoading = true;\r\n      const defaultFontObj = {\r\n        type: 'g',\r\n        name: defaultFontFamily + ':' + defaultFontWeight\r\n      };\r\n      const fontToLoad = fileObj.font ? fileObj.font : defaultFontObj;\r\n      // Function to actually load\r\n      const finishLoad = () => {\r\n        this.undoRedo.erase();\r\n        fileObj.metrics = getMetrics(fileObj);\r\n        this.undoRedo.publishChange(fileObj);\r\n        this.modal.remove();\r\n      };\r\n      // If font fails to load\r\n      const loadFail = () => {\r\n        finishLoad();\r\n        this.error.text = 'Failed to Load Font';\r\n      };\r\n      this.fontLoader.load(fontToLoad, finishLoad, loadFail);\r\n    } catch (e) {\r\n      console.log(e);\r\n      this.undoRedo.setHistory(oldHistory);\r\n      this.step.selected = oldStep;\r\n      this.error.text = 'Invalid File';\r\n    }\r\n  }\r\n\r\n}\r\n","import { Directive, ViewContainerRef } from '@angular/core';\r\n\r\n@Directive({\r\n  selector: '[appModalHost]'\r\n})\r\nexport class ModalDirective {\r\n\r\n  constructor(public viewContainerRef: ViewContainerRef) { }\r\n\r\n}\r\n","import { Injectable, ComponentFactoryResolver, ComponentRef } from '@angular/core';\r\nimport { AppComponent } from './app.component';\r\nimport { ModalDirective } from './modal.directive';\r\n\r\n/**\r\n * Provides methods for any component to\r\n * add a component inside a modal and\r\n * display it.\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ModalService {\r\n\r\n  private appComponentVar: AppComponent;\r\n  private innerComponentRef: ComponentRef<any>;\r\n\r\n  constructor(private compFactRes: ComponentFactoryResolver) { }\r\n\r\n  set appComponent(newAppComponent) {\r\n    this.appComponentVar = newAppComponent;\r\n  }\r\n\r\n  /**\r\n   * Show the modal and display\r\n   * a component inside it.\r\n   * @param The TYPE of the component to display.\r\n   */\r\n  show(component) {\r\n    this.appComponentVar.onModalShow = (modalHost: ModalDirective) => {\r\n      const factory = this.compFactRes.resolveComponentFactory(component);\r\n      const viewContainer = modalHost.viewContainerRef;\r\n      viewContainer.clear();\r\n      this.innerComponentRef = viewContainer.createComponent(factory);\r\n      this.appComponentVar.cd.detectChanges();\r\n    };\r\n    this.appComponentVar.displayingModal = true;\r\n  }\r\n\r\n  /**\r\n   * Remove the modal.\r\n   */\r\n  remove() {\r\n    this.innerComponentRef.destroy();\r\n    this.appComponentVar.modalHost.viewContainerRef.clear();\r\n    this.appComponentVar.displayingModal = false;\r\n  }\r\n}\r\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3ByZXZpZXcvcHJldmlldy5jb21wb25lbnQuY3NzIn0= */\"","module.exports = \"<div class=\\\"eqContainer\\\" #eqContainer></div>\\r\\n\"","import { Component, AfterViewInit, ViewChild, ElementRef } from '@angular/core';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport CanvasController from '@shared/main/CanvasController';\r\n\r\n@Component({\r\n  selector: 'app-preview',\r\n  templateUrl: './preview.component.html',\r\n  styleUrls: ['./preview.component.css']\r\n})\r\nexport class PreviewComponent implements AfterViewInit {\r\n\r\n  @ViewChild('eqContainer')\r\n  eqContainerEl: ElementRef;\r\n\r\n  constructor(private undoRedo: UndoRedoService) { }\r\n\r\n  ngAfterViewInit() {\r\n    const canv = new CanvasController(this.eqContainerEl.nativeElement, this.undoRedo.getState());\r\n  }\r\n}\r\n","module.exports = \".durationRow {\\r\\n    display: flex;\\r\\n    justify-content: space-between;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n.durationTitle {\\r\\n    font-style: italic;\\r\\n}\\r\\n\\r\\n.slider {\\r\\n    margin-right: 10px;\\r\\n}\\r\\n\\r\\n.textBox {\\r\\n    width: 50px;\\r\\n    margin-right: 10px;\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcHJvamVjdC1vcHRpb25zL3Byb2plY3Qtb3B0aW9ucy5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksYUFBYTtJQUNiLDhCQUE4QjtJQUM5QixtQkFBbUI7QUFDdkI7O0FBRUE7SUFDSSxrQkFBa0I7QUFDdEI7O0FBRUE7SUFDSSxrQkFBa0I7QUFDdEI7O0FBRUE7SUFDSSxXQUFXO0lBQ1gsa0JBQWtCO0FBQ3RCIiwiZmlsZSI6InNyYy9hcHAvcHJvamVjdC1vcHRpb25zL3Byb2plY3Qtb3B0aW9ucy5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmR1cmF0aW9uUm93IHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG59XHJcblxyXG4uZHVyYXRpb25UaXRsZSB7XHJcbiAgICBmb250LXN0eWxlOiBpdGFsaWM7XHJcbn1cclxuXHJcbi5zbGlkZXIge1xyXG4gICAgbWFyZ2luLXJpZ2h0OiAxMHB4O1xyXG59XHJcblxyXG4udGV4dEJveCB7XHJcbiAgICB3aWR0aDogNTBweDtcclxuICAgIG1hcmdpbi1yaWdodDogMTBweDtcclxufSJdfQ== */\"","module.exports = \"<span>Play as one animation </span><input type=\\\"checkbox\\\" [(ngModel)]=\\\"isAutoplay\\\">\\n<div class=\\\"durationRow\\\" *ngIf=\\\"isAutoplay\\\">\\n  <span class=\\\"durationTitle\\\">Delay Before Ending: </span>\\n  <span class=\\\"durationRow\\\">\\n    <input class=\\\"textBox\\\" type=\\\"number\\\" [(ngModel)]=\\\"endDelay\\\">\\n    <input class=\\\"slider\\\" type=\\\"range\\\" min=\\\"0\\\" max=\\\"2000\\\" [(ngModel)]=\\\"endDelay\\\">\\n  </span>\\n</div>\\n<div style=\\\"display: flex\\\">\\n  <span class=\\\"button\\\" (click)=\\\"apply()\\\">Apply</span>\\n</div>\"","import { Component, OnInit } from '@angular/core';\nimport { UndoRedoService } from '../undo-redo.service';\nimport { ModalService } from '../modal.service';\n\n@Component({\n  selector: 'app-project-options',\n  templateUrl: './project-options.component.html',\n  styleUrls: ['./project-options.component.css']\n})\nexport class ProjectOptionsComponent implements OnInit {\n\n  isAutoplay: boolean;\n  endDelay: number;\n\n  constructor(private undoRedo: UndoRedoService,\n              private modal: ModalService) { }\n\n  ngOnInit() {\n    const currState = this.undoRedo.getState();\n    this.isAutoplay = currState.autoplay !== undefined;\n    if (currState.autoplay && currState.autoplay.delays && currState.autoplay.delays[currState.steps.length - 1] !== undefined) {\n      // End delay already defined\n      this.endDelay = currState.autoplay.delays[currState.steps.length - 1];\n    } else {\n      // Use default\n      this.endDelay = 500;\n    }\n  }\n\n  /**\n   * Apply the changes.\n   */\n  apply() {\n    const newState = this.undoRedo.getStateClone();\n    if (newState.autoplay !== undefined && !this.isAutoplay) {\n      // Remove autoplay\n      delete newState.autoplay;\n    } else if (newState.autoplay === undefined && this.isAutoplay) {\n      // Add autoplay\n      newState.autoplay = {};\n      newState.autoplay.delays = {};\n      if (this.endDelay !== 0) {\n        newState.autoplay.delays[newState.steps.length - 1] = this.endDelay;\n      }\n    } else if (newState.autoplay !== undefined) {\n      // Autoplay on before, and still on now.\n      // Update delay\n      if (!newState.autoplay.delays) {\n        // No delays defined at all\n        newState.autoplay.delays = {};\n      }\n      newState.autoplay.delays[newState.steps.length - 1] = this.endDelay;\n    } // Other case is autoplay off before and after, in which case do nothing\n\n    // Save change and close\n    this.undoRedo.publishChange(newState);\n    this.modal.remove();\n  }\n\n}\n","module.exports = \".selectRow {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    margin-bottom: 10px;\\r\\n}\\r\\n\\r\\ninput {\\r\\n    margin: 10px;\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcXVpei1jb25maWd1cmF0aW9uL3F1aXotY29uZmlndXJhdGlvbi5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksYUFBYTtJQUNiLG1CQUFtQjtJQUNuQixtQkFBbUI7QUFDdkI7O0FBRUE7SUFDSSxZQUFZO0FBQ2hCIiwiZmlsZSI6InNyYy9hcHAvcXVpei1jb25maWd1cmF0aW9uL3F1aXotY29uZmlndXJhdGlvbi5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnNlbGVjdFJvdyB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgIG1hcmdpbi1ib3R0b206IDEwcHg7XHJcbn1cclxuXHJcbmlucHV0IHtcclxuICAgIG1hcmdpbjogMTBweDtcclxufSJdfQ== */\"","module.exports = \"<div class=\\\"title\\\">SELECT ANSWERS</div>\\n<div class=\\\"selectRow\\\" *ngFor=\\\"let answer of answers; index as idx; trackBy: trackByIndex\\\">\\n  <input type=\\\"checkbox\\\" [(ngModel)]=\\\"answers[idx]\\\">\\n  <div #eqContainer class=\\\"eqContainer\\\"></div>\\n</div>\\n<div style=\\\"display: flex\\\">\\n  <div class=\\\"button\\\" (click)=\\\"apply()\\\">Apply</div>\\n</div>\\n\"","import { Component, QueryList, ViewChildren, ElementRef, AfterViewInit } from '@angular/core';\r\nimport { ContentSelectionService } from '../content-selection.service';\r\nimport { QuizFormat, FileFormat, ContainerFormat, LinearContainerFormat } from '@shared/main/FileFormat';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport { ModalService } from '../modal.service';\r\nimport { deepClone } from '../helpers';\r\nimport CanvasController from '@shared/main/CanvasController';\r\nimport CreatorQuiz from '../central-area/CreatorQuiz';\r\n\r\n@Component({\r\n  selector: 'app-quiz-configuration',\r\n  templateUrl: './quiz-configuration.component.html',\r\n  styleUrls: ['./quiz-configuration.component.css']\r\n})\r\nexport class QuizConfigurationComponent implements AfterViewInit {\r\n\r\n  quizObj: QuizFormat;\r\n  answers: boolean[];\r\n  formatTemplate: FileFormat;\r\n\r\n  @ViewChildren('eqContainer') containers: QueryList<ElementRef>;\r\n\r\n  constructor(private selection: ContentSelectionService,\r\n              private undoRedo: UndoRedoService,\r\n              private modal: ModalService) {\r\n    this.quizObj = selection.canvasInstance.getStepLayoutOfSelected() as QuizFormat;\r\n    this.answers = new Array(this.quizObj.children.length).fill(false);\r\n    this.quizObj.answers.forEach(index => {\r\n      this.answers[index] = true;\r\n    });\r\n    // Create an empty template to put children of the quiz into\r\n    this.formatTemplate = undoRedo.getStateClone();\r\n    this.formatTemplate.steps = [{root: ({type: 'vbox', children: []}) as LinearContainerFormat}];\r\n    delete this.formatTemplate.autoplay;\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.initContainers();\r\n    this.containers.changes.subscribe(this.initContainers.bind(this));\r\n  }\r\n\r\n  /**\r\n   * Display each option in the containers.\r\n   */\r\n  initContainers() {\r\n    this.containers.forEach((container, i) => {\r\n      // Create a container for each child of the quiz\r\n      container.nativeElement.innerHTML = '';\r\n      const childEl = this.quizObj.children[i] as string | ContainerFormat;\r\n      const template = deepClone(this.formatTemplate) as FileFormat;\r\n      (template.steps[0].root as LinearContainerFormat).children[0] = childEl;\r\n      const canv = new CanvasController(container.nativeElement, template);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Save changes and close.\r\n   */\r\n  apply() {\r\n    const quiz = this.selection.canvasInstance.getSelectedLayout().component as CreatorQuiz;\r\n    quiz.saveAnswers(this.answers);\r\n    this.selection.canvasInstance.save();\r\n    this.modal.remove();\r\n  }\r\n\r\n  trackByIndex(index: number) {\r\n    return index;\r\n  }\r\n\r\n}\r\n","module.exports = \"#outer {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\np {\\r\\n    padding: 10px;\\r\\n}\\r\\n\\r\\n.margin-top {\\r\\n    margin-top: 10px;\\r\\n}\\r\\n\\r\\na {\\r\\n    color: rgba(255, 255, 255, 0.9);\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvc2F2ZS9zYXZlLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxhQUFhO0lBQ2Isc0JBQXNCO0lBQ3RCLG1CQUFtQjtBQUN2Qjs7QUFFQTtJQUNJLGFBQWE7QUFDakI7O0FBRUE7SUFDSSxnQkFBZ0I7QUFDcEI7O0FBRUE7SUFDSSwrQkFBK0I7QUFDbkMiLCJmaWxlIjoic3JjL2FwcC9zYXZlL3NhdmUuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIiNvdXRlciB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbn1cclxuXHJcbnAge1xyXG4gICAgcGFkZGluZzogMTBweDtcclxufVxyXG5cclxuLm1hcmdpbi10b3Age1xyXG4gICAgbWFyZ2luLXRvcDogMTBweDtcclxufVxyXG5cclxuYSB7XHJcbiAgICBjb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjkpO1xyXG59Il19 */\"","module.exports = \"<div id=\\\"outer\\\">\\r\\n  <a class=\\\"button\\\" download=\\\"anim0.json\\\" [href]=\\\"downloadHref\\\">Download</a>\\r\\n  <span class=\\\"button\\\" (click)=\\\"copy();\\\">Copy to clipboard</span>\\r\\n  <p *ngIf=\\\"copied\\\">Copied!</p>\\r\\n  <textarea #textArea rows=\\\"6\\\" cols=\\\"55\\\" [ngClass]=\\\"{'margin-top': !copied}\\\"></textarea>\\r\\n</div>\"","import { Component, AfterViewInit, OnDestroy, ViewChild, ElementRef } from '@angular/core';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport HeightComputeCanvasController from '@shared/main/HeightComputeCanvasController';\r\n\r\n@Component({\r\n  selector: 'app-save',\r\n  templateUrl: './save.component.html',\r\n  styleUrls: ['./save.component.css']\r\n})\r\nexport class SaveComponent implements OnDestroy, AfterViewInit {\r\n\r\n  private downloadHref;\r\n  private fileString: string;\r\n  private copied: boolean;\r\n\r\n  @ViewChild('textArea')\r\n  textAreaEl: ElementRef;\r\n\r\n  constructor(private undoRedo: UndoRedoService, private sanitizer: DomSanitizer) {\r\n    const currState: any = this.undoRedo.getStateClone();\r\n    // Check if there is an unloaded custom font\r\n    if (currState.saveLaterFont) {\r\n      currState.font = currState.saveLaterFont;\r\n      delete currState.saveLaterFont;\r\n      // Metrics are for default font, no longer valid\r\n      delete currState.metrics;\r\n      delete currState.maxHeights;\r\n    } else {\r\n      // Computing max heights is only valid if the font is correct\r\n      currState.maxHeights = new HeightComputeCanvasController(currState).compute();\r\n    }\r\n    this.fileString = JSON.stringify(currState);\r\n    const blob = new Blob([this.fileString], {type: 'text/plain'});\r\n    this.downloadHref = sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(blob));\r\n  }\r\n\r\n  /**\r\n   * Copy the file to the clipboard as a string.\r\n   */\r\n  copy() {\r\n    this.textAreaEl.nativeElement.select();\r\n    this.copied = true;\r\n    document.execCommand('copy');\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.textAreaEl.nativeElement.value = this.fileString;\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    // Prevent resource leak.\r\n    window.URL.revokeObjectURL(this.downloadHref);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { UndoRedoService } from './undo-redo.service';\r\nimport { FileFormat } from '@shared/main/FileFormat';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SelectedStepService {\r\n\r\n  private selectedVar = 0;\r\n\r\n  private subscribers: ((newSelected: number) => void)[] = [];\r\n\r\n  constructor(private undoRedo: UndoRedoService) {\r\n    undoRedo.subscribe((newState: FileFormat) => {\r\n      // If state changes, selected step may need to change.\r\n      if (this.selected >= newState.steps.length) {\r\n        this.selected = newState.steps.length - 1;\r\n      }\r\n    });\r\n  }\r\n\r\n  set selected(newSelected: number) {\r\n    this.selectedVar = newSelected;\r\n    this.subscribers.forEach(sub => sub(newSelected));\r\n  }\r\n\r\n  get selected() {\r\n    return this.selectedVar;\r\n  }\r\n\r\n  subscribe(listener) {\r\n    this.subscribers.push(listener);\r\n  }\r\n\r\n  resetSubscriptions() {\r\n    this.subscribers = [];\r\n  }\r\n}\r\n","import CanvasController from '@shared/main/CanvasController';\r\nimport EqContent from '@shared/layout/EqContent';\r\nimport EqContainer from '@shared/layout/EqContainer';\r\nimport LayoutState from '@shared/animation/LayoutState';\r\nimport EqComponent from '@shared/layout/EqComponent';\r\nimport SelectableComponentModel from './SelectableComponentModel';\r\n\r\nexport default class SelectableCanvasController extends CanvasController {\r\n\r\n    private selectedRef: string;\r\n    private index: number;\r\n    private onChange: (newRef: string, index: number) => void;\r\n    // Function that throws if we can't select something.\r\n    private changeValid: (newRef: string, index: number) => void;\r\n\r\n    protected components: SelectableComponentModel;\r\n\r\n    constructor(container: HTMLElement,\r\n                instructions,\r\n                selectedRef: string,\r\n                index: number,\r\n                onChange: (newRef: string, index: number) => void,\r\n                changeValid: (newRef: string, index: number) => void) {\r\n        super(container, instructions);\r\n        this.components = new SelectableComponentModel(instructions);\r\n        // Remove autoplay overlay if present\r\n        if (this.isAutoplay) {\r\n            container.removeChild(container.children[container.childElementCount - 1]);\r\n        }\r\n        this.selectedRef = selectedRef;\r\n        this.index = index;\r\n        this.onChange = onChange;\r\n        this.changeValid = changeValid;\r\n        this.canvas.addEventListener('click', this.select.bind(this));\r\n        this.recalc(true);\r\n    }\r\n\r\n    // Override to draw selected differently\r\n    redraw() {\r\n        super.redraw();\r\n        this.currStates.forEach((layout, component) => {\r\n            if (component instanceof EqContent) {\r\n                if (component.getRef() === this.selectedRef) {\r\n                    this.ctx.save();\r\n                    this.ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';\r\n                    this.ctx.fillRect(layout.tlx, layout.tly, layout.width, layout.height);\r\n                    this.ctx.restore();\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Deselect what is currently selected,\r\n     * and select what is clicked.\r\n     * @param e The click mouse event.\r\n     */\r\n    select(e: MouseEvent) {\r\n        const x = e.offsetX;\r\n        const y = e.offsetY;\r\n        const layoutsArr: [LayoutState, EqComponent<any>][] = [];\r\n        this.currStates.forEach((layout, component) => {\r\n            layoutsArr.push([layout, component]);\r\n        });\r\n        let newRef = this.selectedRef;\r\n        for (const [layout, component] of layoutsArr) {\r\n            if (layout.contains(x, y)) {\r\n                if (component instanceof EqContainer) {\r\n                    // Clicking on container deselects.\r\n                    newRef = '';\r\n                } else if (component instanceof EqContent) {\r\n                    // Select the new content\r\n                    newRef = component.getRef();\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        try {\r\n            this.changeValid(newRef, this.index);\r\n            this.selectedRef = newRef;\r\n            this.onChange(this.selectedRef, this.index);\r\n            this.redraw();\r\n        } catch (e) {} finally {}\r\n    }\r\n}\r\n","import { ComponentModel } from '@shared/main/ComponentModel';\r\nimport { FileFormat, ContainerFormat, TableFormat } from '@shared/main/FileFormat';\r\nimport HDivider from '@shared/layout/HDivider';\r\nimport VDivider from '@shared/layout/VDivider';\r\nimport { creatorSelectableHDividerPadding, creatorSelectableVDividerPadding, defaultTablePadding } from '@shared/main/consts';\r\nimport EqContainer from '@shared/layout/EqContainer';\r\nimport TableContainer, { parseChildren2D, parseChildrenObj } from '@shared/layout/TableContainer';\r\nimport Padding from '@shared/layout/Padding';\r\n\r\nexport default class SelectableComponentModel extends ComponentModel {\r\n\r\n    constructor(file: FileFormat) {\r\n        super(file);\r\n        // Give dividers more padding to be selectable\r\n        const hDividers = this.content.get('h');\r\n        const numHDividers = hDividers.length;\r\n        hDividers.length = 0;\r\n        for (let i = 0; i < numHDividers; i++) {\r\n            hDividers.push(new HDivider(creatorSelectableHDividerPadding, 'h' + i));\r\n        }\r\n        const vDividers = this.content.get('v');\r\n        const numVDividers = vDividers.length;\r\n        vDividers.length = 0;\r\n        for (let i = 0; i < numVDividers; i++) {\r\n            vDividers.push(new VDivider(creatorSelectableVDividerPadding, 'v' + i));\r\n        }\r\n        // For customizing table display\r\n        (this.genInfo as any).isSelectable = true;\r\n    }\r\n\r\n    // Override to make tables display differently\r\n    parseContainer(containerObj: ContainerFormat, depth: number): EqContainer<any> {\r\n        if (containerObj.type === 'table') {\r\n            // Selectable table, make line stroke bigger\r\n            const format = containerObj as TableFormat;\r\n            const children = parseChildren2D(format.children, this.parseContainer, this.getContent);\r\n            return new TableContainer(\r\n                defaultTablePadding,\r\n                children,\r\n                parseChildrenObj(format.hLines, this.getContent),\r\n                parseChildrenObj(format.vLines, this.getContent),\r\n                11,\r\n                Padding.even(0)\r\n            );\r\n        } else {\r\n            return super.parseContainer(containerObj, depth);\r\n        }\r\n    }\r\n}\r\n","module.exports = \"#outer {\\r\\n    max-height: calc(100vh - 20px);\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n}\\r\\n\\r\\n#top {\\r\\n    overflow-y: scroll;\\r\\n}\\r\\n\\r\\n.selection-container {\\r\\n    padding: 10px 20px 10px 20px;\\r\\n    margin-top: 20px;\\r\\n    margin-bottom: 20px;\\r\\n    border-radius: 5px;\\r\\n    box-shadow: 0px 0px 10px 0px rgba(0, 0, 0, 0.5);\\r\\n}\\r\\n\\r\\n.top-row {\\r\\n    display: flex;\\r\\n}\\r\\n\\r\\n.top-row p {\\r\\n    flex-grow: 1;\\r\\n}\\r\\n\\r\\np {\\r\\n    padding: 5px;\\r\\n}\\r\\n\\r\\n.title-row {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    border-bottom: 1px solid rgba(0, 0, 0, 0.1);\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n.title {\\r\\n    flex-grow: 1;\\r\\n}\\r\\n\\r\\n.material-icons {\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n.add {\\r\\n    border-left: 1px solid rgba(0, 0, 0, 0.1);\\r\\n    padding-left: 10px;\\r\\n    padding-right: 10px;\\r\\n}\\r\\n\\r\\n.buttonContainer {\\r\\n    flex-basis: 55px;\\r\\n    border-top: 1px solid rgba(0, 0, 0, 0.1);\\r\\n}\\r\\n\\r\\n.durationRow {\\r\\n    display: flex;\\r\\n    justify-content: space-between;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n.durationTitle {\\r\\n    font-style: italic;\\r\\n}\\r\\n\\r\\n.slider {\\r\\n    margin-right: 10px;\\r\\n}\\r\\n\\r\\n.textBox {\\r\\n    width: 50px;\\r\\n    margin-right: 10px;\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvc3RlcC1vcHRpb25zL3N0ZXAtb3B0aW9ucy5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksOEJBQThCO0lBQzlCLGFBQWE7SUFDYixzQkFBc0I7QUFDMUI7O0FBRUE7SUFDSSxrQkFBa0I7QUFDdEI7O0FBRUE7SUFDSSw0QkFBNEI7SUFDNUIsZ0JBQWdCO0lBQ2hCLG1CQUFtQjtJQUNuQixrQkFBa0I7SUFDbEIsK0NBQStDO0FBQ25EOztBQUVBO0lBQ0ksYUFBYTtBQUNqQjs7QUFFQTtJQUNJLFlBQVk7QUFDaEI7O0FBRUE7SUFDSSxZQUFZO0FBQ2hCOztBQUVBO0lBQ0ksYUFBYTtJQUNiLG1CQUFtQjtJQUNuQiwyQ0FBMkM7SUFDM0MsZUFBZTtBQUNuQjs7QUFFQTtJQUNJLFlBQVk7QUFDaEI7O0FBRUE7SUFDSSxlQUFlO0FBQ25COztBQUVBO0lBQ0kseUNBQXlDO0lBQ3pDLGtCQUFrQjtJQUNsQixtQkFBbUI7QUFDdkI7O0FBRUE7SUFDSSxnQkFBZ0I7SUFDaEIsd0NBQXdDO0FBQzVDOztBQUVBO0lBQ0ksYUFBYTtJQUNiLDhCQUE4QjtJQUM5QixtQkFBbUI7QUFDdkI7O0FBRUE7SUFDSSxrQkFBa0I7QUFDdEI7O0FBRUE7SUFDSSxrQkFBa0I7QUFDdEI7O0FBRUE7SUFDSSxXQUFXO0lBQ1gsa0JBQWtCO0FBQ3RCIiwiZmlsZSI6InNyYy9hcHAvc3RlcC1vcHRpb25zL3N0ZXAtb3B0aW9ucy5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiI291dGVyIHtcclxuICAgIG1heC1oZWlnaHQ6IGNhbGMoMTAwdmggLSAyMHB4KTtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG59XHJcblxyXG4jdG9wIHtcclxuICAgIG92ZXJmbG93LXk6IHNjcm9sbDtcclxufVxyXG5cclxuLnNlbGVjdGlvbi1jb250YWluZXIge1xyXG4gICAgcGFkZGluZzogMTBweCAyMHB4IDEwcHggMjBweDtcclxuICAgIG1hcmdpbi10b3A6IDIwcHg7XHJcbiAgICBtYXJnaW4tYm90dG9tOiAyMHB4O1xyXG4gICAgYm9yZGVyLXJhZGl1czogNXB4O1xyXG4gICAgYm94LXNoYWRvdzogMHB4IDBweCAxMHB4IDBweCByZ2JhKDAsIDAsIDAsIDAuNSk7XHJcbn1cclxuXHJcbi50b3Atcm93IHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbn1cclxuXHJcbi50b3Atcm93IHAge1xyXG4gICAgZmxleC1ncm93OiAxO1xyXG59XHJcblxyXG5wIHtcclxuICAgIHBhZGRpbmc6IDVweDtcclxufVxyXG5cclxuLnRpdGxlLXJvdyB7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMSk7XHJcbiAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbn1cclxuXHJcbi50aXRsZSB7XHJcbiAgICBmbGV4LWdyb3c6IDE7XHJcbn1cclxuXHJcbi5tYXRlcmlhbC1pY29ucyB7XHJcbiAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbn1cclxuXHJcbi5hZGQge1xyXG4gICAgYm9yZGVyLWxlZnQ6IDFweCBzb2xpZCByZ2JhKDAsIDAsIDAsIDAuMSk7XHJcbiAgICBwYWRkaW5nLWxlZnQ6IDEwcHg7XHJcbiAgICBwYWRkaW5nLXJpZ2h0OiAxMHB4O1xyXG59XHJcblxyXG4uYnV0dG9uQ29udGFpbmVyIHtcclxuICAgIGZsZXgtYmFzaXM6IDU1cHg7XHJcbiAgICBib3JkZXItdG9wOiAxcHggc29saWQgcmdiYSgwLCAwLCAwLCAwLjEpO1xyXG59XHJcblxyXG4uZHVyYXRpb25Sb3cge1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcclxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbn1cclxuXHJcbi5kdXJhdGlvblRpdGxlIHtcclxuICAgIGZvbnQtc3R5bGU6IGl0YWxpYztcclxufVxyXG5cclxuLnNsaWRlciB7XHJcbiAgICBtYXJnaW4tcmlnaHQ6IDEwcHg7XHJcbn1cclxuXHJcbi50ZXh0Qm94IHtcclxuICAgIHdpZHRoOiA1MHB4O1xyXG4gICAgbWFyZ2luLXJpZ2h0OiAxMHB4O1xyXG59Il19 */\"","module.exports = \"<div id=\\\"outer\\\">\\r\\n  <div id=\\\"top\\\">\\r\\n    <!--Transition bit-->\\r\\n    <div class=\\\"title\\\">TRANSITION PREVIEW</div>\\r\\n    <div class=\\\"eqContainer\\\" #previewContainer data-fix-height></div>\\r\\n\\r\\n    <!--Durations bit-->\\r\\n    <div class=\\\"title\\\">DURATIONS</div>\\r\\n    <div class=\\\"durationRow\\\">\\r\\n      <span class=\\\"durationTitle\\\">Move: </span>\\r\\n      <span class=\\\"durationRow\\\">\\r\\n        <input class=\\\"textBox\\\" type=\\\"number\\\" [(ngModel)]=\\\"moveDuration\\\" (ngModelChange)=\\\"updateDurations()\\\">\\r\\n        <input class=\\\"slider\\\" type=\\\"range\\\" min=\\\"1\\\" max=\\\"2000\\\" [(ngModel)]=\\\"moveDuration\\\"\\r\\n          (ngModelChange)=\\\"updateDurations()\\\">\\r\\n        <span class=\\\"selector\\\" (click)=\\\"setDefaultMoveDuration()\\\">Default</span>\\r\\n      </span>\\r\\n    </div>\\r\\n    <div class=\\\"durationRow\\\">\\r\\n      <span class=\\\"durationTitle\\\">Add: </span>\\r\\n      <span class=\\\"durationRow\\\">\\r\\n        <input class=\\\"textBox\\\" type=\\\"number\\\" [(ngModel)]=\\\"addDuration\\\" (ngModelChange)=\\\"updateDurations()\\\">\\r\\n        <input class=\\\"slider\\\" type=\\\"range\\\" min=\\\"1\\\" max=\\\"2000\\\" [(ngModel)]=\\\"addDuration\\\"\\r\\n          (ngModelChange)=\\\"updateDurations()\\\">\\r\\n        <span class=\\\"selector\\\" (click)=\\\"setDefaultAddDuration()\\\">Default</span>\\r\\n      </span>\\r\\n    </div>\\r\\n    <div class=\\\"durationRow\\\">\\r\\n      <span class=\\\"durationTitle\\\">Remove: </span>\\r\\n      <span class=\\\"durationRow\\\">\\r\\n        <input class=\\\"textBox\\\" type=\\\"number\\\" [(ngModel)]=\\\"removeDuration\\\" (ngModelChange)=\\\"updateDurations()\\\">\\r\\n        <input class=\\\"slider\\\" type=\\\"range\\\" min=\\\"1\\\" max=\\\"2000\\\" [(ngModel)]=\\\"removeDuration\\\"\\r\\n          (ngModelChange)=\\\"updateDurations()\\\">\\r\\n        <span class=\\\"selector\\\" (click)=\\\"setDefaultRemoveDuration()\\\">Default</span>\\r\\n      </span>\\r\\n    </div>\\r\\n    <div class=\\\"durationRow\\\" *ngIf=\\\"isAutoplay()\\\">\\r\\n      <span class=\\\"durationTitle\\\">Delay: </span>\\r\\n      <span class=\\\"durationRow\\\">\\r\\n        <input class=\\\"textBox\\\" type=\\\"number\\\" [(ngModel)]=\\\"delay\\\">\\r\\n        <input class=\\\"slider\\\" type=\\\"range\\\" min=\\\"0\\\" max=\\\"2000\\\" [(ngModel)]=\\\"delay\\\">\\r\\n        <span class=\\\"selector\\\" (click)=\\\"setDefaultDelay()\\\">Default</span>\\r\\n      </span>\\r\\n    </div>\\r\\n\\r\\n    <!--Clones bit-->\\r\\n    <div class=\\\"title-row\\\" (click)=\\\"showingClones = !showingClones;\\\">\\r\\n      <span class=\\\"material-icons\\\">{{ showingClones ? 'keyboard_arrow_down' : 'keyboard_arrow_up' }}</span>\\r\\n      <div class=\\\"title\\\">\\r\\n        CLONES ({{ cloneToFrom.length }})\\r\\n      </div>\\r\\n      <span class=\\\"material-icons add\\\" (click)=\\\"addClone($event)\\\">add</span>\\r\\n    </div>\\r\\n    <div *ngIf=\\\"showingClones\\\">\\r\\n      <div class=\\\"selection-container\\\" *ngFor=\\\"let clone of cloneToFrom; let idx = index;\\\">\\r\\n        <div class=\\\"top-row\\\">\\r\\n          <p>FROM</p>\\r\\n          <span class=\\\"material-icons\\\" (click)=\\\"removeClone(idx)\\\">clear</span>\\r\\n        </div>\\r\\n        <div appCloneContainer [index]=\\\"idx\\\"></div>\\r\\n        <p>TO</p>\\r\\n        <div appCloneContainer [index]=\\\"idx\\\"></div>\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n    <!--Merges bit-->\\r\\n    <div class=\\\"title-row\\\" (click)=\\\"showingMerges = !showingMerges;\\\">\\r\\n      <span class=\\\"material-icons\\\">{{ showingMerges ? 'keyboard_arrow_down' : 'keyboard_arrow_up' }}</span>\\r\\n      <div class=\\\"title\\\">\\r\\n        MERGES ({{ mergeFromTo.length }})\\r\\n      </div>\\r\\n      <span class=\\\"material-icons add\\\" (click)=\\\"addMerge($event)\\\">add</span>\\r\\n    </div>\\r\\n    <div *ngIf=\\\"showingMerges\\\">\\r\\n      <div class=\\\"selection-container\\\" *ngFor=\\\"let merge of mergeFromTo; let idx = index;\\\">\\r\\n        <div class=\\\"top-row\\\">\\r\\n          <p>FROM</p>\\r\\n          <span class=\\\"material-icons\\\" (click)=\\\"removeMerge(idx)\\\">clear</span>\\r\\n        </div>\\r\\n        <div appMergeContainer [index]=\\\"idx\\\"></div>\\r\\n        <p>TO</p>\\r\\n        <div appMergeContainer [index]=\\\"idx\\\"></div>\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n    <!--Evaluations bit-->\\r\\n    <div class=\\\"title-row\\\" (click)=\\\"showingEvals = !showingEvals\\\">\\r\\n      <div class=\\\"material-icons\\\">{{ showingEvals ? 'keyboard_arrow_down' : 'keyboard_arrow_up' }}</div>\\r\\n      <div class=\\\"title\\\">\\r\\n        EVALUATIONS ({{ evalFromTo.length }})\\r\\n      </div>\\r\\n      <span class=\\\"material-icons add\\\" (click)=\\\"addEval($event)\\\">add</span>\\r\\n    </div>\\r\\n    <div *ngIf=\\\"showingEvals\\\">\\r\\n      <div class=\\\"selection-container\\\" *ngFor=\\\"let eval of evalFromTo; let idx = index;\\\">\\r\\n        <div class=\\\"top-row\\\">\\r\\n          <p>FROM</p>\\r\\n          <span class=\\\"material-icons\\\" (click)=\\\"removeEval(idx)\\\">clear</span>\\r\\n        </div>\\r\\n        <div appEvalContainer [index]=\\\"idx\\\"></div>\\r\\n        <p>TO</p>\\r\\n        <div appEvalContainer [index]=\\\"idx\\\"></div>\\r\\n      </div>\\r\\n    </div>\\r\\n  </div>\\r\\n  <div class=\\\"buttonContainer\\\" style=\\\"display: flex\\\">\\r\\n    <div class=\\\"button\\\" (click)=\\\"apply()\\\">Apply</div>\\r\\n  </div>\\r\\n</div>\"","import { Component, Directive, AfterViewInit, Input, ViewChildren, ElementRef, ViewChild } from '@angular/core';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport { SelectedStepService } from '../selected-step.service';\r\nimport { deepClone, inLayout } from '../helpers';\r\nimport { QueryList } from '@angular/core';\r\nimport SelectableCanvasController from './SelectableCanvasController';\r\nimport CanvasController from '@shared/main/CanvasController';\r\nimport { ErrorService } from '../error.service';\r\nimport { ModalService } from '../modal.service';\r\nimport { FileFormat, StepFormat } from '@shared/main/FileFormat';\r\nimport { defaultMoveDuration, defaultAddDuration, defaultRemoveDuration } from '@shared/main/consts';\r\n\r\n@Directive({\r\n  selector: '[appCloneContainer]'\r\n})\r\nexport class CloneContainerDirective {\r\n  @Input() index: number;\r\n  constructor(public el: ElementRef) {}\r\n}\r\n\r\n@Directive({\r\n  selector: '[appMergeContainer]'\r\n})\r\nexport class MergeContainerDirective {\r\n  @Input() index: number;\r\n  constructor(public el: ElementRef) {}\r\n}\r\n\r\n@Directive({\r\n  selector: '[appEvalContainer]'\r\n})\r\nexport class EvalContainerDirective {\r\n  @Input() index: number;\r\n  constructor(public el: ElementRef) {}\r\n}\r\n\r\n@Component({\r\n  selector: 'app-step-options',\r\n  templateUrl: './step-options.component.html',\r\n  styleUrls: ['./step-options.component.css']\r\n})\r\nexport class StepOptionsComponent implements AfterViewInit {\r\n\r\n  cloneToFrom: [string, string][] = [];\r\n  @ViewChildren(CloneContainerDirective)\r\n  cloneContainers: QueryList<CloneContainerDirective>;\r\n  showingClones = false;\r\n\r\n  mergeFromTo: [string, string][] = [];\r\n  @ViewChildren(MergeContainerDirective)\r\n  mergeContainers: QueryList<MergeContainerDirective>;\r\n  showingMerges = false;\r\n\r\n  evalFromTo: [string, string][] = [];\r\n  @ViewChildren(EvalContainerDirective)\r\n  evalContainers: QueryList<EvalContainerDirective>;\r\n  showingEvals = false;\r\n\r\n  // Instructions objects used to load the\r\n  // selection canvases. These contain the\r\n  // layout for just one step.\r\n  currStepContentInstructions: FileFormat;\r\n  currStepText: string;\r\n  nextStepContentInstructions: FileFormat;\r\n  nextStepText: string;\r\n\r\n  @ViewChild('previewContainer')\r\n  previewEl: ElementRef;\r\n\r\n  // Duration options for this step\r\n  moveDuration: number;\r\n  addDuration: number;\r\n  removeDuration: number;\r\n  delay: number;\r\n\r\n  constructor(private undoRedo: UndoRedoService,\r\n              private step: SelectedStepService,\r\n              private error: ErrorService,\r\n              private modal: ModalService) {\r\n    // Bindings\r\n    this.updateCloneFrom = this.updateCloneFrom.bind(this);\r\n    this.updateCloneTo = this.updateCloneTo.bind(this);\r\n    this.cloneToValid = this.cloneToValid.bind(this);\r\n    this.updateMergeFrom = this.updateMergeFrom.bind(this);\r\n    this.mergeFromValid = this.mergeFromValid.bind(this);\r\n    this.updateMergeTo = this.updateMergeTo.bind(this);\r\n    this.updateEvalFrom = this.updateEvalFrom.bind(this);\r\n    this.evalFromValid = this.evalFromValid.bind(this);\r\n    this.updateEvalTo = this.updateEvalTo.bind(this);\r\n    this.updateDurations = this.updateDurations.bind(this);\r\n\r\n    const currState = undoRedo.getState();\r\n    if (currState.stepOpts && currState.stepOpts[step.selected]) {\r\n      // Options already exist for this transition, load them.\r\n      const stepOpts = currState.stepOpts[step.selected];\r\n      // Load clones\r\n      if (stepOpts.clones) {\r\n        Object.keys(stepOpts.clones).forEach((toRef: string) => {\r\n          const fromRef: string = stepOpts.clones[toRef];\r\n          this.cloneToFrom.push([toRef, fromRef]);\r\n        });\r\n      }\r\n      // Load merges\r\n      if (stepOpts.merges) {\r\n        Object.keys(stepOpts.merges).forEach((fromRef: string) => {\r\n          const toRef = stepOpts.merges[fromRef];\r\n          this.mergeFromTo.push([fromRef, toRef]);\r\n        });\r\n      }\r\n      // Load evals\r\n      if (stepOpts.evals) {\r\n        Object.keys(stepOpts.evals).forEach((fromRef: string) => {\r\n          const toRef = stepOpts.evals[fromRef];\r\n          this.evalFromTo.push([fromRef, toRef]);\r\n        });\r\n      }\r\n      // Load durations\r\n      this.moveDuration = stepOpts.moveDuration ? stepOpts.moveDuration : defaultMoveDuration;\r\n      this.addDuration = stepOpts.addDuration ? stepOpts.addDuration : defaultAddDuration;\r\n      this.removeDuration = stepOpts.removeDuration ? stepOpts.removeDuration : defaultRemoveDuration;\r\n    } else {\r\n      // Durations need to be set default if no step options\r\n      this.setDefaultMoveDuration();\r\n      this.setDefaultAddDuration();\r\n      this.setDefaultRemoveDuration();\r\n    }\r\n\r\n    // Load delay, if necessary\r\n    if (this.isAutoplay() && currState.autoplay.delays && currState.autoplay.delays[step.selected] !== undefined) {\r\n      this.delay = currState.autoplay.delays[step.selected];\r\n    } else {\r\n      this.setDefaultDelay();\r\n    }\r\n\r\n    // Extract current and next steps\r\n    const currStep = deepClone(currState.steps[step.selected]) as StepFormat;\r\n    this.currStepContentInstructions = deepClone(currState) as FileFormat;\r\n    this.currStepContentInstructions.steps = [currStep];\r\n    this.currStepText = this.currStepContentInstructions.steps[0].text;\r\n    delete this.currStepContentInstructions.steps[0].text;\r\n\r\n    const nextStep = deepClone(currState.steps[step.selected + 1]) as StepFormat;\r\n    this.nextStepContentInstructions = deepClone(currState) as FileFormat;\r\n    this.nextStepContentInstructions.steps = [nextStep];\r\n    this.nextStepText = this.nextStepContentInstructions.steps[0].text;\r\n    delete this.nextStepContentInstructions.steps[0].text;\r\n\r\n  }\r\n\r\n  /**\r\n   * Whether the current animation is autoplay.\r\n   */\r\n  isAutoplay() {\r\n    const currState = this.undoRedo.getState();\r\n    return currState.autoplay !== undefined;\r\n  }\r\n\r\n  /**\r\n   * Called when the slider for move duration changes.\r\n   */\r\n  updateDurations() {\r\n    this.updatePreview();\r\n  }\r\n\r\n  /**\r\n   * Reset move duration to default.\r\n   */\r\n  setDefaultMoveDuration() {\r\n    this.moveDuration = defaultMoveDuration;\r\n    this.updateDurations();\r\n  }\r\n\r\n  /**\r\n   * Reset add duration to default.\r\n   */\r\n  setDefaultAddDuration() {\r\n    this.addDuration = defaultAddDuration;\r\n    this.updateDurations();\r\n  }\r\n\r\n  /**\r\n   * Reset remove duration to default.\r\n   */\r\n  setDefaultRemoveDuration() {\r\n    this.removeDuration = defaultRemoveDuration;\r\n    this.updateDurations();\r\n  }\r\n\r\n  /**\r\n   * Reset delay to default.\r\n   */\r\n  setDefaultDelay() {\r\n    this.delay = 0;\r\n  }\r\n\r\n  /**\r\n   * Fills the eq containers with the right\r\n   * content to display.\r\n   */\r\n  updateContainers() {\r\n    this.updateCloneContainers();\r\n    this.updateMergeContainers();\r\n    this.updateEvalContainers();\r\n    this.updatePreview();\r\n  }\r\n\r\n  /**\r\n   * Fill clone containers with content.\r\n   */\r\n  updateCloneContainers() {\r\n    // Create clone containers\r\n    let i = 0;\r\n    this.cloneContainers.forEach(cloneContainer => {\r\n      cloneContainer.el.nativeElement.innerHTML = '';\r\n      const cloneToFromIndex = Math.floor(i / 2);\r\n      const from = i % 2 === 0;\r\n      if (from) {\r\n        // Show current step\r\n        const canv = new SelectableCanvasController(\r\n          cloneContainer.el.nativeElement,\r\n          this.currStepContentInstructions,\r\n          this.cloneToFrom[cloneToFromIndex][1],\r\n          cloneToFromIndex,\r\n          this.updateCloneFrom,\r\n          () => {}\r\n        );\r\n      } else {\r\n        // Show next step\r\n        const canv = new SelectableCanvasController(\r\n          cloneContainer.el.nativeElement,\r\n          this.nextStepContentInstructions,\r\n          this.cloneToFrom[cloneToFromIndex][0],\r\n          cloneToFromIndex,\r\n          this.updateCloneTo,\r\n          this.cloneToValid\r\n        );\r\n      }\r\n      i++;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update the model with a new selection.\r\n   * @param newRef The reference of the new selection.\r\n   * @param index The index of the clone.\r\n   */\r\n  updateCloneFrom(newRef: string, index: number) {\r\n    this.cloneToFrom[index][1] = newRef;\r\n    this.updatePreview();\r\n  }\r\n\r\n  /**\r\n   * Update the model with a new selection.\r\n   * @param newRef The reference of the new selection.\r\n   * @param index The index of the clone.\r\n   */\r\n  updateCloneTo(newRef: string, index: number) {\r\n    this.cloneToFrom[index][0] = newRef;\r\n    this.updatePreview();\r\n  }\r\n\r\n  /**\r\n   * Throws if a ref can't be selected.\r\n   * @param newRef The reference of the new selection.\r\n   * @param index The index of the clone.\r\n   */\r\n  cloneToValid(newRef: string, index: number) {\r\n    // A clone to is valid if:\r\n    // 1. It does not exist on the first step.\r\n    // 2. There isn't already a transition defined.\r\n    if (newRef === '') {\r\n      // Blank always valid\r\n      return;\r\n    }\r\n    if (inLayout(this.currStepContentInstructions.steps[0].root, newRef)) {\r\n      this.error.text = 'Content to clone to must not exist beforehand.';\r\n      throw new Error();\r\n    }\r\n    this.cloneToFrom.forEach(cloneToFrom => {\r\n      if (cloneToFrom[0] === newRef) {\r\n        this.error.text = 'Content can only be cloned from one place.';\r\n        throw new Error();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Add a new clone.\r\n   */\r\n  addClone(e: MouseEvent) {\r\n    e.stopPropagation();\r\n    this.cloneToFrom.unshift(['', '']);\r\n    this.showingClones = true;\r\n  }\r\n\r\n  /**\r\n   * Remove a clone.\r\n   * @param idx The index of the clone to remove.\r\n   */\r\n  removeClone(idx: number) {\r\n    this.cloneToFrom.splice(idx, 1);\r\n  }\r\n\r\n  /**\r\n   * Fill merge containers with content.\r\n   */\r\n  updateMergeContainers() {\r\n    // Create merge containers\r\n    let i = 0;\r\n    this.mergeContainers.forEach(mergeContainer => {\r\n      mergeContainer.el.nativeElement.innerHTML = '';\r\n      const mergeFromToIndex = Math.floor(i / 2);\r\n      const from = i % 2 === 0;\r\n      if (from) {\r\n        // Show current step\r\n        const canv = new SelectableCanvasController(\r\n          mergeContainer.el.nativeElement,\r\n          this.currStepContentInstructions,\r\n          this.mergeFromTo[mergeFromToIndex][0],\r\n          mergeFromToIndex,\r\n          this.updateMergeFrom,\r\n          this.mergeFromValid\r\n        );\r\n      } else {\r\n        // Show next step\r\n        const canv = new SelectableCanvasController(\r\n          mergeContainer.el.nativeElement,\r\n          this.nextStepContentInstructions,\r\n          this.mergeFromTo[mergeFromToIndex][1],\r\n          mergeFromToIndex,\r\n          this.updateMergeTo,\r\n          () => {}\r\n        );\r\n      }\r\n      i++;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update the model with a new selection.\r\n   * @param newRef The reference of the new selection.\r\n   * @param index The index of the merge.\r\n   */\r\n  updateMergeFrom(newRef: string, index: number) {\r\n    this.mergeFromTo[index][0] = newRef;\r\n    this.updatePreview();\r\n  }\r\n\r\n  /**\r\n   * Throws if a ref can't be selected.\r\n   * @param newRef The new ref.\r\n   * @param index The index of the merge.\r\n   */\r\n  mergeFromValid(newRef: string, index: number) {\r\n    // A merge from is valid if:\r\n    // 1. It does not exist afterward.\r\n    // 2. There isn't already a transition defined for it.\r\n    if (newRef === '') {\r\n      // Blank always valid\r\n      return;\r\n    }\r\n    if (inLayout(this.nextStepContentInstructions.steps[0].root, newRef)) {\r\n      this.error.text = 'Content to merge from must not exist afterward.';\r\n      throw new Error();\r\n    }\r\n    this.mergeFromTo.forEach(mergeFromTo => {\r\n      if (mergeFromTo[0] === newRef) {\r\n        this.error.text = 'Content can only be merged to one place.';\r\n        throw new Error();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update the model with a new selection.\r\n   * @param newRef The reference of the new selection.\r\n   * @param index The index of the merge.\r\n   */\r\n  updateMergeTo(newRef: string, index: number) {\r\n    this.mergeFromTo[index][1] = newRef;\r\n    this.updatePreview();\r\n  }\r\n\r\n  /**\r\n   * Add a new merge.\r\n   */\r\n  addMerge(e: MouseEvent) {\r\n    e.stopPropagation();\r\n    this.mergeFromTo.unshift(['', '']);\r\n    this.showingMerges = true;\r\n  }\r\n\r\n  /**\r\n   * Remove a merge.\r\n   * @param idx The index of the merge.\r\n   */\r\n  removeMerge(idx: number) {\r\n    this.mergeFromTo.splice(idx, 1);\r\n  }\r\n\r\n  /**\r\n   * Fill eval containers with content.\r\n   */\r\n  updateEvalContainers() {\r\n    // Create eval containers\r\n    let i = 0;\r\n    this.evalContainers.forEach(evalContainer => {\r\n      evalContainer.el.nativeElement.innerHTML = '';\r\n      const evalFromToIndex = Math.floor(i / 2);\r\n      const from = i % 2 === 0;\r\n      if (from) {\r\n        // Show current step\r\n        const canv = new SelectableCanvasController(\r\n          evalContainer.el.nativeElement,\r\n          this.currStepContentInstructions,\r\n          this.evalFromTo[evalFromToIndex][0],\r\n          evalFromToIndex,\r\n          this.updateEvalFrom,\r\n          this.evalFromValid\r\n        );\r\n      } else {\r\n        // Show next step\r\n        const canv = new SelectableCanvasController(\r\n          evalContainer.el.nativeElement,\r\n          this.nextStepContentInstructions,\r\n          this.evalFromTo[evalFromToIndex][1],\r\n          evalFromToIndex,\r\n          this.updateEvalTo,\r\n          () => {}\r\n        );\r\n      }\r\n      i++;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update the model with a new selection.\r\n   * @param newRef The reference of the new selection.\r\n   * @param index The index of the eval.\r\n   */\r\n  updateEvalFrom(newRef: string, index: number) {\r\n    this.evalFromTo[index][0] = newRef;\r\n    this.updatePreview();\r\n  }\r\n\r\n  /**\r\n   * Throws if a ref can't be selected.\r\n   * @param newRef The new ref.\r\n   * @param index The index of the eval.\r\n   */\r\n  evalFromValid(newRef: string, index: number) {\r\n    // An eval from is valid if:\r\n    // 1. It does not exist afterward.\r\n    // 2. There isn't already a transition defined for it.\r\n    if (newRef === '') {\r\n      // Blank always valid\r\n      return;\r\n    }\r\n    if (inLayout(this.nextStepContentInstructions.steps[0].root, newRef)) {\r\n      this.error.text = 'Content to evaluate must not exist afterward.';\r\n      throw new Error();\r\n    }\r\n    this.evalFromTo.forEach(evalFromTo => {\r\n      if (evalFromTo[0] === newRef) {\r\n        this.error.text = 'Content can only evaluate to one thing.';\r\n        throw new Error();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update the model with a new selection.\r\n   * @param newRef The reference of the new selection.\r\n   * @param index The index of the eval.\r\n   */\r\n  updateEvalTo(newRef: string, index: number) {\r\n    this.evalFromTo[index][1] = newRef;\r\n    this.updatePreview();\r\n  }\r\n\r\n  /**\r\n   * Add a new evaluation.\r\n   */\r\n  addEval(e: MouseEvent) {\r\n    e.stopPropagation();\r\n    this.evalFromTo.unshift(['', '']);\r\n    this.showingEvals = true;\r\n  }\r\n\r\n  /**\r\n   * Remove an eval.\r\n   * @param idx The index of the eval.\r\n   */\r\n  removeEval(idx: number) {\r\n    this.evalFromTo.splice(idx, 1);\r\n  }\r\n\r\n  /**\r\n   * Update the preview of the step transition.\r\n   */\r\n  updatePreview() {\r\n    // May fire before preview is ready\r\n    if (!this.previewEl) {\r\n      return;\r\n    }\r\n\r\n    this.previewEl.nativeElement.innerHTML = '';\r\n    const instructions = this.undoRedo.getStateClone();\r\n\r\n    const stepOne: any = deepClone(this.currStepContentInstructions.steps[0]);\r\n    stepOne.text = this.currStepText;\r\n\r\n    const stepTwo: any = deepClone(this.nextStepContentInstructions.steps[0]);\r\n    stepTwo.text = this.nextStepText;\r\n\r\n    instructions.steps = [stepOne, stepTwo];\r\n    instructions.stepOpts = [\r\n      this.getFinalStepOption()\r\n    ];\r\n\r\n    // Should not autoplay, even if the whole animation is\r\n    delete instructions.autoplay;\r\n\r\n    const canv = new CanvasController(this.previewEl.nativeElement, instructions);\r\n  }\r\n\r\n  /**\r\n   * Compile the clones, merges, and evals\r\n   * into a step options object as used in\r\n   * instructions.\r\n   */\r\n  getFinalStepOption(): StepOptionsComponent {\r\n    const toReturn: any = {};\r\n    // Add clones\r\n    this.cloneToFrom.forEach(cloneToFrom => {\r\n      const toRef = cloneToFrom[0];\r\n      const fromRef = cloneToFrom[1];\r\n      if (toRef === '' || fromRef === '') {\r\n        // Ignore empty string representing unselected.\r\n        return;\r\n      }\r\n      if (!toReturn.clones) {\r\n        toReturn.clones = {};\r\n      }\r\n      toReturn.clones[toRef] = fromRef;\r\n    });\r\n    // Add merges\r\n    this.mergeFromTo.forEach(mergeFromTo => {\r\n      const toRef = mergeFromTo[1];\r\n      const fromRef = mergeFromTo[0];\r\n      if (toRef === '' || fromRef === '') {\r\n        // Ignore empty string representing unselected.\r\n        return;\r\n      }\r\n      if (!toReturn.merges) {\r\n        toReturn.merges = {};\r\n      }\r\n      toReturn.merges[fromRef] = toRef;\r\n    });\r\n    // Add evals\r\n    this.evalFromTo.forEach(evalFromTo => {\r\n      const toRef = evalFromTo[1];\r\n      const fromRef = evalFromTo[0];\r\n      if (toRef === '' || fromRef === '') {\r\n        // Ignore empty string representing unselected.\r\n        return;\r\n      }\r\n      if (!toReturn.evals) {\r\n        toReturn.evals = {};\r\n      }\r\n      toReturn.evals[fromRef] = toRef;\r\n    });\r\n    // Add durations\r\n    if (this.moveDuration !== defaultMoveDuration) {\r\n      toReturn.moveDuration = this.moveDuration;\r\n    }\r\n    if (this.addDuration !== defaultAddDuration) {\r\n      toReturn.addDuration = this.addDuration;\r\n    }\r\n    if (this.removeDuration !== defaultRemoveDuration) {\r\n      toReturn.removeDuration = this.removeDuration;\r\n    }\r\n\r\n    return toReturn;\r\n  }\r\n\r\n  /**\r\n   * Apply the changes that have been made.\r\n   */\r\n  apply() {\r\n    const newState: any = this.undoRedo.getStateClone();\r\n    // Add step options\r\n    if (!newState.stepOpts) {\r\n      newState.stepOpts = {};\r\n    }\r\n    newState.stepOpts[this.step.selected] = this.getFinalStepOption();\r\n    // Add delay for autoplay\r\n    if (newState.autoplay !== undefined && this.delay !== 0) {\r\n      if (!newState.autoplay.delays) {\r\n        newState.autoplay.delays = {};\r\n      }\r\n      newState.autoplay.delays[this.step.selected] = this.delay;\r\n    }\r\n    this.undoRedo.publishChange(newState);\r\n    this.modal.remove();\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.updateContainers();\r\n    this.updatePreview();\r\n\r\n    this.cloneContainers.changes.subscribe(() => {\r\n      this.updateCloneContainers();\r\n      this.updatePreview();\r\n    });\r\n    this.mergeContainers.changes.subscribe(() => {\r\n      this.updateMergeContainers();\r\n      this.updatePreview();\r\n    });\r\n    this.evalContainers.changes.subscribe(() => {\r\n      this.updateEvalContainers();\r\n      this.updatePreview();\r\n    });\r\n  }\r\n\r\n}\r\n","module.exports = \"#outer {\\r\\n    display: flex;\\r\\n    justify-content: center;\\r\\n    padding: 10px;\\r\\n    align-items: center;\\r\\n    color: rgba(255, 255, 255, 0.9);\\r\\n}\\r\\n\\r\\n.italic {\\r\\n    font-style: italic;\\r\\n}\\r\\n\\r\\n.material-icons {\\r\\n    cursor: pointer;\\r\\n    padding: 5px;\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvc3RlcC10ZXh0L3N0ZXAtdGV4dC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksYUFBYTtJQUNiLHVCQUF1QjtJQUN2QixhQUFhO0lBQ2IsbUJBQW1CO0lBQ25CLCtCQUErQjtBQUNuQzs7QUFFQTtJQUNJLGtCQUFrQjtBQUN0Qjs7QUFFQTtJQUNJLGVBQWU7SUFDZixZQUFZO0FBQ2hCIiwiZmlsZSI6InNyYy9hcHAvc3RlcC10ZXh0L3N0ZXAtdGV4dC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiI291dGVyIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcclxuICAgIHBhZGRpbmc6IDEwcHg7XHJcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC45KTtcclxufVxyXG5cclxuLml0YWxpYyB7XHJcbiAgICBmb250LXN0eWxlOiBpdGFsaWM7XHJcbn1cclxuXHJcbi5tYXRlcmlhbC1pY29ucyB7XHJcbiAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgICBwYWRkaW5nOiA1cHg7XHJcbn0iXX0= */\"","module.exports = \"<div id=\\\"outer\\\">\\r\\n  <span [ngClass]=\\\"{'italic': noText}\\\" [innerHTML]=\\\"noText ? 'No Text' : this.text\\\"></span>\\r\\n  <span class=\\\"material-icons\\\" (click)=\\\"edit($event)\\\">create</span>\\r\\n</div>\\r\\n\"","import { Component } from '@angular/core';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport { SelectedStepService } from '../selected-step.service';\r\nimport { ModalService } from '../modal.service';\r\nimport { TextEditorComponent } from '../text-editor/text-editor.component';\r\nimport { DomSanitizer, SafeHtml } from '@angular/platform-browser';\r\nimport { FileFormat } from '@shared/main/FileFormat';\r\n\r\n@Component({\r\n  selector: 'app-step-text',\r\n  templateUrl: './step-text.component.html',\r\n  styleUrls: ['./step-text.component.css']\r\n})\r\nexport class StepTextComponent {\r\n\r\n  noText = true;\r\n  text: SafeHtml;\r\n\r\n  constructor(private undoRedo: UndoRedoService,\r\n              private step: SelectedStepService,\r\n              private modal: ModalService,\r\n              private sanitizer: DomSanitizer) {\r\n    this.undoRedo.subscribe(this.stateChange.bind(this));\r\n    this.step.subscribe(() => {\r\n      this.stateChange(this.undoRedo.getState());\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Called when the global state changes.\r\n   * @param newState The new state.\r\n   */\r\n  stateChange(newState: FileFormat) {\r\n    // Bypass because the system for displaying colored text\r\n    // relies on creating HTML inside the step text.\r\n    const text = newState.steps[this.step.selected].text;\r\n    if (!text) {\r\n      this.noText = true;\r\n      return;\r\n    }\r\n    this.text = this.sanitizer.bypassSecurityTrustHtml(newState.steps[this.step.selected].text);\r\n    this.noText = false;\r\n  }\r\n\r\n  /**\r\n   * Edit the text for this step.\r\n   * @param e The mouse event.\r\n   */\r\n  edit(e: MouseEvent) {\r\n    e.stopPropagation();\r\n    this.modal.show(TextEditorComponent);\r\n  }\r\n\r\n}\r\n","import CanvasController from '@shared/main/CanvasController';\r\nimport { newMap } from '@shared/main/helpers';\r\nimport EqContent from '@shared/layout/EqContent';\r\n\r\n/**\r\n * A canvas controller which can render\r\n * all the steps it is passed for use\r\n * on another canvas.\r\n */\r\nexport default class RendererCanvasController extends CanvasController {\r\n\r\n    private renderWidth: number;\r\n    private renderHeight: number;\r\n\r\n    constructor(instructions, renderWidth, renderHeight) {\r\n        const fakeEl = document.createElement('div');\r\n        super(fakeEl, instructions);\r\n        this.renderWidth = renderWidth;\r\n        this.renderHeight = renderHeight;\r\n    }\r\n\r\n    // For performance, override: doesn't need to do anything.\r\n    protected recalc() {}\r\n\r\n    /**\r\n     * Render all the steps, returning an\r\n     * array of canvases with dimensions\r\n     * of renderWidth x renderHeight as\r\n     * specified in the constructor.\r\n     */\r\n    render(): HTMLCanvasElement[] {\r\n        const toReturn: HTMLCanvasElement[] = [];\r\n        this.steps.forEach(step => {\r\n            // Get the layouts for the step\r\n            console.log(step.root);\r\n            const rootContainer = this.components.parseContainer(step.root, 0);\r\n            const colors = step.color;\r\n            const opacities = step.opacity;\r\n            const layouts = newMap();\r\n            const rootLayout = rootContainer.addLayout( undefined, layouts, 0 , 0, 1, opacities, colors,\r\n                                                        newMap(), newMap(), newMap(), []);\r\n\r\n            // Render the layout\r\n            const overflowX = rootLayout.width - this.renderWidth;\r\n            const overflowY = rootLayout.height - this.renderHeight;\r\n            this.canvas = document.createElement('canvas');\r\n            this.ctx = this.canvas.getContext('2d');\r\n            this.setSize(this.renderWidth, this.renderHeight);\r\n            this.lastHeight = -1;\r\n            this.lastWidth = -1;\r\n            let scale: number;\r\n            if (overflowX > overflowY) {\r\n                scale = this.renderWidth / rootLayout.width;\r\n            } else {\r\n                scale = this.renderHeight / rootLayout.height;\r\n            }\r\n            this.ctx.scale(scale, scale);\r\n            layouts.forEach(l => {\r\n                this.ctx.save();\r\n                if (l.component instanceof EqContent) {\r\n                    l.component.interpColorOff();\r\n                    l.component.draw(l, l, 0, this.ctx);\r\n                }\r\n                this.ctx.restore();\r\n            });\r\n            toReturn.push(this.canvas);\r\n        });\r\n        return toReturn;\r\n    }\r\n}\r\n","module.exports = \"#outer {\\r\\n    border-top: 1px solid rgba(255, 255, 255, 0.3);\\r\\n    display: flex;\\r\\n    flex-direction: row;\\r\\n    flex-wrap: nowrap;\\r\\n    overflow: hidden;\\r\\n    color: rgba(255, 255, 255, 0.9);\\r\\n    align-items: stretch;\\r\\n}\\r\\n\\r\\n.thumbnail {\\r\\n    opacity: 0;\\r\\n    position: absolute;\\r\\n    top: 0px;\\r\\n    left: 0px;\\r\\n}\\r\\n\\r\\n.step-left {\\r\\n    width: 100px;\\r\\n    height: 100px;\\r\\n    position: relative;\\r\\n    line-height: 100px;\\r\\n    text-align: center;\\r\\n    flex-shrink: 0;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n.step-right {\\r\\n    display: flex;\\r\\n    flex-direction: column;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n}\\r\\n\\r\\n.step {\\r\\n    border-right: 1px solid rgba(255, 255, 255, 0.3);\\r\\n    display: flex;\\r\\n}\\r\\n\\r\\n.show {\\r\\n    opacity: 1;\\r\\n}\\r\\n\\r\\n.selected {\\r\\n    background-color: rgba(255, 255, 255, 0.25);\\r\\n}\\r\\n\\r\\n.material-icons {\\r\\n    cursor: pointer;\\r\\n    padding: 5px;\\r\\n    font-size: 20px;\\r\\n    line-height: 20px;\\r\\n}\\r\\n\\r\\n.unavailable {\\r\\n    color: rgba(255, 255, 255, 0.3);\\r\\n}\\r\\n\\r\\n.scrollInner {\\r\\n    flex-grow: 1;\\r\\n    display: flex;\\r\\n    max-width: calc(100vw - 60px);\\r\\n    overflow-x: scroll;\\r\\n}\\r\\n\\r\\n.scrollArrow {\\r\\n    vertical-align: middle;\\r\\n    background-color: #111;\\r\\n    position: relative;\\r\\n    z-index: 2;\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvc3RlcHMvc3RlcHMuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLDhDQUE4QztJQUM5QyxhQUFhO0lBQ2IsbUJBQW1CO0lBQ25CLGlCQUFpQjtJQUNqQixnQkFBZ0I7SUFDaEIsK0JBQStCO0lBQy9CLG9CQUFvQjtBQUN4Qjs7QUFFQTtJQUNJLFVBQVU7SUFDVixrQkFBa0I7SUFDbEIsUUFBUTtJQUNSLFNBQVM7QUFDYjs7QUFFQTtJQUNJLFlBQVk7SUFDWixhQUFhO0lBQ2Isa0JBQWtCO0lBQ2xCLGtCQUFrQjtJQUNsQixrQkFBa0I7SUFDbEIsY0FBYztJQUNkLGVBQWU7QUFDbkI7O0FBRUE7SUFDSSxhQUFhO0lBQ2Isc0JBQXNCO0lBQ3RCLG1CQUFtQjtJQUNuQix1QkFBdUI7QUFDM0I7O0FBRUE7SUFDSSxnREFBZ0Q7SUFDaEQsYUFBYTtBQUNqQjs7QUFFQTtJQUNJLFVBQVU7QUFDZDs7QUFFQTtJQUNJLDJDQUEyQztBQUMvQzs7QUFFQTtJQUNJLGVBQWU7SUFDZixZQUFZO0lBQ1osZUFBZTtJQUNmLGlCQUFpQjtBQUNyQjs7QUFFQTtJQUNJLCtCQUErQjtBQUNuQzs7QUFFQTtJQUNJLFlBQVk7SUFDWixhQUFhO0lBQ2IsNkJBQTZCO0lBQzdCLGtCQUFrQjtBQUN0Qjs7QUFFQTtJQUNJLHNCQUFzQjtJQUN0QixzQkFBc0I7SUFDdEIsa0JBQWtCO0lBQ2xCLFVBQVU7QUFDZCIsImZpbGUiOiJzcmMvYXBwL3N0ZXBzL3N0ZXBzLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIjb3V0ZXIge1xyXG4gICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4zKTtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xyXG4gICAgZmxleC13cmFwOiBub3dyYXA7XHJcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC45KTtcclxuICAgIGFsaWduLWl0ZW1zOiBzdHJldGNoO1xyXG59XHJcblxyXG4udGh1bWJuYWlsIHtcclxuICAgIG9wYWNpdHk6IDA7XHJcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgICB0b3A6IDBweDtcclxuICAgIGxlZnQ6IDBweDtcclxufVxyXG5cclxuLnN0ZXAtbGVmdCB7XHJcbiAgICB3aWR0aDogMTAwcHg7XHJcbiAgICBoZWlnaHQ6IDEwMHB4O1xyXG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gICAgbGluZS1oZWlnaHQ6IDEwMHB4O1xyXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG4gICAgZmxleC1zaHJpbms6IDA7XHJcbiAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbn1cclxuXHJcbi5zdGVwLXJpZ2h0IHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG59XHJcblxyXG4uc3RlcCB7XHJcbiAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMyk7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG59XHJcblxyXG4uc2hvdyB7XHJcbiAgICBvcGFjaXR5OiAxO1xyXG59XHJcblxyXG4uc2VsZWN0ZWQge1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjI1KTtcclxufVxyXG5cclxuLm1hdGVyaWFsLWljb25zIHtcclxuICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgIHBhZGRpbmc6IDVweDtcclxuICAgIGZvbnQtc2l6ZTogMjBweDtcclxuICAgIGxpbmUtaGVpZ2h0OiAyMHB4O1xyXG59XHJcblxyXG4udW5hdmFpbGFibGUge1xyXG4gICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4zKTtcclxufVxyXG5cclxuLnNjcm9sbElubmVyIHtcclxuICAgIGZsZXgtZ3JvdzogMTtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBtYXgtd2lkdGg6IGNhbGMoMTAwdncgLSA2MHB4KTtcclxuICAgIG92ZXJmbG93LXg6IHNjcm9sbDtcclxufVxyXG5cclxuLnNjcm9sbEFycm93IHtcclxuICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XHJcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMTExO1xyXG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gICAgei1pbmRleDogMjtcclxufSJdfQ== */\"","module.exports = \"<div id=\\\"outer\\\">\\r\\n  <div class=\\\"scrollArrow material-icons\\\" (click)=\\\"scrollLeft()\\\">keyboard_arrow_left</div>\\r\\n  <div class=\\\"scrollInner\\\" #scrollContainer>\\r\\n    <div  *ngFor=\\\"let s of Arr(numSteps).fill(1); let stepIdx = index;\\\" \\r\\n      class=\\\"step\\\"\\r\\n      [ngClass]=\\\"{'selected': step.selected === stepIdx}\\\">\\r\\n      <div class=\\\"step-left\\\"\\r\\n      (mouseenter)=\\\"showThumbnail[stepIdx] = true;\\\"\\r\\n      (mouseleave)=\\\"showThumbnail[stepIdx] = false;\\\"\\r\\n      (click)=\\\"select(stepIdx)\\\">\\r\\n      {{ showThumbnail[stepIdx] ? '' : stepIdx }}\\r\\n      <canvas #canvas class=\\\"thumbnail\\\" [ngClass]=\\\"{'show': showThumbnail[stepIdx]}\\\"></canvas>\\r\\n    </div>\\r\\n    <div class=\\\"step-right\\\" *ngIf=\\\"step.selected === stepIdx\\\">\\r\\n      <span class=\\\"material-icons\\\" (click)=\\\"add();\\\">add</span>\\r\\n      <span class=\\\"material-icons\\\" \\r\\n      (click)=\\\"delete()\\\" \\r\\n      [ngClass]=\\\"{'unavailable': !deleteAvailable()}\\\">delete</span>\\r\\n      <span class=\\\"material-icons\\\"\\r\\n      (click)=\\\"showStepOptions()\\\"\\r\\n      [ngClass]=\\\"{'unavailable': !stepOptionsAvailable()}\\\">settings</span>\\r\\n    </div>\\r\\n  </div>\\r\\n  </div>\\r\\n  <div class=\\\"scrollArrow material-icons\\\" (click)=\\\"scrollRight()\\\">keyboard_arrow_right</div>\\r\\n</div>\"","import { Component, ViewChildren, QueryList, AfterViewInit, ElementRef, ViewChild } from '@angular/core';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport RendererCanvasController from './RendererCanvasController';\r\nimport { deepClone } from '../helpers';\r\nimport { SelectedStepService } from '../selected-step.service';\r\nimport { ModalService } from '../modal.service';\r\nimport { StepOptionsComponent } from '../step-options/step-options.component';\r\nimport { FileFormat, StepFormat } from '@shared/main/FileFormat';\r\n\r\nconst scrollXAmount = 200;\r\n\r\n@Component({\r\n  selector: 'app-steps',\r\n  templateUrl: './steps.component.html',\r\n  styleUrls: ['./steps.component.css']\r\n})\r\nexport class StepsComponent implements AfterViewInit {\r\n\r\n  Arr = Array;\r\n\r\n  numSteps = 0;\r\n  thumbnails: HTMLCanvasElement[];\r\n  showThumbnail: boolean[];\r\n\r\n  readonly stepWidth = 100;\r\n  readonly stepHeight = 100;\r\n\r\n  @ViewChildren('canvas')\r\n  canvasEls: QueryList<ElementRef>;\r\n\r\n  @ViewChild('scrollContainer')\r\n  scrollContainer: ElementRef;\r\n\r\n  constructor(private undoRedo: UndoRedoService,\r\n              private step: SelectedStepService,\r\n              private modal: ModalService) {\r\n    undoRedo.subscribe(this.stateChange.bind(this));\r\n    setTimeout(() => {\r\n      this.stateChange(this.undoRedo.getState());\r\n    }, 1);\r\n  }\r\n\r\n  /**\r\n   * Update the image data for the thumbnails\r\n   * on steps.\r\n   * @param instructions The full instructions object to render with.\r\n   */\r\n  private updateThumbnails(instructions) {\r\n    const renderer = new RendererCanvasController(instructions, this.stepWidth, this.stepHeight);\r\n    this.thumbnails = renderer.render();\r\n  }\r\n\r\n  /**\r\n   * Called when the state changes.\r\n   * @param newState The new full state.\r\n   */\r\n  stateChange(newState: FileFormat) {\r\n    this.numSteps = newState.steps.length;\r\n    this.showThumbnail = Array(this.numSteps).fill(false);\r\n    this.updateThumbnails(newState);\r\n    this.redrawThumbnails();\r\n  }\r\n\r\n  /**\r\n   * Redraw the thumbnails.\r\n   */\r\n  redrawThumbnails() {\r\n    if (!this.canvasEls) {\r\n      return;\r\n    }\r\n    this.canvasEls\r\n      .map(el => [el.nativeElement, el.nativeElement.getContext('2d')])\r\n      .forEach((canv: [HTMLCanvasElement, CanvasRenderingContext2D], idx: number) => {\r\n        // Workaround: thumbnails may refresh before the view,\r\n        // in which case there will be canvases without corresponding\r\n        // thumbnails. This happens when the amount of steps reduces.\r\n        if (!this.thumbnails[idx]) {\r\n          return;\r\n        }\r\n        this.setCtxScale(canv[0], canv[1]);\r\n        canv[1].clearRect(0, 0, this.stepWidth, this.stepHeight);\r\n        canv[1].drawImage(this.thumbnails[idx], 0, 0, this.stepWidth, this.stepHeight);\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Set the scaling of a canvas to fit a\r\n   * thumbnail.\r\n   * @param canvas The canvas.\r\n   * @param ctx The context of the canvas.\r\n   */\r\n  setCtxScale(canvas: HTMLCanvasElement, ctx: CanvasRenderingContext2D) {\r\n    canvas.style.width = this.stepWidth + 'px';\r\n    canvas.style.height = this.stepHeight + 'px';\r\n    const pixelRatio = window.devicePixelRatio || 1;\r\n    canvas.width = this.stepWidth * pixelRatio;\r\n    canvas.height = this.stepHeight * pixelRatio;\r\n    ctx.scale(pixelRatio, pixelRatio);\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.canvasEls.changes.subscribe(() => {\r\n      this.redrawThumbnails();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Add a new slide after the selected one.\r\n   */\r\n  add() {\r\n    const newState = this.undoRedo.getStateClone();\r\n    const addIndex = this.step.selected + 1;\r\n    const newStep = deepClone(newState.steps[this.step.selected]) as StepFormat;\r\n    newState.steps.splice(addIndex, 0, newStep);\r\n    // Step options from current step to next now invalid,\r\n    // others above this need to be moved up.\r\n    if (newState.stepOpts) {\r\n      delete newState.stepOpts[addIndex - 1];\r\n      for (let i = newState.steps.length - 2; i >= addIndex + 1; i--) {\r\n        newState.stepOpts[i] = newState.stepOpts[i - 1];\r\n      }\r\n    }\r\n    // Delays need to be updated too. Copy the delay from\r\n    // current to added step, move the others up one.\r\n    if (newState.autoplay && newState.autoplay.delays) {\r\n      for (let i = newState.steps.length - 1; i >= addIndex; i--) {\r\n        newState.autoplay.delays[i] = newState.autoplay.delays[i - 1];\r\n      }\r\n    }\r\n    this.undoRedo.publishChange(newState);\r\n    this.step.selected = addIndex;\r\n  }\r\n\r\n  /**\r\n   * Delete the currently selected step.\r\n   */\r\n  delete() {\r\n    if (!this.deleteAvailable()) {\r\n      return;\r\n    }\r\n    const newState = this.undoRedo.getStateClone();\r\n    newState.steps.splice(this.step.selected, 1);\r\n    // Remove associated step options\r\n    if (newState.stepOpts) {\r\n      delete newState.stepOpts[this.step.selected - 1];\r\n      delete newState.stepOpts[this.step.selected];\r\n    }\r\n    // Step options for other steps are now invalid,\r\n    // need to be moved down\r\n    for (let i = this.step.selected + 1; i < newState.steps.length; i++) {\r\n      newState.stepOpts[i - 1] = newState.stepOpts[i];\r\n    }\r\n    // If applicable, delays are invalid as well\r\n    if (newState.autoplay && newState.autoplay.delays) {\r\n      // Need different behavior for deleting last step:\r\n      // need to preserve the delay of the deleted step,\r\n      // as it is the delay before ending the animation.\r\n      const startIndex = this.step.selected === newState.steps.length ? this.step.selected - 1 : this.step.selected;\r\n      for (let i = startIndex; i <= newState.steps.length; i++) {\r\n        newState.autoplay.delays[i] = newState.autoplay.delays[i + 1];\r\n      }\r\n    }\r\n    if (this.step.selected !== 0) {\r\n      this.step.selected--;\r\n    }\r\n    this.undoRedo.publishChange(newState);\r\n  }\r\n\r\n  /**\r\n   * Select a step by its index.\r\n   * @param newIdx The index of the step.\r\n   */\r\n  select(newIdx: number) {\r\n    this.step.selected = newIdx;\r\n  }\r\n\r\n  /**\r\n   * Whether the selected step can be deleted.\r\n   */\r\n  deleteAvailable(): boolean {\r\n    return this.numSteps > 1;\r\n  }\r\n\r\n  /**\r\n   * Whether step options can be edited for\r\n   * the selected step.\r\n   */\r\n  stepOptionsAvailable(): boolean {\r\n    return this.numSteps > 1 && this.step.selected < this.numSteps - 1;\r\n  }\r\n\r\n  /**\r\n   * Show a step options modal.\r\n   */\r\n  showStepOptions(): void {\r\n    if (!this.stepOptionsAvailable()) {\r\n      return;\r\n    }\r\n    this.modal.show(StepOptionsComponent);\r\n  }\r\n\r\n  /**\r\n   * Scroll the steps left some amount.\r\n   */\r\n  scrollLeft() {\r\n    this.scrollContainer.nativeElement.scrollLeft -= scrollXAmount;\r\n  }\r\n\r\n  /**\r\n   * Scroll the steps right some amount.\r\n   */\r\n  scrollRight() {\r\n    this.scrollContainer.nativeElement.scrollLeft += scrollXAmount;\r\n  }\r\n}\r\n","module.exports = \"p {\\r\\n    padding: 10px;\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvc3ViLXN1cGVyLWFsaWdubWVudC9zdWItc3VwZXItYWxpZ25tZW50LmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxhQUFhO0FBQ2pCIiwiZmlsZSI6InNyYy9hcHAvc3ViLXN1cGVyLWFsaWdubWVudC9zdWItc3VwZXItYWxpZ25tZW50LmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyJwIHtcclxuICAgIHBhZGRpbmc6IDEwcHg7XHJcbn0iXX0= */\"","module.exports = \"<div class=\\\"title\\\">EXPONENT/SUBSCRIPT ALIGNMENT</div>\\r\\n<div style=\\\"display: flex; justify-content: center;\\\">\\r\\n  <p>Lower</p>\\r\\n  <input #slider type=\\\"range\\\" min=\\\"0\\\" max=\\\"1\\\" step=\\\"0.01\\\" [(ngModel)]=\\\"portrusion\\\">\\r\\n  <p>Higher</p>\\r\\n</div>\\r\\n<div class=\\\"title\\\">PRESETS</div>\\r\\n<span class=\\\"selector\\\" (click)=\\\"portrusion = defaultPortrusion;\\\">Default</span>\\r\\n<span class=\\\"selector\\\" (click)=\\\"portrusion = '0.45';\\\">Fractional Exponent</span>\\r\\n<div class=\\\"title\\\">PREVIEW</div>\\r\\n<div class=\\\"eqContainer\\\" #eqContainer></div>\\r\\n<div style=\\\"display: flex\\\">\\r\\n  <span class=\\\"button\\\" (click)=\\\"apply()\\\">Apply</span>\\r\\n</div>\\r\\n\"","import { Component, AfterViewInit, ViewChild, ElementRef } from '@angular/core';\r\nimport { ContentSelectionService } from '../content-selection.service';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport { SelectedStepService } from '../selected-step.service';\r\nimport CanvasController from '@shared/main/CanvasController';\r\nimport { ModalService } from '../modal.service';\r\nimport { FileFormat, SubSuperContainerFormat, ContainerFormat } from '@shared/main/FileFormat';\r\nimport CreatorSubSuper from '../central-area/CreatorSubSuper';\r\nimport { defaultExpPortrusion } from '@shared/main/consts';\r\n\r\n@Component({\r\n  selector: 'app-sub-super-alignment',\r\n  templateUrl: './sub-super-alignment.component.html',\r\n  styleUrls: ['./sub-super-alignment.component.css']\r\n})\r\nexport class SubSuperAlignmentComponent implements AfterViewInit {\r\n\r\n  private subSuperLayout: SubSuperContainerFormat;\r\n  private fullInstructions: FileFormat;\r\n\r\n  defaultPortrusion = defaultExpPortrusion;\r\n  private portrusionVar = this.defaultPortrusion + '';\r\n\r\n  @ViewChild('eqContainer')\r\n  eqContainerEl: ElementRef;\r\n\r\n  constructor(private selection: ContentSelectionService,\r\n              private undoRedo: UndoRedoService,\r\n              private step: SelectedStepService,\r\n              private modal: ModalService) {\r\n    // Create an instructions containing solely the\r\n    // selected subSuper layout. Keep the color, remove\r\n    // the text.\r\n    this.subSuperLayout = selection.canvasInstance.getStepLayoutOfSelected() as SubSuperContainerFormat;\r\n    this.fullInstructions = undoRedo.getStateClone();\r\n    this.fullInstructions.steps = [this.fullInstructions.steps[step.selected]];\r\n    delete this.fullInstructions.steps[0].text;\r\n    delete this.fullInstructions.autoplay;\r\n    this.fullInstructions.steps[0].root = {\r\n      type: 'vbox',\r\n      children: [this.subSuperLayout]\r\n    } as ContainerFormat;\r\n  }\r\n\r\n  get portrusion() {\r\n    return this.portrusionVar;\r\n  }\r\n\r\n  set portrusion(newPort: string) {\r\n    this.portrusionVar = newPort;\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n   * Update the current portrusion.\r\n   */\r\n  update() {\r\n    this.subSuperLayout.portrusion = parseFloat(this.portrusion);\r\n    this.refreshPreview();\r\n  }\r\n\r\n  /**\r\n   * Update the preview canvas controller.\r\n   */\r\n  refreshPreview() {\r\n    this.eqContainerEl.nativeElement.innerHTML = '';\r\n    const canv = new CanvasController(this.eqContainerEl.nativeElement, this.fullInstructions);\r\n  }\r\n\r\n  /**\r\n   * Apply the changes.\r\n   */\r\n  apply() {\r\n    const subSuper = this.selection.canvasInstance.getSelectedLayout().component as CreatorSubSuper;\r\n    subSuper.savePortrusion(parseFloat(this.portrusion));\r\n    this.selection.canvasInstance.save();\r\n    this.modal.remove();\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.refreshPreview();\r\n  }\r\n}\r\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3RhYmxlLWFkZC90YWJsZS1hZGQuY29tcG9uZW50LmNzcyJ9 */\"","module.exports = \"<div class=\\\"title\\\">ADD</div>\\n<div style=\\\"display: flex\\\">\\n  <div class=\\\"button\\\" (click)=\\\"row()\\\">Row</div>\\n</div>\\n<div style=\\\"display: flex\\\">\\n    <div class=\\\"button\\\" (click)=\\\"column()\\\">Column</div>\\n  </div>\\n\"","import { Component, OnInit } from '@angular/core';\nimport { ModalService } from '../modal.service';\nimport EqComponent from '@shared/layout/EqComponent';\nimport { ContentSelectionService } from '../content-selection.service';\nimport CreatorTable from '../central-area/CreatorTable';\n\n@Component({\n  selector: 'app-table-add',\n  templateUrl: './table-add.component.html',\n  styleUrls: ['./table-add.component.css']\n})\nexport class TableAddComponent implements OnInit {\n\n  constructor(private modal: ModalService,\n              private selection: ContentSelectionService) { }\n\n  ngOnInit() {\n  }\n\n  /**\n   * Add a new row to the table.\n   */\n  row() {\n    // Get the table\n    const table = this.selection.canvasInstance.getSelectedLayout().component as CreatorTable;\n    // Get the children of the table\n    const children: EqComponent<any>[][] = table.getChildren();\n    // Add another row filled with null and same amount of columns\n    children.push(new Array(children[0].length).fill(null));\n    // Save the change\n    this.selection.canvasInstance.save();\n    // Close\n    this.modal.remove();\n  }\n\n  /**\n   * Add a new column to the table.\n   */\n  column() {\n    // Get the table\n    const table = this.selection.canvasInstance.getSelectedLayout().component as CreatorTable;\n    // Get the children of the table\n    const children: EqComponent<any>[][] = table.getChildren();\n    // Add another column by adding null to the end of each row\n    for (const row of children) {\n      row.push(null);\n    }\n    // Save the change\n    this.selection.canvasInstance.save();\n    // Close\n    this.modal.remove();\n  }\n\n}\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3Rlcm0tdGVtcGxhdGUvdGVybS10ZW1wbGF0ZS5jb21wb25lbnQuY3NzIn0= */\"","module.exports = \"<span class=\\\"selector\\\"\\r\\n      *ngFor=\\\"let template of templates; let idx = index;\\\"\\r\\n      (click)=\\\"apply(idx)\\\">\\r\\n{{ template }}\\r\\n</span>\\r\\n\"","import { Component } from '@angular/core';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport { getMetrics } from '@shared/main/helpers';\r\nimport { ContentSelectionService } from '../content-selection.service';\r\nimport { ModalService } from '../modal.service';\r\n\r\n@Component({\r\n  selector: 'app-term-template',\r\n  templateUrl: './term-template.component.html',\r\n  styleUrls: ['./term-template.component.css']\r\n})\r\nexport class TermTemplateComponent {\r\n\r\n  readonly templates: string[];\r\n\r\n  constructor(private undoRedo: UndoRedoService,\r\n              private selection: ContentSelectionService,\r\n              private modal: ModalService) {\r\n    this.templates = [\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      '',\r\n      ''\r\n    ];\r\n  }\r\n\r\n  /**\r\n   * Apply a template.\r\n   * @param idx The index of the template in templates.\r\n   */\r\n  apply(idx: number) {\r\n    const text = this.templates[idx];\r\n    const newState = this.undoRedo.getStateClone();\r\n    if (!newState.terms) {\r\n      newState.terms = [];\r\n    }\r\n    newState.terms.push(text);\r\n    newState.metrics = getMetrics(newState);\r\n    this.undoRedo.publishChange(newState);\r\n    this.modal.remove();\r\n  }\r\n\r\n}\r\n","module.exports = \"#text-area {\\r\\n    border: 1px solid rgba(255, 255, 255, 0.3);\\r\\n}\\r\\n\\r\\n.material-icons {\\r\\n    line-height: 22px;\\r\\n    font-size: 18px;\\r\\n    vertical-align: middle;\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdGV4dC1lZGl0b3IvdGV4dC1lZGl0b3IuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLDBDQUEwQztBQUM5Qzs7QUFFQTtJQUNJLGlCQUFpQjtJQUNqQixlQUFlO0lBQ2Ysc0JBQXNCO0FBQzFCIiwiZmlsZSI6InNyYy9hcHAvdGV4dC1lZGl0b3IvdGV4dC1lZGl0b3IuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIiN0ZXh0LWFyZWEge1xyXG4gICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjMpO1xyXG59XHJcblxyXG4ubWF0ZXJpYWwtaWNvbnMge1xyXG4gICAgbGluZS1oZWlnaHQ6IDIycHg7XHJcbiAgICBmb250LXNpemU6IDE4cHg7XHJcbiAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xyXG59Il19 */\"","module.exports = \"<div class=\\\"title\\\">EDIT</div>\\r\\n<div contenteditable=\\\"true\\\" #textArea id=\\\"text-area\\\" (keydown)=\\\"checkValid($event)\\\">Step Text</div>\\r\\n<div class=\\\"eqContainer\\\" #eqContainer></div>\\r\\n<div class=\\\"title\\\">STYLE</div>\\r\\n<span class=\\\"selector\\\" (mousedown)=\\\"unStyle()\\\">Normal</span>\\r\\n<span class=\\\"selector\\\" \\r\\n      *ngFor=\\\"let style of styleOpts; let idx = index;\\\" \\r\\n      [style.backgroundColor]=\\\"style.text === 'Bold' ? '#111' : style.color\\\"\\r\\n      (mousedown)=\\\"stylePress(idx)\\\">\\r\\n  {{ style.text }}\\r\\n</span>\\r\\n<div style=\\\"display: flex\\\">\\r\\n  <span class=\\\"button\\\" (click)=\\\"remove()\\\">Remove Step Text</span>\\r\\n  <span class=\\\"button\\\" (click)=\\\"apply(textArea.innerHTML)\\\">Apply</span>\\r\\n</div>\"","import { Component, AfterViewInit, ViewChild, ElementRef } from '@angular/core';\r\nimport { UndoRedoService } from '../undo-redo.service';\r\nimport { SelectedStepService } from '../selected-step.service';\r\nimport { ModalService } from '../modal.service';\r\nimport { SelectorData } from '../color-picker/color-picker.component';\r\nimport { cap, deCap } from '../helpers';\r\nimport CanvasController from '@shared/main/CanvasController';\r\nimport { ErrorService } from '../error.service';\r\nimport { colors } from '@shared/main/consts';\r\n\r\n@Component({\r\n  selector: 'app-text-editor',\r\n  templateUrl: './text-editor.component.html',\r\n  styleUrls: ['./text-editor.component.css']\r\n})\r\nexport class TextEditorComponent implements AfterViewInit {\r\n\r\n  @ViewChild('textArea')\r\n  textAreaEl: ElementRef;\r\n\r\n  @ViewChild('eqContainer')\r\n  eqContainerEl: ElementRef;\r\n\r\n  private anyTagPat = new RegExp('(<([^>]+)>)', 'gi');\r\n  private openTagPat = new RegExp('(<[^/]([^>]*)>)', 'gi');\r\n  private closeTagPat = new RegExp('(</([^>]+)>)', 'gi');\r\n\r\n  readonly styleOpts: SelectorData[];\r\n\r\n  constructor(private undoRedo: UndoRedoService,\r\n              private step: SelectedStepService,\r\n              private modal: ModalService,\r\n              private error: ErrorService) {\r\n    this.styleOpts = Object.keys(colors).map(colName => {\r\n      const name = colName === 'default' ? 'Bold' : cap(colName);\r\n      const colorArr = colors[colName];\r\n      const colStyle = 'rgb(' + colorArr[0] + ',' + colorArr[1] + ',' + colorArr[2] + ')';\r\n      return new SelectorData(colStyle, name);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Apply the changes.\r\n   */\r\n  apply(text: string) {\r\n    const newState = this.undoRedo.getStateClone();\r\n    newState.steps[this.step.selected].text = text;\r\n    this.undoRedo.publishChange(newState);\r\n    this.modal.remove();\r\n  }\r\n\r\n  /**\r\n   * Remove the text from this step.\r\n   */\r\n  remove() {\r\n    const newState = this.undoRedo.getStateClone();\r\n    delete newState.steps[this.step.selected].text;\r\n    this.undoRedo.publishChange(newState);\r\n    this.modal.remove();\r\n  }\r\n\r\n  /**\r\n   * Get the value to put in the text area\r\n   * when the component loads.\r\n   */\r\n  getInitialValue(): string {\r\n    const state = this.undoRedo.getState();\r\n    const stepText = state.steps[this.step.selected].text;\r\n    if (!stepText) {\r\n      return 'Step Text Here';\r\n    } else {\r\n      return stepText;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * If something is selected, style it.\r\n   * @param styleIdx The index of styleOpts.\r\n   */\r\n  stylePress(styleIdx: number) {\r\n    // Prepare the tags to be inserted\r\n    const styleOpt = this.styleOpts[styleIdx];\r\n    let startTag: string;\r\n    if (styleOpt.text === 'Bold') {\r\n      startTag = '<em>';\r\n    } else {\r\n      startTag = '<em class=\"' + deCap(styleOpt.text) + '\">';\r\n    }\r\n    const endTag = '</em>';\r\n\r\n    // Remove existing tags and add new ones\r\n    const [start, end] = this.getHTMLSelection();\r\n    const oldHTML = this.textAreaEl.nativeElement.innerHTML;\r\n    const [preparedHTML, newStart, newEnd] = this.removeTags(oldHTML, start, end);\r\n    const beforeSelected = preparedHTML.slice(0, newStart);\r\n    const selected = preparedHTML.slice(newStart, newEnd);\r\n    const afterSelected = preparedHTML.slice(newEnd, preparedHTML.length);\r\n    this.textAreaEl.nativeElement.innerHTML = beforeSelected + startTag + selected + endTag + afterSelected;\r\n  }\r\n\r\n  /**\r\n   * Remove the styling of the current selection.\r\n   */\r\n  unStyle() {\r\n    const [start, end] = this.getHTMLSelection();\r\n    const newHTML = this.removeTags(this.textAreaEl.nativeElement.innerHTML, start, end)[0];\r\n    this.textAreaEl.nativeElement.innerHTML = newHTML;\r\n  }\r\n\r\n  /**\r\n   * Given a string of HTML, remove any effects\r\n   * of em tags within a certain range, while\r\n   * preserving the effects outside the range.\r\n   * Returns the new string, as well as the new\r\n   * positions of the range boundary.\r\n   * CASES TO CONSIDER:  (| = range boundary)\r\n   * 1.        |                    |\r\n   * 2. <em>   |                    |    </em>\r\n   * 3.        |      <em></em>     |\r\n   * 4. <em>   |        </em>       |\r\n   * 5.        |        <em>        |    </em>\r\n   * 6. <em>   |     </em><em>      |    </em>\r\n   * 7. <em>   | </em><em></em><em> |    </em>\r\n   * @param htmlString The string of HTML.\r\n   * @param startInc The character at start of range (0-based, inclusive).\r\n   * @param endExc The character at end of range (0-based, exclusive).\r\n   */\r\n  removeTags(htmlString: string, startInc: number, endExc: number): [string, number, number] {\r\n    let beforeRange = htmlString.slice(0, startInc);\r\n    let range = htmlString.slice(startInc, endExc);\r\n    let afterRange = htmlString.slice(endExc, htmlString.length);\r\n\r\n    const openBeforeIdx = this.lastIndexOf(beforeRange, this.openTagPat);\r\n    const closeBeforeIdx = this.lastIndexOf(beforeRange, this.closeTagPat);\r\n    const openAfterIdx = this.indexOf(afterRange, this.openTagPat);\r\n    const closeAfterIdx = this.indexOf(afterRange, this.closeTagPat);\r\n\r\n    // cases 2, 4, 6, 7\r\n    if (openBeforeIdx > closeBeforeIdx) {\r\n      beforeRange += '</em>';\r\n      startInc += 5;\r\n      endExc += 5;\r\n    }\r\n\r\n    // cases 2, 5, 6, 7\r\n    if ((closeAfterIdx !== -1 && openAfterIdx === -1) || openAfterIdx > closeAfterIdx) {\r\n      // Find the opening tag for the closing tag after the range\r\n      // (which won't be in the after range portion.)\r\n      const beforeAfterRange = beforeRange + range;\r\n      const openTag = this.extractTag(beforeAfterRange, this.openTagPat, true);\r\n      afterRange = openTag + afterRange;\r\n    }\r\n\r\n    // cases 3-7\r\n    const rangeLenBefore = range.length;\r\n    range = range.replace(this.anyTagPat, '');\r\n    endExc -= rangeLenBefore - range.length;\r\n\r\n    return [beforeRange + range + afterRange, startInc, endExc];\r\n  }\r\n\r\n  /**\r\n   * Looks for an HTML tag in a string, and returns its\r\n   * substring. Finds the tag closest to the end of the string.\r\n   * Returns undefined if none found.\r\n   * @param str The string to look in.\r\n   * @param pat The pattern for the HTML tag. Must find matches ending in '>'.\r\n   * @param backwards Whether to start the search from the rear of the string.\r\n   */\r\n  extractTag(str: string, pat: RegExp, backwards: boolean): string {\r\n    const searchFunc = backwards ? this.lastIndexOf : this.indexOf;\r\n    const startIdx = searchFunc(str, pat);\r\n    if (startIdx === -1) {\r\n      return undefined;\r\n    }\r\n    const endSearchStr = str.substring(startIdx, str.length);\r\n    const endIdx = endSearchStr.indexOf('>');\r\n    return endSearchStr.substring(0, endIdx + 1);\r\n  }\r\n\r\n  /**\r\n   * Return the starting and ending offset\r\n   * of what is selected, relative to the HTML\r\n   * of the text area as opposed to the visual\r\n   * content. If there is no selection, throw\r\n   * an error.\r\n   */\r\n  getHTMLSelection(): [number, number] {\r\n    const range = window.getSelection().getRangeAt(0);\r\n    if (range.startContainer === range.endContainer && range.startOffset === range.endOffset) {\r\n      // TODO: Put an error in the UI.\r\n      this.error.text = 'Select Text First';\r\n      throw new Error('Select text first.');\r\n    }\r\n    const start = this.getInnerHTMLOffset(range.startOffset, range.startContainer, true);\r\n    const end = this.getInnerHTMLOffset(range.endOffset, range.endContainer, false);\r\n    return [start, end];\r\n  }\r\n\r\n  /**\r\n   * Converts an offset relative to a child node of\r\n   * the text area element to be relative to the\r\n   * inner HTML of the text area element.\r\n   * @param nodeOffset The offset relative to a child node\r\n   *                   of the text area element.\r\n   * @param node The node the above param is relative to.\r\n   * @param expandLeft  Whether to include opening tags to the left\r\n   *                    of the offset. If false, include closing tags\r\n   *                    to the right.\r\n   */\r\n  getInnerHTMLOffset(nodeOffset: number, node: Node, expandLeft: boolean): number {\r\n    const ta: HTMLDivElement = this.textAreaEl.nativeElement;\r\n    // Get rid of adjacent text nodes.\r\n    ta.normalize();\r\n    const children = ta.childNodes;\r\n    const innerHTML = ta.innerHTML;\r\n    let idxOfNodeWithOffset;\r\n    for (let i = 0; i < children.length; i++) {\r\n      let child: Node = children[i];\r\n      // EMs are children, which have text nodes as children\r\n      if (child.nodeName !== '#text') {\r\n        child = child.firstChild;\r\n      }\r\n      if (child === node) {\r\n        idxOfNodeWithOffset = i;\r\n        break;\r\n      }\r\n    }\r\n    let cursor;\r\n    let currChild = innerHTML.charAt(0) === '<' ? -1 : 0;\r\n    let currChildStartIdx = 0;\r\n    let tagLastIteration = false;\r\n    for (cursor = 0; cursor <= innerHTML.length; cursor++) {\r\n      if (currChild === idxOfNodeWithOffset && cursor === currChildStartIdx + nodeOffset) {\r\n        // Found the selected position, but there's a catch:\r\n        // if there is an opening tag directly before, or closing\r\n        // tag directly after, we want to place the cursor on the\r\n        // other side.\r\n        const beforeCursor = innerHTML.slice(0, cursor);\r\n        const afterCursor = innerHTML.slice(cursor, innerHTML.length);\r\n        const lastOpenTagBeforeCursor = this.extractTag(beforeCursor, this.openTagPat, true);\r\n        const firstCloseTagAfterCursor = this.extractTag(afterCursor, this.closeTagPat, false);\r\n        if (expandLeft && beforeCursor.endsWith(lastOpenTagBeforeCursor)) {\r\n          // Shift to before\r\n          cursor -= lastOpenTagBeforeCursor.length;\r\n        } else if (!expandLeft && afterCursor.startsWith(firstCloseTagAfterCursor)) {\r\n          // Shift to after\r\n          cursor += firstCloseTagAfterCursor.length;\r\n        }\r\n        return cursor;\r\n      }\r\n      const char = innerHTML.charAt(cursor);\r\n      if (char === '<') {\r\n        // Possibly the start or end of an HTML tag, either signifying the next element\r\n        const restOf = innerHTML.slice(cursor);\r\n        const startOfTag = restOf.search(this.anyTagPat) === 0;\r\n        if (startOfTag) {\r\n          if (!tagLastIteration) {\r\n            // If we have <em></em><em></em>, there is only one transition between children\r\n            currChild++;\r\n          }\r\n          const endOfTagIdx = restOf.indexOf('>');\r\n          // Put cursor at end of tag, next iteration pushes it to right place\r\n          cursor += endOfTagIdx;\r\n          currChildStartIdx = cursor + 1;\r\n          tagLastIteration = true;\r\n        }\r\n      } else {\r\n        tagLastIteration = false;\r\n      }\r\n    }\r\n    throw new Error('Could not find position within HTML.');\r\n  }\r\n\r\n  /**\r\n   * Find the starting index of a pattern in\r\n   * a string, searching backwards. Make sure\r\n   * the 'g' flag is enabled in the pattern.\r\n   * @param str The string to search in.\r\n   * @param pattern The pattern to match.\r\n   */\r\n  lastIndexOf(str: string, pattern: RegExp): number {\r\n    const match = str.match(pattern);\r\n    if (!match) {\r\n      return -1;\r\n    }\r\n    return str.lastIndexOf(match[match.length - 1]);\r\n  }\r\n\r\n  /**\r\n   * Find the starting index of a pattern in\r\n   * a string.\r\n   * @param str The string to find an index in.\r\n   * @param pattern The pattern to match.\r\n   */\r\n  indexOf(str: string, pattern: RegExp): number {\r\n    const match = str.match(pattern);\r\n    if (!match) {\r\n      return -1;\r\n    }\r\n    return str.indexOf(match[0]);\r\n  }\r\n\r\n  /**\r\n   * Show an updated version of the preview.\r\n   */\r\n  updatePreview() {\r\n    const state = this.undoRedo.getStateClone();\r\n    state.steps = [state.steps[this.step.selected]];\r\n    state.steps[0].text = undefined;\r\n    delete state.autoplay;\r\n    this.eqContainerEl.nativeElement.innerHTML = '';\r\n    const canv = new CanvasController(this.eqContainerEl.nativeElement, state);\r\n  }\r\n\r\n  /**\r\n   * Called when a key is down. If it is not a valid\r\n   * key, cancel the typing.\r\n   */\r\n  checkValid(e: KeyboardEvent) {\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n    }\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    this.textAreaEl.nativeElement.innerHTML = this.getInitialValue();\r\n    this.textAreaEl.nativeElement.focus();\r\n    this.updatePreview();\r\n  }\r\n\r\n}\r\n","module.exports = \"#outer {\\r\\n    padding: 10px;\\r\\n    border-bottom: 1px solid rgba(255, 255, 255, 0.3);\\r\\n}\\r\\n\\r\\n.flex {\\r\\n    display: flex;\\r\\n    flex-direction: row;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\n.icon {\\r\\n    cursor: pointer;\\r\\n    padding: 5px 10px 5px 10px;\\r\\n    color: rgba(255, 255, 255, 0.3);\\r\\n}\\r\\n\\r\\n.active {\\r\\n    color: rgba(255, 255, 255, 1);\\r\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdG9vbC1iYXIvdG9vbC1iYXIuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLGFBQWE7SUFDYixpREFBaUQ7QUFDckQ7O0FBRUE7SUFDSSxhQUFhO0lBQ2IsbUJBQW1CO0lBQ25CLG1CQUFtQjtBQUN2Qjs7QUFFQTtJQUNJLGVBQWU7SUFDZiwwQkFBMEI7SUFDMUIsK0JBQStCO0FBQ25DOztBQUVBO0lBQ0ksNkJBQTZCO0FBQ2pDIiwiZmlsZSI6InNyYy9hcHAvdG9vbC1iYXIvdG9vbC1iYXIuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIiNvdXRlciB7XHJcbiAgICBwYWRkaW5nOiAxMHB4O1xyXG4gICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4zKTtcclxufVxyXG5cclxuLmZsZXgge1xyXG4gICAgZGlzcGxheTogZmxleDtcclxuICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XHJcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG59XHJcblxyXG4uaWNvbiB7XHJcbiAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgICBwYWRkaW5nOiA1cHggMTBweCA1cHggMTBweDtcclxuICAgIGNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMyk7XHJcbn1cclxuXHJcbi5hY3RpdmUge1xyXG4gICAgY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMSk7XHJcbn0iXX0= */\"","module.exports = \"<div id=\\\"outer\\\" class=\\\"flex\\\" (click)=\\\"interceptClick($event);\\\">\\r\\n    <div class=\\\"flex\\\">\\r\\n        <div    class=\\\"icon material-icons\\\" \\r\\n                (click)=\\\"icon.onClick($event)\\\" \\r\\n                *ngFor=\\\"let icon of leftIcons\\\" \\r\\n                [ngClass]=\\\"{'active': icon.isActive()}\\\">\\r\\n            {{ icon.name }}\\r\\n        </div>\\r\\n    </div>\\r\\n    <div style=\\\"flex-grow: 1\\\"></div>\\r\\n    <div class=\\\"flex\\\">\\r\\n            <div    class=\\\"icon material-icons\\\" \\r\\n                    (click)=\\\"icon.onClick($event)\\\" \\r\\n                    *ngFor=\\\"let icon of rightIcons\\\" \\r\\n                    [ngClass]=\\\"{'active': icon.isActive()}\\\">\\r\\n                {{ icon.name }}\\r\\n            </div>\\r\\n        </div>\\r\\n</div>\"","import { Component, OnInit, Input } from '@angular/core';\r\nimport Icon from '../Icon';\r\nimport { ContentSelectionService } from '../content-selection.service';\r\n\r\n@Component({\r\n  selector: 'app-tool-bar',\r\n  templateUrl: './tool-bar.component.html',\r\n  styleUrls: ['./tool-bar.component.css']\r\n})\r\nexport class ToolBarComponent implements OnInit {\r\n\r\n  @Input() leftIcons: Icon[];\r\n  @Input() rightIcons: Icon[];\r\n\r\n  constructor(private selection: ContentSelectionService) {}\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  /**\r\n   * Deselect, or don't, depending on the state.\r\n   * @param e The mouse event.\r\n   */\r\n  interceptClick(e: MouseEvent) {\r\n    if (this.selection.selectedOnCanvas) {\r\n      e.stopPropagation();\r\n    }\r\n  }\r\n\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { deepClone } from './helpers';\r\nimport { FileFormat } from '@shared/main/FileFormat';\r\n\r\n// The total amount of objects that may be stored\r\nconst MAX_SIZE = 100;\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\n/**\r\n * A service storing a history of the configuration\r\n * file as it has been edited. The configuration file\r\n * is the one converted into JSON for storage, describing\r\n * the animation.\r\n */\r\nexport class UndoRedoService {\r\n\r\n  // Where idx > currentStateIdx, that state is a redo.\r\n  // Where idx < currentStateIdx, that state is an undo.\r\n  // Where idx = currentStateIdx, that state is current.\r\n  private history: FileFormat[];\r\n  private currentStateIdx;\r\n\r\n  private subscribers: ((newState: FileFormat) => void)[];\r\n\r\n  constructor() {\r\n    this.history = [];\r\n    this.currentStateIdx = -1;\r\n    this.subscribers = [];\r\n    this.redo = this.redo.bind(this);\r\n    this.canRedo = this.canRedo.bind(this);\r\n    this.undo = this.undo.bind(this);\r\n    this.canUndo = this.canUndo.bind(this);\r\n  }\r\n\r\n  /**\r\n   * Subscribe to changes in the current state.\r\n   * @param changeFunction Function that will be passed the current state when it changes.\r\n   */\r\n  subscribe(changeFunction: (newState: FileFormat) => void) {\r\n    this.subscribers.push(changeFunction);\r\n  }\r\n\r\n  /**\r\n   * Notify subscribers the state has changed.\r\n   */\r\n  notifySubscribers() {\r\n    const currState = this.history[this.currentStateIdx];\r\n    this.subscribers.forEach(func => {\r\n      func(currState);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Make a change to the current state.\r\n   * @param newState The new current state.\r\n   */\r\n  publishChange(newState: FileFormat) {\r\n    // Erase any redos ahead of this change\r\n    this.history.splice(this.currentStateIdx + 1, this.history.length);\r\n    // Add the new state\r\n    this.history.push(newState);\r\n    this.currentStateIdx++;\r\n    // Trim the size if necessary\r\n    const numToRemove = this.history.length - MAX_SIZE;\r\n    if (numToRemove > 0) {\r\n      this.history.splice(0, numToRemove);\r\n      this.currentStateIdx -= numToRemove;\r\n    }\r\n    // Notify subscribers of change\r\n    this.notifySubscribers();\r\n  }\r\n\r\n  /**\r\n   * Whether there are changes to be undone.\r\n   */\r\n  canUndo(): boolean {\r\n    return this.currentStateIdx > 0;\r\n  }\r\n\r\n  /**\r\n   * Undo the last change.\r\n   */\r\n  undo() {\r\n    const newIdx = this.currentStateIdx - 1;\r\n    if (newIdx < 0) {\r\n      throw new Error('Cannot undo.');\r\n    }\r\n    this.currentStateIdx = newIdx;\r\n    this.notifySubscribers();\r\n  }\r\n\r\n  /**\r\n   * Whether there are changes to be redone.\r\n   */\r\n  canRedo(): boolean {\r\n    return this.currentStateIdx < this.history.length - 1;\r\n  }\r\n\r\n  /**\r\n   * Redo the last undo.\r\n   */\r\n  redo() {\r\n    const newIdx = this.currentStateIdx + 1;\r\n    if (newIdx >= this.history.length) {\r\n      throw new Error('Cannot redo');\r\n    }\r\n    this.currentStateIdx = newIdx;\r\n    this.notifySubscribers();\r\n  }\r\n\r\n  /**\r\n   * Get the current state.\r\n   */\r\n  getState(): FileFormat {\r\n    return this.history[this.currentStateIdx];\r\n  }\r\n\r\n  /**\r\n   * Get a deep clone of the current state.\r\n   * Useful for making changes then publishing.\r\n   */\r\n  getStateClone(): FileFormat {\r\n    return deepClone(this.getState()) as FileFormat;\r\n  }\r\n\r\n  /**\r\n   * Remove all stored states.\r\n   */\r\n  erase(): void {\r\n    this.history = [];\r\n    this.currentStateIdx = -1;\r\n  }\r\n\r\n  /**\r\n   * Return the stored states and the index\r\n   * of the current one.\r\n   */\r\n  getHistory(): [FileFormat[], number] {\r\n    return [this.history, this.currentStateIdx];\r\n  }\r\n\r\n  /**\r\n   * Restore the states from earlier.\r\n   * @param saved Obtained from getHistory() earlier.\r\n   */\r\n  setHistory(saved: [FileFormat[], number]) {\r\n    this.history = saved[0];\r\n    this.currentStateIdx = saved[1];\r\n    this.notifySubscribers();\r\n  }\r\n}\r\n","// This file can be replaced during build by using the `fileReplacements` array.\r\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\r\n// The list of file replacements can be found in `angular.json`.\r\n\r\nexport const environment = {\r\n  production: false\r\n};\r\n\r\n/*\r\n * For easier debugging in development mode, you can import the following file\r\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\r\n *\r\n * This import should be commented out in production mode because it will have a negative impact\r\n * on performance if an error is thrown.\r\n */\r\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\r\n","import { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nplatformBrowserDynamic().bootstrapModule(AppModule)\r\n  .catch(err => console.error(err));\r\n"],"sourceRoot":""}